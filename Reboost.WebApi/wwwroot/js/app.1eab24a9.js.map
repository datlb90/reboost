{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?7e02","webpack:///./src/store/modules/permission.js","webpack:///./src/store/getters.js","webpack:///./src/store/index.js","webpack:///./src/App.vue?f5a5","webpack:///./src/layout/Index.vue?0790","webpack:///./src/layout/components/AppMain.vue?802b","webpack:///src/layout/components/AppMain.vue","webpack:///./src/layout/components/AppMain.vue?2ba2","webpack:///./src/layout/components/AppMain.vue","webpack:///./src/layout/components/Navbar.vue?41ef","webpack:///src/layout/components/Navbar.vue","webpack:///./src/layout/components/Navbar.vue?438f","webpack:///./src/layout/components/Navbar.vue?120e","webpack:///src/layout/Index.vue","webpack:///./src/layout/Index.vue?ef5f","webpack:///./src/layout/Index.vue?3ebb","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue?bff9","webpack:///./src/main.js","webpack:///./src/layout/components/Navbar.vue?46f2","webpack:///./src/views/Home.vue?9b1e","webpack:///./node_modules/lazy-debug-legacy/src sync","webpack:///./src/views/Home.vue?e0c3","webpack:///src/views/Home.vue","webpack:///./src/views/Home.vue?493c","webpack:///./src/views/Home.vue?c853","webpack:///./src/views/Document.vue?4132","webpack:///./src/pdfjs/utils/abstractFunction.js","webpack:///./src/pdfjs/UI/utils.js","webpack:///./src/pdfjs/UI/event.js","webpack:///./src/pdfjs/adapter/StoreAdapter.js","webpack:///./src/pdfjs/utils/uuid.js","webpack:///./src/pdfjs/adapter/LocalStoreAdapter.js","webpack:///./src/pdfjs/utils/setAttributes.js","webpack:///./src/pdfjs/utils/normalizeColor.js","webpack:///./src/pdfjs/render/renderLine.js","webpack:///./src/pdfjs/render/renderPath.js","webpack:///./src/pdfjs/render/renderPoint.js","webpack:///./src/pdfjs/render/renderRect.js","webpack:///./src/pdfjs/render/renderText.js","webpack:///./src/pdfjs/render/appendChild.js","webpack:///./src/pdfjs/a11y/createScreenReaderOnly.js","webpack:///./src/pdfjs/a11y/insertElementWithinElement.js","webpack:///./src/pdfjs/a11y/insertElementWithinChildren.js","webpack:///./src/pdfjs/a11y/insertScreenReaderComment.js","webpack:///./src/pdfjs/a11y/renderScreenReaderComments.js","webpack:///./src/pdfjs/a11y/insertScreenReaderHint.js","webpack:///./src/pdfjs/a11y/initEventHandlers.js","webpack:///./src/pdfjs/a11y/renderScreenReaderHints.js","webpack:///./src/pdfjs/render/index.js","webpack:///./src/pdfjs/UI/edit.js","webpack:///./src/pdfjs/UI/pen.js","webpack:///./src/pdfjs/UI/point.js","webpack:///./src/pdfjs/UI/rect.js","webpack:///./src/pdfjs/UI/text.js","webpack:///./src/pdfjs/UI/page.js","webpack:///./src/pdfjs/UI/select.js","webpack:///./src/pdfjs/UI/index.js","webpack:///./src/pdfjs/PDFJSAnnotate.js","webpack:///./src/pdfjs/shared/initColorPicker.js","webpack:///src/views/Document.vue","webpack:///./src/views/Document.vue?7864","webpack:///./src/views/Document.vue","webpack:///./src/views/Test.vue?1f48","webpack:///./src/utils/url.js","webpack:///./src/utils/axios.js","webpack:///src/views/Test.vue","webpack:///./src/views/Test.vue?cb68","webpack:///./src/views/Test.vue?0b36","webpack:///./src/router/index.js","webpack:///./src/views/Test.vue?71ec","webpack:///./src/views/Test.vue?4ecf","webpack:///./src/layout/components/Navbar.vue?82d0","webpack:///./src/store/modules sync \\.js$","webpack:///./src/layout/Index.vue?aa68"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","jsonpScriptSrc","p","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","hasPermission","roles","route","meta","some","role","includes","filterAsyncRoutes","routes","res","forEach","tmp","children","state","addRoutes","mutations","SET_ROUTES","constantRoutes","concat","CLEAR_ROUTES","actions","generateRoutes","commit","accessedRoutes","asyncRoutes","namespaced","getters","sidebar","app","size","device","visitedViews","tagsView","cachedViews","token","user","avatar","introduction","permission_routes","permission","errorLogs","errorLog","logs","Vue","use","Vuex","modulesFiles","require","keys","reduce","modulePath","moduleName","replace","default","store","Store","_vm","this","_h","$createElement","_c","_self","attrs","$route","plainLayout","_e","staticRenderFns","staticClass","component","staticStyle","_v","activeIndex","on","handleSelect","_l","idx","path","toString","_s","computed","methods","$router","catch","components","AppMain","Navbar","layout","VueCookies","FBSignInButton","GSignInButton","Element","locale","config","productionTip","router","render","h","App","$mount","webpackEmptyContext","req","code","id","_m","mounted","documentElement","style","height","body","getElementById","login","width","viewerWidth","documentId","slot","model","callback","$$v","newComment","expression","$event","addCommentText","cancelCommentText","comment","uuid","top","topPosition","deleteCommentCard","displayEditComment","directives","rawName","isSelected","content","ref","refInFor","$set","editCommentCard","HighlightText","StrikethroughText","CommentText","abstractFunction","BORDER_COLOR","userSelectStyleSheet","createStyleSheet","findSVGContainer","node","parentNode","nodeName","toUpperCase","getAttribute","findSVGAtPoint","x","y","elements","querySelectorAll","el","rect","getBoundingClientRect","pointIntersectsRect","findAnnotationAtPoint","svg","getOffsetAnnotationRect","bottom","left","right","getAnnotationRect","getOffset","offsetLeft","offsetTop","w","LINE_OFFSET","toLowerCase","minX","maxX","minY","maxY","split","map","parseInt","scaleUp","getMetadata","viewport","scale","scaleDown","disableUserSelect","enableUserSelect","removeChild","pageNumber","JSON","parse","clickNode","emitter","EventEmitter","fireEvent","emit","arguments","addEventListener","removeEventListener","removeListener","clientX","clientY","StoreAdapter","definition","annotationId","annotation","annotations","selectedText","topPos","commentId","__getAnnotations","fn","then","a","__addAnnotation","__editAnnotation","__deleteAnnotation","success","__addComment","__deleteComment","REGEXP","PATTERN","replacement","Math","random","v","LocalStoreAdapter","getAnnotations","filter","page","class","getAnnotation","findAnnotation","addAnnotation","updateAnnotations","log","editAnnotation","deleteAnnotation","index","getComments","addComment","text","updateComments","comments","thisComment","item","deleteComment","localStorage","getItem","setItem","stringify","UPPER_REGEX","BLACKLIST","keyCase","indexOf","match","setAttributes","attributes","REGEX_HASHLESS_HEX","normalizeColor","color","test","renderLine","group","createElementNS","stroke","strokeWidth","rectangles","line","x1","y1","x2","y2","renderPath","lines","p1","p2","join","fill","SIZE","D","renderPoint","outerSVG","innerSVG","viewBox","renderRect","order","otherGroups","groupsArr","Array","max","fillOpacity","pageNum","pageHeight","createRect","renderText","fontSize","innerHTML","isFirefox","navigator","userAgent","getTranslation","rotation","transform","trans","querySelector","objectAssign","child","wrapperNode","findWrapperNode","before","isArrayInArray","arr","childArr","isWrapped","arrString","rects","childNodes","wrapperRects","wrapper","rectsY","wrapperChildRects","wrapperY","rectX","rectWidth","wrapperX","wrapperWidth","createScreenReaderOnly","createTextNode","position","overflow","insertElementWithinElement","insertBefore","OFFSET_ADJUST","textLayerElementFromPoint","temp","cloneNode","tail","unshift","pop","outerHTML","insertElementWithinChildren","nodes","textLayer","textRect","insertScreenReaderComment","list","renderScreenReaderComments","isArray","PDFJSAnnotate","getStoreAdapter","COMMENT_TYPES","insertScreenReaderHint","num","first","last","initEventHandlers","reorderAnnotationsByType","removeAnnotation","insertComment","removeComment","renderScreenReaderHints","removeElementById","elementId","SORT_TYPES","sortBy","sort","sortByPoint","b","sortByRectPoint","sortByLinePoint","lineA","lineB","removeAttribute","overlay","dragOffsetX","dragOffsetY","dragStartX","dragStartY","_enabled","isDragging","OVERLAY_BORDER_SIZE","createEditOverlay","destroyEditOverlay","anchor","styleLeft","styleTop","boxSizing","border","borderRadius","background","padding","textAlign","textDecoration","handleDocumentClick","handleDocumentKeyup","handleDocumentMousedown","borderColor","boxShadow","display","handleDocumentMousemove","handleDocumentMouseup","keyCode","cursor","offsetHeight","offsetWidth","getDelta","propX","propY","calcDelta","deltaX","deltaY","modelY","viewY","modelX","viewX","originX","originY","handleAnnotationClick","enableEdit","disableEdit","_penSize","_penColor","savePoint","point","setPen","penSize","penColor","enablePen","disablePen","input","handleInputBlur","handleInputKeyup","focus","closeInput","trim","assign","enablePoint","disablePoint","_type","getSelectionRects","selection","getSelection","range","getRangeAt","getClientRects","saveRect","removeAllRanges","boundingRect","offset","enableRect","disableRect","_textSize","_textColor","saveText","setText","textSize","textColor","enableText","disableText","PAGE_TEMPLATE","createPage","canvas","mozOpaque","renderPage","renderOptions","async","pdfDocument","rotate","getPage","pdfPage","canvasContext","getContext","alpha","getViewport","scalePage","getTextContent","normalizeWhitespace","textContent","textLayerFactory","DefaultTextLayerFactory","textLayerBuilder","createTextLayerBuilder","setTextContent","context","outputScale","getOutputScale","scaled","sx","sy","sfx","approximateFraction","sfy","visibility","roundToDivide","floor","xinv","limit","x_","q","ctx","devicePixelRatio","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","pixelRatio","div","round","_rects","_svg","_target","_annotation","_selectedText","_inputHeight","_order","classList","contains","parentElement","textTool","newCommentWrapper","validTarget","hasAParentWithClass","unselectHighlightComment","element","className","posX","posY","highlightText","removeMinHeigthRects","substring","hideTextToolBar","min","updateCommentPositions","commentCards","commentHighlights","highlightArr","compareTopAttributes","findIndex","dataset","pdfAnnotateId","hasEnoughSpace","rectTop","svgHeight","svgPageNum","svgTop","endPos","moveDownFromEndPos","moveUpFromTopPos","upperTop","upperEnd","g","getHighlightByCommentId","gTop","moveDownToTopPos","lowerTop","moveUpToEndPos","updatePositionsAfterCommentAdded","handleCommentCardClick","startIndex","adjTop","adjEnd","previousTop","thisTop","thisEnd","desiredTop","previousEnd","thisCommentId","thisG","thisGTop","thisDesiredTop","top1","top2","order1","order2","firstTopPos","lastEndPos","thisTopPos","thisEndPos","nextTopPos","displayAddNewCommentForm","textArea","newHeight","orderTopPos","isDeleted","remove","commentContent","commentWrapper","commentText","stopPropagation","enableSelect","handleCommentAnnotationClick","restoreCommentPositions","highlightId","highlight","selectedHighlight","getElementsByClassName","selectedComment","highlights","updateCommentAnnotations","thisCard","add","cTop","selected","disableSelect","strikethroughText","__storeAdapter","setStoreAdapter","adapter","UI","COLORS","hex","initColorPicker","onChange","setColor","fireOnChange","closePicker","togglePicker","isPickerOpen","openPicker","picker","createColorOption","margin","onclick","viewer","PAGE_HEIGHT","NUM_PAGES","RENDER_OPTIONS","inputHeight","hasSpace","editClicked","TextStuff","ToolbarButtons","ClearToolbarButton","handleClearClick","confirm","removeItem","TextSelection","annotationClick","that","commentCardClick","$forceUpdate","$refs","refName","$el","form","googleFormAction","submitGoogleLoginForm","facebookFormAction","submitFacebookLoginForm","apiCall","logout","weathers","getBaseURL","url","location","href","protocol","host","getBaseApiURL","apiEndpoint","process","baseURL","urlUtils","instance","axios","delete","options","post","put","patch","mgr","username","password","access_token","fbSignInParams","scope","return_scopes","googleExternalLogin","returnUrl","oauthSignIn","oauth2Endpoint","params","submit","googleLoginForm","facebookLoginForm","Email","Password","headers","response","title","Router","Home","Document","Test","redirect","hidden","createRouter","NProgress","configure","showSpinner","whiteList","beforeEach","to","from","next","start","hasToken","hasRoles","dispatch","accessRoutes","Message","done","afterEach","webpackContext","webpackContextResolve"],"mappings":"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","file":"js/app.1eab24a9.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"js/\" + ({\"about\":\"about\"}[chunkId]||chunkId) + \".\" + {\"about\":\"ce9a68d4\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","import { asyncRoutes, constantRoutes } from '@/router'\n\n/**\n * Use meta.role to determine if the current user has permission\n * @param roles\n * @param route\n */\nfunction hasPermission(roles, route) {\n  if (route.meta && route.meta.roles) {\n    return roles.some(role => route.meta.roles.includes(role))\n  } else {\n    return true\n  }\n}\n\n/**\n * Filter asynchronous routing tables by recursion\n * @param routes asyncRoutes\n * @param roles\n */\nexport function filterAsyncRoutes(routes, roles) {\n  const res = []\n\n  routes.forEach(route => {\n    const tmp = { ...route }\n    if (hasPermission(roles, tmp)) {\n      if (tmp.children) {\n        tmp.children = filterAsyncRoutes(tmp.children, roles)\n      }\n      res.push(tmp)\n    }\n  })\n\n  return res\n}\n\nconst state = {\n  routes: [],\n  addRoutes: []\n}\n\nconst mutations = {\n  SET_ROUTES: (state, routes) => {\n    state.addRoutes = routes\n    state.routes = constantRoutes.concat(routes)\n  },\n  CLEAR_ROUTES: (state) => {\n    state.addRoutes = []\n    state.routes = []\n  }\n}\n\nconst actions = {\n  generateRoutes({ commit }) {\n    return new Promise(resolve => {\n      const accessedRoutes = asyncRoutes\n      // if (roles.includes('admin')) {\n      // \taccessedRoutes = asyncRoutes || [];\n      // } else {\n      // \taccessedRoutes = filterAsyncRoutes(asyncRoutes, roles);\n      // }\n      commit('SET_ROUTES', accessedRoutes)\n      // commit('CLEAR_ROUTES');\n      resolve(accessedRoutes)\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n","const getters = {\n  sidebar: state => state.app.sidebar,\n  size: state => state.app.size,\n  device: state => state.app.device,\n  visitedViews: state => state.tagsView.visitedViews,\n  cachedViews: state => state.tagsView.cachedViews,\n  token: state => state.user.token,\n  avatar: state => state.user.avatar,\n  name: state => state.user.name,\n  introduction: state => state.user.introduction,\n  roles: state => state.user.roles,\n  permission_routes: state => state.permission.routes,\n  errorLogs: state => state.errorLog.logs\n}\nexport default getters\n\n","import Vue from 'vue'\nimport Vuex from 'vuex'\nimport getters from './getters'\n\nVue.use(Vuex)\n\n// https://webpack.js.org/guides/dependency-management/#requirecontext\nconst modulesFiles = require.context('./modules', true, /\\.js$/)\n\n// you do not need `import app from './modules/app'`\n// it will auto require all vuex module from modules file\nconst modules = modulesFiles.keys().reduce((modules, modulePath) => {\n  // set './app.js' => 'app'\n  const moduleName = modulePath.replace(/^\\.\\/(.*)\\.\\w+$/, '$1')\n  const value = modulesFiles(modulePath)\n  modules[moduleName] = value.default\n  return modules\n}, {})\n\nconst store = new Vuex.Store({\n  modules,\n  getters\n})\n\nexport default store\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[(!_vm.$route.meta.plainLayout)?_c('div',[_c('layout')],1):_vm._e(),(_vm.$route.meta.plainLayout)?_c('div',{attrs:{\"id\":\"content-wrapper\"}},[_c('router-view')],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"app-wrapper\"},[_c('div',{staticClass:\"main-container\"},[_c('div',[_c('navbar')],1),_c('app-main')],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"app-main\"},[_c('transition',{attrs:{\"name\":\"fade-transform\",\"mode\":\"out-in\"}},[_c('keep-alive',[_c('router-view')],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <section class=\"app-main\">\n    <transition name=\"fade-transform\" mode=\"out-in\">\n      <keep-alive>\n        <router-view />\n      </keep-alive>\n    </transition>\n  </section>\n</template>\n\n<script>\nexport default {\n  name: 'AppMain'\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AppMain.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AppMain.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AppMain.vue?vue&type=template&id=e25a4c2e&\"\nimport script from \"./AppMain.vue?vue&type=script&lang=js&\"\nexport * from \"./AppMain.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"navBar\",staticStyle:{\"background\":\"white\",\"border-bottom\":\"1px solid #dcdfe6\",\"height\":\"46px\"}},[_c('el-button',{staticClass:\"logo-btn expand\",staticStyle:{\"float\":\"left\",\"margin-top\":\"3px\",\"margin-left\":\"20px\"},attrs:{\"type\":\"primary\",\"plain\":\"\"}},[_vm._v(\" Reboost Logo \")]),_c('el-menu',{staticClass:\"el-menu-demo\",staticStyle:{\"margin-left\":\"25px\",\"float\":\"left\"},attrs:{\"default-active\":_vm.activeIndex,\"mode\":\"horizontal\"},on:{\"select\":_vm.handleSelect}},_vm._l((_vm.permission_routes),function(route,idx){return _c('el-menu-item',{key:route.path,attrs:{\"index\":(idx + 1).toString(),\"base-path\":route.path}},[_vm._v(\" \"+_vm._s(route.name)+\" \")])}),1),_c('div',{staticClass:\"right-menu\",staticStyle:{\"float\":\"right\",\"margin-top\":\"12px\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"navBar\" style=\"background: white; border-bottom: 1px solid #dcdfe6; height: 46px;\">\n    <el-button class=\"logo-btn expand\" type=\"primary\" plain style=\"float: left; margin-top: 3px; margin-left: 20px;\">\n      Reboost Logo\n    </el-button>\n\n    <el-menu\n      :default-active=\"activeIndex\"\n      class=\"el-menu-demo\"\n      mode=\"horizontal\"\n      style=\"margin-left: 25px; float: left;\"\n      @select=\"handleSelect\"\n    >\n      <el-menu-item v-for=\"(route, idx) in permission_routes\" :key=\"route.path\" :index=\"(idx + 1).toString()\" :base-path=\"route.path\">\n        {{ route.name }}\n      </el-menu-item>\n    </el-menu>\n\n    <div class=\"right-menu\" style=\"float: right; margin-top: 12px;\" />\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nexport default {\n  name: 'NavBar',\n  data() {\n    return {\n      activeIndex: '1'\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'permission_routes'\n    ])\n  },\n  methods: {\n    handleSelect(key) {\n      this.$router.push(this.permission_routes[key - 1].path).catch(() => {})\n    }\n  }\n}\n</script>\n\n<style lang=\"css\" scoped>\n.el-menu.el-menu--horizontal{\n\tborder-bottom: none;\n}\n.el-menu--horizontal>.el-menu-item{\n\theight: 46px;\n    line-height: 46px;\n}\n</style>\n<style>\n.el-menu--horizontal>.el-submenu .el-submenu__title{\n\theight: 46px !important;\n    line-height: 46px !important;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navbar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navbar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Navbar.vue?vue&type=template&id=0396ad19&scoped=true&\"\nimport script from \"./Navbar.vue?vue&type=script&lang=js&\"\nexport * from \"./Navbar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Navbar.vue?vue&type=style&index=0&id=0396ad19&lang=css&scoped=true&\"\nimport style1 from \"./Navbar.vue?vue&type=style&index=1&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0396ad19\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"app-wrapper\">\n    <div class=\"main-container\">\n      <div>\n        <navbar />\n      </div>\n      <app-main />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { AppMain, Navbar } from './components'\n\nexport default {\n  name: 'Layout',\n  components: {\n    AppMain,\n    Navbar\n  }\n}\n</script>\n\n<style lang=\"css\" scoped>\n  .app-wrapper {\n    position: relative;\n    height: 100%;\n    width: 100%;\n  }\n</style>\n\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=59d714a1&scoped=true&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Index.vue?vue&type=style&index=0&id=59d714a1&lang=css&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"59d714a1\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <div v-if=\"!$route.meta.plainLayout\">\n      <layout />\n    </div>\n    <div v-if=\"$route.meta.plainLayout\" id=\"content-wrapper\">\n      <router-view />\n    </div>\n\n    <!-- <div id=\"nav\">\n\t\t\t<router-link to=\"/\">\n\t\t\t\tHome\n\t\t\t</router-link> |\n\t\t\t<router-link to=\"/about\">\n\t\t\t\tAbout\n\t\t\t</router-link> |\n\t\t\t<router-link to=\"/test\">\n\t\t\t\tTest\n\t\t\t</router-link> |\n\t\t\t<router-link to=\"/document\">\n\t\t\t\tDocument\n\t\t\t</router-link>\n\t\t</div>\n\t\t<router-view /> -->\n  </div>\n</template>\n\n<script>\nimport layout from '@/layout/Index.vue'\n// import store from './store'\n// import { mapState, mapGetters, mapActions } from 'vuex'\nexport default {\n  name: 'App',\n  components: {\n    layout\n  }\n}\n</script>\n\n<style>\nbody{\n\tmargin: 0px;\n}\n@font-face {\n  font-family: \"GoogleRoboto\";\n  src: url(\"assets/Roboto/Roboto-Regular.ttf\") format(\"truetype\");\n}\n\n#app {\n  font-family: 'GoogleRoboto';\n  text-align: center;\n  color: #2c3e50;\n}\n\n#nav {\n  padding: 30px;\n}\n\n#nav a {\n  font-weight: bold;\n  color: #2c3e50;\n}\n\n#nav a.router-link-exact-active {\n  color: #42b983;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=c44aa992&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\nimport router from './router'\nimport store from './store'\nimport 'element-ui/lib/theme-chalk/index.css'\nimport Element from 'element-ui'\nimport locale from 'element-ui/lib/locale/lang/en'\nimport '@fortawesome/fontawesome-free/css/all.css'\nimport '@fortawesome/fontawesome-free/js/all.js'\nimport 'nprogress/nprogress.css'\nimport FBSignInButton from 'vue-facebook-signin-button'\nimport GSignInButton from 'vue-google-signin-button'\nimport VueCookies from 'vue-cookies'\n\nVue.use(VueCookies)\nVue.use(FBSignInButton)\nVue.use(GSignInButton)\n\n// import './permission';\n\nVue.use(Element, { locale })\nVue.config.productionTip = false\n\nnew Vue({\n  router,\n  store,\n  render: h => h(App)\n}).$mount('#app')\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navbar.vue?vue&type=style&index=1&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navbar.vue?vue&type=style&index=1&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=style&index=0&id=59333e48&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=style&index=0&id=59333e48&scoped=true&lang=css&\"","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = \"92c2\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"home\"},[_c('div',{staticClass:\"background\"})])}]\n\nexport { render, staticRenderFns }","<template id=\"home-wrapper\">\n  <div class=\"home\">\n    <div class=\"background\">\n      <!-- <img alt=\"Vue logo\" src=\"../assets/logo.png\">\n\t\t<HelloWorld msg=\"Welcome to Your Vue.js App\" /> -->\n      <!-- <el-button type=\"primary\" style=\"width: 100%;\" @click=\"login()\">\n\t\t\t\tSign in to EdVision\n\t\t\t</el-button> -->\n    </div>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\n// import HelloWorld from '@/components/HelloWorld.vue';\n\nexport default {\n  name: 'Home',\n  mounted() {\n    // console.log(document.body\n    document.documentElement.style.height = '100%'\n    // document.html.style.height = '100%';\n    document.body.style.height = '100%'\n    document.getElementById('app').style.height = '100%'\n    document.getElementById('content-wrapper').style.height = '100%'\n  },\n  methods: {\n    login() {\n      this.$router.push('/test')\n    }\n  }\n}\n</script>\n\n<style scoped>\n.home {\n\theight: 100%;\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n}\n\n.background{\n\twidth: 100%;\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 0%;\n\tbackground: url(\"./../assets/background/Background 4.png\") center center / auto 100% rgb(245, 245, 245);\n\tbackground-position: center center;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Home.vue?vue&type=template&id=59333e48&scoped=true&\"\nimport script from \"./Home.vue?vue&type=script&lang=js&\"\nexport * from \"./Home.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Home.vue?vue&type=style&index=0&id=59333e48&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"59333e48\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._m(0),_vm._m(1),_c('div',{attrs:{\"id\":\"content-wrapper\"}},[_c('div',{staticClass:\"pdfViewer\",style:({ width: _vm.viewerWidth + 'px' }),attrs:{\"id\":\"viewer\",\"document-id\":_vm.documentId}})]),_c('div',{attrs:{\"id\":\"comment-wrapper\"}},[_c('el-card',{staticClass:\"box-card add-new-comment\",staticStyle:{\"width\":\"100%\",\"display\":\"none\"},attrs:{\"id\":\"add-new-comment\"}},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('div',[_c('div',{staticStyle:{\"font-size\":\"15px\",\"font-weight\":\"bold\",\"text-align\":\"left\"}},[_vm._v(\" Dat Le \")])])]),_c('div',[_c('el-input',{attrs:{\"id\":\"comment-text-area\",\"type\":\"textarea\",\"autosize\":\"\",\"placeholder\":\"Add comment\"},model:{value:(_vm.newComment),callback:function ($$v) {_vm.newComment=$$v},expression:\"newComment\"}}),_c('div',{staticStyle:{\"height\":\"20px\",\"margin-top\":\"10px\"}},[_c('el-button',{staticStyle:{\"float\":\"left\",\"padding\":\"5px\"},attrs:{\"type\":\"primary\",\"disabled\":_vm.newComment.replace(/\\s/g, '').length == 0},on:{\"click\":function($event){return _vm.addCommentText()}}},[_vm._v(\" Comment \")]),_c('el-button',{staticStyle:{\"float\":\"right\",\"padding\":\"5px\"},on:{\"click\":function($event){return _vm.cancelCommentText()}}},[_vm._v(\" Cancel \")])],1)],1)]),_vm._l((_vm.comments),function(comment,idx){return _c('el-card',{key:comment.uuid,staticClass:\"box-card comment-card\",style:({top: comment.topPosition + 'px', width: '100%'}),attrs:{\"highlight-id\":comment.uuid,\"top-position\":comment.topPosition}},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('div',[_c('div',{staticStyle:{\"font-size\":\"15px\",\"font-weight\":\"bold\",\"text-align\":\"left\"}},[_vm._v(\" Dat Le \")]),_c('div',{staticStyle:{\"font-size\":\"12px\",\"text-align\":\"left\"}},[_vm._v(\" 3:16 PM Jul 7 \")])]),_c('el-button',{staticClass:\"action-card-btn\",staticStyle:{\"right\":\"-10px\"},attrs:{\"title\":\"Delete Comment\"},on:{\"click\":function($event){return _vm.deleteCommentCard(comment)}}},[_c('i',{staticClass:\"far fa-trash-alt\"})]),_c('el-button',{staticClass:\"action-card-btn\",staticStyle:{\"right\":\"10px\"},attrs:{\"title\":\"Edit Comment\"},on:{\"click\":function($event){return _vm.displayEditComment(comment, idx)}}},[_c('i',{staticClass:\"far fa-edit\"})])],1),_c('div',[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!comment.isSelected),expression:\"!comment.isSelected\"}],staticStyle:{\"text-align\":\"left\",\"overflow-wrap\":\"break-word\",\"white-space\":\"pre-wrap\"},attrs:{\"id\":'comment-text-' + comment.uuid}},[_vm._v(\" \"+_vm._s(comment.content)+\" \")]),_c('el-input',{directives:[{name:\"show\",rawName:\"v-show\",value:(comment.isSelected == true),expression:\"comment.isSelected == true\"}],ref:'comment' + comment.uuid,refInFor:true,attrs:{\"id\":'comment-input-' + comment.uuid,\"type\":\"textarea\",\"autosize\":\"\"},model:{value:(comment.content),callback:function ($$v) {_vm.$set(comment, \"content\", $$v)},expression:\"comment.content\"}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(comment.isSelected == true),expression:\"comment.isSelected == true\"}],staticStyle:{\"height\":\"20px\",\"margin-top\":\"10px\"}},[_c('el-button',{staticStyle:{\"float\":\"left\",\"padding\":\"5px\"},attrs:{\"type\":\"primary\",\"disabled\":comment.content.replace(/\\s/g, '').length == 0},on:{\"click\":function($event){return _vm.editCommentCard()}}},[_vm._v(\" Comment \")]),_c('el-button',{staticStyle:{\"float\":\"right\",\"padding\":\"5px\"},on:{\"click\":function($event){return _vm.cancelCommentText()}}},[_vm._v(\" Cancel \")])],1)],1)])})],2),_c('el-button-group',{staticStyle:{\"display\":\"none\"},attrs:{\"id\":\"textTool\"}},[_c('el-button',{staticClass:\"textToolBtn\",on:{\"click\":function($event){return _vm.HighlightText()}}},[_c('i',{staticClass:\"fas fa-highlighter\"})]),_c('el-button',{staticClass:\"textToolBtn\",on:{\"click\":function($event){return _vm.StrikethroughText()}}},[_c('i',{staticClass:\"fas fa-strikethrough\"})]),_c('el-button',{staticClass:\"textToolBtn\",attrs:{\"id\":\"comment-text\"},on:{\"click\":function($event){return _vm.CommentText()}}},[_c('i',{staticClass:\"fas fa-comment-alt\"})])],1)],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"toolbar\"},[_c('button',{staticClass:\"cursor\",attrs:{\"type\":\"button\",\"title\":\"Cursor\",\"data-tooltype\":\"cursor\"}},[_vm._v(\" ➚ \")]),_c('div',{staticClass:\"spacer\"}),_c('button',{staticClass:\"rectangle\",attrs:{\"type\":\"button\",\"title\":\"Rectangle\",\"data-tooltype\":\"area\"}}),_c('button',{staticClass:\"highlight\",attrs:{\"type\":\"button\",\"title\":\"Highlight\",\"data-tooltype\":\"highlight\"}}),_c('button',{staticClass:\"strikeout\",attrs:{\"type\":\"button\",\"title\":\"Strikeout\",\"data-tooltype\":\"strikeout\"}}),_c('div',{staticClass:\"spacer\"}),_c('button',{staticClass:\"text\",attrs:{\"type\":\"button\",\"title\":\"Text Tool\",\"data-tooltype\":\"text\"}}),_c('select',{staticClass:\"text-size\"}),_c('div',{staticClass:\"text-color\"}),_c('div',{staticClass:\"spacer\"}),_c('div',{staticClass:\"spacer\"}),_c('button',{staticClass:\"comment\",attrs:{\"type\":\"button\",\"title\":\"Comment\",\"data-tooltype\":\"point\"}},[_vm._v(\" 🗨 \")]),_c('div',{staticClass:\"spacer\"}),_c('select',{staticClass:\"scale\"},[_c('option',{attrs:{\"value\":\".5\"}},[_vm._v(\" 50% \")]),_c('option',{attrs:{\"value\":\"1\"}},[_vm._v(\" 100% \")]),_c('option',{attrs:{\"value\":\"1.33\"}},[_vm._v(\" 133% \")]),_c('option',{attrs:{\"value\":\"1.5\"}},[_vm._v(\" 150% \")]),_c('option',{attrs:{\"value\":\"2\"}},[_vm._v(\" 200% \")])]),_c('a',{staticClass:\"rotate-ccw\",attrs:{\"href\":\"javascript://\",\"title\":\"Rotate Counter Clockwise\"}},[_vm._v(\"⟲\")]),_c('a',{staticClass:\"rotate-cw\",attrs:{\"href\":\"javascript://\",\"title\":\"Rotate Clockwise\"}},[_vm._v(\"⟳\")]),_c('div',{staticClass:\"spacer\"}),_c('a',{staticClass:\"clear\",attrs:{\"href\":\"javascript://\",\"title\":\"Clear\"}},[_vm._v(\"×\")]),_c('button',{attrs:{\"id\":\"restore\",\"title\":\"Restore\"}},[_vm._v(\" Restore \")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"rubric-wrapper\"}},[_c('h4',[_vm._v(\"Rubrics\")])])}]\n\nexport { render, staticRenderFns }","/**\n * Throw an Error for an abstract function that hasn't been implemented.\n *\n * @param {String} name The name of the abstract function\n */\nexport default function abstractFunction(name) {\n\tthrow new Error(name + ' is not implemented');\n}\n","/* eslint-disable no-case-declarations */\nimport createStyleSheet from 'create-stylesheet';\n\nexport const BORDER_COLOR = '#00BFFF';\n\nconst userSelectStyleSheet = createStyleSheet({\n\tbody: {\n\t\t'-webkit-user-select': 'none',\n\t\t'-moz-user-select': 'none',\n\t\t'-ms-user-select': 'none',\n\t\t'user-select': 'none'\n\t}\n});\nuserSelectStyleSheet.setAttribute('data-pdf-annotate-user-select', 'true');\n\n/**\n * Find the SVGElement that contains all the annotations for a page\n *\n * @param {Element} node An annotation within that container\n * @return {SVGElement} The container SVG or null if it can't be found\n */\nexport function findSVGContainer(node) {\n\tlet parentNode = node;\n\n\twhile ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n\t\tif (parentNode.nodeName.toUpperCase() === 'SVG' &&\n        parentNode.getAttribute('data-pdf-annotate-container') === 'true') {\n\t\t\treturn parentNode;\n\t\t}\n\t}\n\n\treturn null;\n}\n\n/**\n * Find an SVGElement container at a given point\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @return {SVGElement} The container SVG or null if one can't be found\n */\nexport function findSVGAtPoint(x, y) {\n\tlet elements = document.querySelectorAll('svg[data-pdf-annotate-container=\"true\"]');\n\n\tfor (let i=0, l=elements.length; i<l; i++) {\n\t\tlet el = elements[i];\n\t\tlet rect = el.getBoundingClientRect();\n\n\t\tif (pointIntersectsRect(x, y, rect)) {\n\n\t\t\treturn el;\n\t\t}\n\t}\n\n\treturn null;\n}\n\n/**\n * Find an Element that represents an annotation at a given point\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @return {Element} The annotation element or null if one can't be found\n */\nexport function findAnnotationAtPoint(x, y) {\n\tlet svg = findSVGAtPoint(x, y);\n\tif (!svg) { return; }\n\tlet elements = svg.querySelectorAll('[data-pdf-annotate-type]');\n\n\t// Find a target element within SVG\n\tfor (let i=0, l=elements.length; i<l; i++) {\n\t\tlet el = elements[i];\n\t\tif (pointIntersectsRect(x, y, getOffsetAnnotationRect(el))) {   \n\t\t\treturn el;\n\t\t}\n\t}\n\n\treturn null;\n}\n\n/**\n * Determine if a point intersects a rect\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Object} rect The points of a rect (likely from getBoundingClientRect)\n * @return {Boolean} True if a collision occurs, otherwise false\n */\nexport function pointIntersectsRect(x, y, rect) {\n\treturn y >= rect.top && y <= rect.bottom && x >= rect.left && x <= rect.right;\n}\n\n/**\n * Get the rect of an annotation element accounting for offset.\n *\n * @param {Element} el The element to get the rect of\n * @return {Object} The dimensions of the element\n */\nexport function getOffsetAnnotationRect(el) {\n\tlet rect = getAnnotationRect(el);\n\tlet { offsetLeft, offsetTop } = getOffset(el);\n\treturn {\n\t\ttop: rect.top + offsetTop,\n\t\tleft: rect.left + offsetLeft,\n\t\tright: rect.right + offsetLeft,\n\t\tbottom: rect.bottom + offsetTop\n\t};\n}\n\n/**\n * Get the rect of an annotation element.\n *\n * @param {Element} el The element to get the rect of\n * @return {Object} The dimensions of the element\n */\nexport function getAnnotationRect(el) {\n\tlet h = 0, w = 0, x = 0, y = 0;\n\tlet rect = el.getBoundingClientRect();\n\t// TODO this should be calculated somehow\n\tconst LINE_OFFSET = 16;\n\n\tswitch (el.nodeName.toLowerCase()) {\n\t\tcase 'path':\n\t\t\tlet minX, maxX, minY, maxY;\n\n\t\t\tel.getAttribute('d').replace(/Z/, '').split('M').splice(1).forEach((p) => {\n\t\t\t\tlet s = p.split(' ').map(i => parseInt(i, 10));\n\n\t\t\t\tif (typeof minX === 'undefined' || s[0] < minX) { minX = s[0]; }\n\t\t\t\tif (typeof maxX === 'undefined' || s[2] > maxX) { maxX = s[2]; }\n\t\t\t\tif (typeof minY === 'undefined' || s[1] < minY) { minY = s[1]; }\n\t\t\t\tif (typeof maxY === 'undefined' || s[3] > maxY) { maxY = s[3]; }\n\t\t\t});\n\n\t\t\th = maxY - minY;\n\t\t\tw = maxX - minX;\n\t\t\tx = minX;\n\t\t\ty = minY;\n\t\t\tbreak;\n\n\t\tcase 'line':\n\t\t\th = parseInt(el.getAttribute('y2'), 10) - parseInt(el.getAttribute('y1'), 10);\n\t\t\tw = parseInt(el.getAttribute('x2'), 10) - parseInt(el.getAttribute('x1'), 10);\n\t\t\tx = parseInt(el.getAttribute('x1'), 10);\n\t\t\ty = parseInt(el.getAttribute('y1'), 10);\n\n\t\t\tif (h === 0) {\n\t\t\t\th += LINE_OFFSET;\n\t\t\t\ty -= (LINE_OFFSET / 2);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'text':\n\t\t\th = rect.height;\n\t\t\tw = rect.width;\n\t\t\tx = parseInt(el.getAttribute('x'), 10);\n\t\t\ty = parseInt(el.getAttribute('y'), 10) - h;\n\t\t\tbreak;\n\n\t\tcase 'g':\n\t\t\tlet { offsetLeft, offsetTop } = getOffset(el);\n\t\t\th = rect.height;\n\t\t\tw = rect.width;\n\t\t\tx = rect.left - offsetLeft;\n\t\t\ty = rect.top - offsetTop;\n\n\t\t\tif (el.getAttribute('data-pdf-annotate-type') === 'strikeout') {\n\t\t\t\th += LINE_OFFSET;\n\t\t\t\ty -= (LINE_OFFSET / 2);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'rect':\n\t\tcase 'svg':\n\t\t\th = parseInt(el.getAttribute('height'), 10);\n\t\t\tw = parseInt(el.getAttribute('width'), 10);\n\t\t\tx = parseInt(el.getAttribute('x'), 10);\n\t\t\ty = parseInt(el.getAttribute('y'), 10);\n\t\t\tbreak;\n\t}\n\n\t// Result provides same properties as getBoundingClientRect\n\tlet result = {\n\t\ttop: y,\n\t\tleft: x,\n\t\twidth: w,\n\t\theight: h,\n\t\tright: x + w,\n\t\tbottom: y + h\n\t};\n\n\t// For the case of nested SVG (point annotations) and grouped\n\t// lines or rects no adjustment needs to be made for scale.\n\t// I assume that the scale is already being handled\n\t// natively by virtue of the `transform` attribute.\n\tif (!['svg', 'g'].includes(el.nodeName.toLowerCase())) {\n\t\tresult = scaleUp(findSVGAtPoint(rect.left, rect.top), result);\n\t}\n\n\treturn result;\n}\n\n/**\n * Adjust scale from normalized scale (100%) to rendered scale.\n *\n * @param {SVGElement} svg The SVG to gather metadata from\n * @param {Object} rect A map of numeric values to scale\n * @return {Object} A copy of `rect` with values scaled up\n */\nexport function scaleUp(svg, rect) {\n\tlet result = {};\n\tlet { viewport } = getMetadata(svg);\n\n\tObject.keys(rect).forEach((key) => {\n\t\tresult[key] = rect[key] * viewport.scale;\n\t});\n\n\treturn result;\n}\n\n/**\n * Adjust scale from rendered scale to a normalized scale (100%).\n *\n * @param {SVGElement} svg The SVG to gather metadata from\n * @param {Object} rect A map of numeric values to scale\n * @return {Object} A copy of `rect` with values scaled down\n */\nexport function scaleDown(svg, rect) {\n\tlet result = {};\n\tlet { viewport } = getMetadata(svg);\n\n\tObject.keys(rect).forEach((key) => {\n\t\tresult[key] = rect[key] / viewport.scale;\n\t});\n\n\treturn result;\n}\n\n/**\n * Get the scroll position of an element, accounting for parent elements\n *\n * @param {Element} el The element to get the scroll position for\n * @return {Object} The scrollTop and scrollLeft position\n */\nexport function getScroll(el) {\n\tlet scrollTop = 0;\n\tlet scrollLeft = 0;\n\tlet parentNode = el;\n\n\twhile ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n\t\tscrollTop += parentNode.scrollTop;\n\t\tscrollLeft += parentNode.scrollLeft;\n\t}\n\n\treturn { scrollTop, scrollLeft };\n}\n\n/**\n * Get the offset position of an element, accounting for parent elements\n *\n * @param {Element} el The element to get the offset position for\n * @return {Object} The offsetTop and offsetLeft position\n */\nexport function getOffset(el) {\n\tlet parentNode = el;\n\n\twhile ((parentNode = parentNode.parentNode) &&\n          parentNode !== document) {\n\t\tif (parentNode.nodeName.toUpperCase() === 'SVG') {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tlet rect = parentNode.getBoundingClientRect();\n\n\treturn { offsetLeft: rect.left, offsetTop: rect.top };\n}\n\n/**\n * Disable user ability to select text on page\n */\nexport function disableUserSelect() {\n\tif (!userSelectStyleSheet.parentNode) {\n\t\tdocument.head.appendChild(userSelectStyleSheet);\n\t}\n}\n\n\n/**\n * Enable user ability to select text on page\n */\nexport function enableUserSelect() {\n\tif (userSelectStyleSheet.parentNode) {\n\t\tuserSelectStyleSheet.parentNode.removeChild(userSelectStyleSheet);\n\t}\n}\n\n/**\n * Get the metadata for a SVG container\n *\n * @param {SVGElement} svg The SVG container to get metadata for\n */\nexport function getMetadata(svg) {\n\treturn {\n\t\tdocumentId: svg.getAttribute('data-pdf-annotate-document'),\n\t\tpageNumber: parseInt(svg.getAttribute('data-pdf-annotate-page'), 10),\n\t\tviewport: JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'))\n\t};\n}\n","import EventEmitter from 'events';\nimport {\n\tfindAnnotationAtPoint,\n\tfindSVGAtPoint\n} from './utils';\n\nconst emitter = new EventEmitter;\n\nlet clickNode;\n\n/**\n * Handle document.click event\n *\n * @param {Event} e The DOM event to be handled\n */\ndocument.addEventListener('click', function handleDocumentClick(e) {\n\tif (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\n\n\tlet target = findAnnotationAtPoint(e.clientX, e.clientY);\n\n\t// Emit annotation:blur if clickNode is no longer clicked\n\tif (clickNode && clickNode !== target) {\n\t\temitter.emit('annotation:blur', clickNode);\n\t}\n\n\t// Emit annotation:click if target was clicked\n\tif (target) {\n\t\temitter.emit('annotation:click', target);\n\t}\n\n\tclickNode = target;\n});\n\n// let mouseOverNode;\n// document.addEventListener('mousemove', function handleDocumentMousemove(e) {\n//   let target = findAnnotationAtPoint(e.clientX, e.clientY);\n//\n//   // Emit annotation:mouseout if target was mouseout'd\n//   if (mouseOverNode && !target) {\n//     emitter.emit('annotation:mouseout', mouseOverNode);\n//   }\n//\n//   // Emit annotation:mouseover if target was mouseover'd\n//   if (target && mouseOverNode !== target) {\n//     emitter.emit('annotation:mouseover', target);\n//   }\n//\n//   mouseOverNode = target;\n// });\n\nexport function fireEvent() { emitter.emit(...arguments); }\nexport function addEventListener() { emitter.on(...arguments); }\nexport function removeEventListener() { emitter.removeListener(...arguments); }\n","/* eslint-disable no-unused-vars */\nimport abstractFunction from '../utils/abstractFunction';\nimport { fireEvent } from '../UI/event';\n\n// Adapter should never be invoked publicly\nexport default class StoreAdapter {\n\t/**\n   * Create a new StoreAdapter instance\n   *\n   * @param {Object} [definition] The definition to use for overriding abstract methods\n   */\n\tconstructor(definition = {}) {\n\t\t// Copy each function from definition if it is a function we know about\n\t\tObject.keys(definition).forEach((key) => {\n\t\t\tif (typeof definition[key] === 'function' &&\n          typeof this[key] === 'function') {\n\t\t\t\tthis[key] = definition[key];\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n   * Get all the annotations for a given document and page number.\n   *\n   * @param {String} documentId The ID for the document the annotations belong to\n   * @param {Number} pageNumber The number of the page the annotations belong to\n   * @return {Promise}\n   */\n\t__getAnnotations(documentId, pageNumber) { abstractFunction('getAnnotations'); }\n\tget getAnnotations() { return this.__getAnnotations; }\n\tset getAnnotations(fn) {\n\t\tthis.__getAnnotations = function getAnnotations(documentId, pageNumber) {\n\t\t\treturn fn(...arguments).then((annotations) => {\n\t\t\t\t// TODO may be best to have this happen on the server\n\t\t\t\tif (annotations.annotations) {\n\t\t\t\t\tannotations.annotations.forEach((a) => {\n\t\t\t\t\t\ta.documentId = documentId;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn annotations;\n\t\t\t});\n\t\t};\n\t}\n\n\t/**\n   * Get the definition for a specific annotation.\n   *\n   * @param {String} documentId The ID for the document the annotation belongs to\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise}\n   */\n\tgetAnnotation(documentId, annotationId) { abstractFunction('getAnnotation'); }\n\n\t/**\n   * Add an annotation\n   *\n   * @param {String} documentId The ID for the document to add the annotation to\n   * @param {String} pageNumber The page number to add the annotation to\n   * @param {Object} annotation The definition for the new annotation\n   * @return {Promise}\n   */\n\t__addAnnotation(documentId, pageNumber, annotation) { abstractFunction('addAnnotation'); }\n\tget addAnnotation() { return this.__addAnnotation; }\n\tset addAnnotation(fn) {\n\t\tthis.__addAnnotation = function addAnnotation(documentId, pageNumber, annotation) {\n\t\t\treturn fn(...arguments).then((annotation) => {\n\t\t\t\tfireEvent('annotation:add', documentId, pageNumber, annotation);\n\t\t\t\treturn annotation;\n\t\t\t});\n\t\t};\n\t}\n\n\t/**\n   * Edit an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} pageNumber the page number of the annotation\n   * @param {Object} annotation The definition of the modified annotation\n   * @return {Promise}\n   */\n\t__editAnnotation(documentId, pageNumber, annotation) { abstractFunction('editAnnotation'); }\n\tget editAnnotation() { return this.__editAnnotation; }\n\tset editAnnotation(fn) {\n\t\tthis.__editAnnotation = function editAnnotation(documentId, annotationId, annotation) {\n\t\t\treturn fn(...arguments).then((annotation) => {\n\t\t\t\tfireEvent('annotation:edit', documentId, annotationId, annotation);\n\t\t\t\treturn annotation;\n\t\t\t});\n\t\t};\n\t}\n\n\t/**\n   * Delete an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise}\n   */\n\t__deleteAnnotation(documentId, annotationId) { abstractFunction('deleteAnnotation'); }\n\tget deleteAnnotation() { return this.__deleteAnnotation; }\n\tset deleteAnnotation(fn) {\n\t\tthis.__deleteAnnotation = function deleteAnnotation(documentId, annotationId) {\n\t\t\treturn fn(...arguments).then((success) => {\n\t\t\t\tif (success) {\n\t\t\t\t\tfireEvent('annotation:delete', documentId, annotationId);\n\t\t\t\t}\n\t\t\t\treturn success;\n\t\t\t});\n\t\t};\n\t}\n\n\t/**\n   * Get all the comments for an annotation\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @return {Promise}\n   */\n\tgetComments(documentId, annotationId) { abstractFunction('getComments'); }\n  \n\tupdateComments(documentId, annotations){abstractFunction('updateComments');}\n\t/**\n   * Add a new comment\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} annotationId The ID for the annotation\n   * @param {Object} content The definition of the comment\n   * @return {Promise}\n   */\n\t__addComment(documentId, annotation, content, selectedText, topPos) { abstractFunction('addComment'); }\n\tget addComment() { return this.__addComment; }\n\tset addComment(fn) {\n\t\tthis.__addComment = function addComment(documentId, annotation, content, selectedText, topPos) {\n\t\t\treturn fn(...arguments).then((comment) => {\n\t\t\t\tfireEvent('comment:add', documentId, annotation.uuid, comment);\n\t\t\t\treturn comment;\n\t\t\t});\n\t\t};\n\t}\n\n\t/**\n   * Delete a comment\n   *\n   * @param {String} documentId The ID for the document\n   * @param {String} commentId The ID for the comment\n   * @return {Promise}\n   */\n\t__deleteComment(documentId, commentId) { abstractFunction('deleteComment'); }\n\tget deleteComment() { return this.__deleteComment; }\n\tset deleteComment(fn) {\n\t\tthis.__deleteComment = function deleteComment(documentId, commentId) {\n\t\t\treturn fn(...arguments).then((success) => {\n\t\t\t\tif (success) {\n\t\t\t\t\tfireEvent('comment:delete', documentId, commentId);\n\t\t\t\t}\n\t\t\t\treturn success;\n\t\t\t});\n\t\t};\n\t}\n}\n","const REGEXP = /[xy]/g;\nconst PATTERN = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx';\n\nfunction replacement(c) {\n\tlet r = Math.random()*16|0;\n\tlet v = c == 'x' ? r : (r&0x3|0x8);\n\treturn v.toString(16);\n}\n\n/**\n * Generate a univierally unique identifier\n *\n * @return {String}\n */\nexport default function uuid() {\n\treturn PATTERN.replace(REGEXP, replacement);\n}\n","/* eslint-disable no-unused-vars */\nimport uuid from '../utils/uuid';\nimport StoreAdapter from './StoreAdapter';\n\n// StoreAdapter for working with localStorage\n// This is ideal for testing, examples, and prototyping\nexport default class LocalStoreAdapter extends StoreAdapter {\n\tconstructor() {\n\t\tsuper({\n\t\t\tgetAnnotations(documentId, pageNumber) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tlet annotations = getAnnotations(documentId).filter((i) => {\n\t\t\t\t\t\treturn i.page === pageNumber && i.class === 'Annotation';\n\t\t\t\t\t});\n\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tdocumentId,\n\t\t\t\t\t\tpageNumber,\n\t\t\t\t\t\tannotations\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tgetAnnotation(documentId, annotationId) {\n\t\t\t\treturn Promise.resolve(getAnnotations(documentId)[findAnnotation(documentId, annotationId)]);\n\t\t\t},\n\n\t\t\taddAnnotation(documentId, pageNumber, annotation) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tannotation.class = 'Annotation';\n\t\t\t\t\tannotation.uuid = uuid();\n\t\t\t\t\tannotation.page = pageNumber;\n\n\t\t\t\t\tlet annotations = getAnnotations(documentId);\n\t\t\t\t\tannotations.push(annotation);\n\t\t\t\t\tupdateAnnotations(documentId, annotations);\n\t\t\t\t\tconsole.log(annotations);\n\t\t\t\t\tresolve(annotation);\n\t\t\t\t});\n\t\t\t},\n\n\t\t\teditAnnotation(documentId, annotationId, annotation) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tlet annotations = getAnnotations(documentId);\n\t\t\t\t\tannotations[findAnnotation(documentId, annotationId)] = annotation;\n\t\t\t\t\tupdateAnnotations(documentId, annotations);\n\n\t\t\t\t\tresolve(annotation);\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tdeleteAnnotation(documentId, annotationId) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tlet index = findAnnotation(documentId, annotationId);\n\t\t\t\t\tif (index > -1) {\n\t\t\t\t\t\tlet annotations = getAnnotations(documentId);\n\t\t\t\t\t\tannotations.splice(index, 1);\n\t\t\t\t\t\tupdateAnnotations(documentId, annotations);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(true);\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tgetComments(documentId) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tresolve(getAnnotations(documentId).filter((i) => {\n\t\t\t\t\t\treturn i.class === 'Comment';\n\t\t\t\t\t}));\n\t\t\t\t});\n\t\t\t},\n\n\t\t\taddComment(documentId, annotation, content, selectedText, topPos) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tlet comment = {\n\t\t\t\t\t\tclass: 'Comment',\n\t\t\t\t\t\tuuid: annotation.uuid,\n\t\t\t\t\t\tannotation: annotation,\n\t\t\t\t\t\tcontent: content,\n\t\t\t\t\t\ttext: selectedText,\n\t\t\t\t\t\ttopPosition: topPos\n\t\t\t\t\t};\n\n\t\t\t\t\tconsole.log(comment);\n\n\t\t\t\t\tlet annotations = getAnnotations(documentId);\n\t\t\t\t\tannotations.push(comment);\n\t\t\t\t\tupdateAnnotations(documentId, annotations);\n\n\t\t\t\t\tresolve(comment);\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdateComments(documentId, comments){\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tlet annotations = getAnnotations(documentId);\n\t\t\t\t\tfor (let i=0, l=annotations.length; i<l; i++) {\n\t\t\t\t\t\tif(annotations[i].class == 'Comment'){\n\t\t\t\t\t\t\tlet thisComment = comments.filter(item => {return (item.uuid == annotations[i].uuid);});\n\t\t\t\t\t\t\tif(thisComment && thisComment.length > 0)\n\t\t\t\t\t\t\t\tannotations[i] = thisComment[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tupdateAnnotations(documentId, annotations);\n\t\t\t\t\tresolve(true);\n\t\t\t\t});\n        \n\t\t\t},\n\t\t\tdeleteComment(documentId, commentId) {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tgetAnnotations(documentId);\n\t\t\t\t\tlet index = -1;\n\t\t\t\t\tlet annotations = getAnnotations(documentId);\n\t\t\t\t\tfor (let i=0, l=annotations.length; i<l; i++) {\n\t\t\t\t\t\tif (annotations[i].uuid === commentId) {\n\t\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (index > -1) {\n\t\t\t\t\t\tannotations.splice(index, 1);\n\t\t\t\t\t\tupdateAnnotations(documentId, annotations);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(true);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction getAnnotations(documentId) {\n\treturn JSON.parse(localStorage.getItem(`${documentId}/annotations`)) || [];\n}\n\nfunction updateAnnotations(documentId, annotations) {\n\tlocalStorage.setItem(`${documentId}/annotations`, JSON.stringify(annotations));\n}\n\nfunction findAnnotation(documentId, annotationId) {\n\tlet index = -1;\n\tlet annotations = getAnnotations(documentId);\n\tfor (let i=0, l=annotations.length; i<l; i++) {\n\t\tif (annotations[i].uuid === annotationId) {\n\t\t\tindex = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn index;\n}\n","const UPPER_REGEX = /[A-Z]/g;\n\n// Don't convert these attributes from camelCase to hyphenated-attributes\nconst BLACKLIST = [\n\t'viewBox'\n];\n\nlet keyCase = (key) => {\n\tif (BLACKLIST.indexOf(key) === -1) {\n\t\tkey = key.replace(UPPER_REGEX, match => '-' + match.toLowerCase());\n\t}\n\treturn key;\n};\n\n/**\n * Set attributes for a node from a map\n *\n * @param {Node} node The node to set attributes on\n * @param {Object} attributes The map of key/value pairs to use for attributes\n */\nexport default function setAttributes(node, attributes) {\n\tObject.keys(attributes).forEach((key) => {\n\t\tnode.setAttribute(keyCase(key), attributes[key]);\n\t});\n}\n","const REGEX_HASHLESS_HEX = /^([a-f0-9]{6}|[a-f0-9]{3})$/i;\n\n/**\n * Normalize a color value\n *\n * @param {String} color The color to normalize\n * @return {String}\n */\nexport default function normalizeColor(color) {\n\tif (REGEX_HASHLESS_HEX.test(color)) {\n\t\tcolor = `#${color}`;\n\t}\n\treturn color;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGLineElements from an annotation definition.\n * This is used for anntations of type `strikeout`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement} A group of all lines to be rendered\n */\nexport default function renderLine(a) {\n\tlet group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n\tsetAttributes(group, {\n\t\tstroke: normalizeColor(a.color || '#f00'),\n\t\tstrokeWidth: 1\n\t});\n\n\ta.rectangles.forEach((r) => {\n\t\tlet line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n\n\t\tsetAttributes(line, {\n\t\t\tx1: r.x,\n\t\t\ty1: r.y,\n\t\t\tx2: r.x + r.width,\n\t\t\ty2: r.y,\n\t\t});\n\n\t\tgroup.appendChild(line);\n\t});\n\n\treturn group;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGPathElement from an annotation definition.\n * This is used for anntations of type `drawing`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGPathElement} The path to be rendered\n */\nexport default function renderPath(a) {\n\tlet d = [];\n\tlet path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n  \n\tfor (let i=0, l=a.lines.length; i<l; i++) {\n\t\tlet p1 = a.lines[i];\n\t\tlet p2 = a.lines[i+1];\n\t\tif (p2) {\n\t\t\td.push(`M${p1[0]} ${p1[1]} ${p2[0]} ${p2[1]}`);\n\t\t}\n\t}\n  \n\tsetAttributes(path, {\n\t\td: `${d.join(' ')}Z`,\n\t\tstroke: normalizeColor(a.color || '#000'),\n\t\tstrokeWidth: a.width || 1,\n\t\tfill: 'none'\n\t});\n\n\treturn path;\n}\n","import setAttributes from '../utils/setAttributes';\n\nconst SIZE = 25;\nconst D = 'M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z';\n\n/**\n * Create SVGElement from an annotation definition.\n * This is used for anntations of type `comment`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGElement} A svg to be rendered\n */\nexport default function renderPoint(a) {\n\tlet outerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n\tlet innerSVG = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n\tlet rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\tlet path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\n\tsetAttributes(outerSVG,  {\n\t\twidth: SIZE,\n\t\theight: SIZE,\n\t\tx: a.x,\n\t\ty: a.y\n\t});\n\n\tsetAttributes(innerSVG, {\n\t\twidth: SIZE,\n\t\theight: SIZE,\n\t\tx: 0,\n\t\ty: (SIZE * 0.05) * -1,\n\t\tviewBox: '0 0 1000 1000'\n\t});\n\n\tsetAttributes(rect, {\n\t\twidth: SIZE,\n\t\theight: SIZE,\n\t\tstroke: '#000',\n\t\tfill: '#ff0'\n\t});\n\n\tsetAttributes(path, {\n\t\td: D,\n\t\tstrokeWidth: 50,\n\t\tstroke: '#000',\n\t\tfill: '#fff'\n\t});\n\n\tinnerSVG.appendChild(path);\n\touterSVG.appendChild(rect);\n\touterSVG.appendChild(innerSVG);\n\n\treturn outerSVG;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGRectElements from an annotation definition.\n * This is used for anntations of type `area` and `highlight`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGGElement|SVGRectElement} A group of all rects to be rendered\n */\nexport default function renderRect(a) {\n\tif (a.type === 'highlight' || a.type === 'comment-highlight') {\n\t\tlet group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n\t\tlet order = 1;\n\n\t\tlet otherGroups = document.querySelectorAll(\"g[top='\"+ a.top +\"']\");\n\t\tif(otherGroups.length > 0){\n\t\t\tlet groupsArr = Array.prototype.slice.call(otherGroups);\n\t\t\tlet max = Math.max.apply(Math, groupsArr.map(function(o) { return parseInt(o.getAttribute('order')); }));\n\t\t\torder = max + 1;\n\t\t}\n    \n\t\tsetAttributes(group, {\n\t\t\tfill: normalizeColor(a.color || '#ff0'),\n\t\t\tfillOpacity: 0.2,\n\t\t\ttop: a.top,\n\t\t\tpageNum: a.pageNum,\n\t\t\tpageHeight: a.pageHeight,\n\t\t\torder: order\n\t\t});\n    \n\t\ta.rectangles.forEach((r) => {\n\t\t\tgroup.appendChild(createRect(r));\n\t\t});\n\n\t\treturn group;\n\t} else {\n\t\tlet rect = createRect(a);\n\t\tsetAttributes(rect, {\n\t\t\tstroke: normalizeColor(a.color || '#f00'),\n\t\t\tfill: 'none'\n\t\t});\n\n\t\treturn rect;\n\t}\n}\n\nfunction createRect(r) {\n\tlet rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\n\tsetAttributes(rect, {\n\t\tx: r.x,\n\t\ty: r.y,\n\t\twidth: r.width,\n\t\theight: r.height\n\t});\n\n\treturn rect;\n}\n","import setAttributes from '../utils/setAttributes';\nimport normalizeColor from '../utils/normalizeColor';\n\n/**\n * Create SVGTextElement from an annotation definition.\n * This is used for anntations of type `textbox`.\n *\n * @param {Object} a The annotation definition\n * @return {SVGTextElement} A text to be rendered\n */\nexport default function renderText(a) {\n\tlet text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n\n\tsetAttributes(text, {\n\t\tx: a.x,\n\t\ty: a.y + parseInt(a.size, 10),\n\t\tfill: normalizeColor(a.color || '#000'),\n\t\tfontSize: a.size\n\t});\n\ttext.innerHTML = a.content;\n\n\treturn text;\n}\n","import objectAssign from 'object-assign';\nimport renderLine from './renderLine';\nimport renderPath from './renderPath';\nimport renderPoint from './renderPoint';\nimport renderRect from './renderRect';\nimport renderText from './renderText';\n//import { wrap } from 'module';\n\nconst isFirefox = /firefox/i.test(navigator.userAgent);\n\n/**\n * Get the x/y translation to be used for transforming the annotations\n * based on the rotation of the viewport.\n *\n * @param {Object} viewport The viewport data from the page\n * @return {Object}\n */\nfunction getTranslation(viewport) {\n\tlet x;\n\tlet y;\n\n\t// Modulus 360 on the rotation so that we only\n\t// have to worry about four possible values.\n\tswitch(viewport.rotation % 360) {\n\t\tcase 0:\n\t\t\tx = y = 0;\n\t\t\tbreak;\n\t\tcase 90:\n\t\t\tx = 0;\n\t\t\ty = (viewport.width / viewport.scale) * -1;\n\t\t\tbreak;\n\t\tcase 180:\n\t\t\tx = (viewport.width / viewport.scale) * -1;\n\t\t\ty = (viewport.height / viewport.scale) * -1;\n\t\t\tbreak;\n\t\tcase 270:\n\t\t\tx = (viewport.height / viewport.scale) * -1;\n\t\t\ty = 0;\n\t\t\tbreak;\n\t}\n\n\treturn { x, y };\n}\n\n/**\n * Transform the rotation and scale of a node using SVG's native transform attribute.\n *\n * @param {Node} node The node to be transformed\n * @param {Object} viewport The page's viewport data\n * @return {Node}\n */\nfunction transform(node, viewport) {\n\tlet trans = getTranslation(viewport);\n\n\t// Let SVG natively transform the element\n\tnode.setAttribute('transform', `scale(${viewport.scale}) rotate(${viewport.rotation}) translate(${trans.x}, ${trans.y})`);\n  \n\t// Manually adjust x/y for nested SVG nodes\n\tif (!isFirefox && node.nodeName.toLowerCase() === 'svg') {\n\t\tnode.setAttribute('x', parseInt(node.getAttribute('x'), 10) * viewport.scale);\n\t\tnode.setAttribute('y', parseInt(node.getAttribute('y'), 10) * viewport.scale);\n\n\t\tlet x = parseInt(node.getAttribute('x', 10));\n\t\tlet y = parseInt(node.getAttribute('y', 10));\n\t\tlet width = parseInt(node.getAttribute('width'), 10);\n\t\tlet height = parseInt(node.getAttribute('height'), 10);\n\t\tlet path = node.querySelector('path');\n\t\tlet svg = path.parentNode;\n   \n\t\t// Scale width/height\n\t\t[node, svg, path, node.querySelector('rect')].forEach((n) => {\n\t\t\tn.setAttribute('width', parseInt(n.getAttribute('width'), 10) * viewport.scale);\n\t\t\tn.setAttribute('height', parseInt(n.getAttribute('height'), 10) * viewport.scale);\n\t\t});\n\n\t\t// Transform path but keep scale at 100% since it will be handled natively\n\t\ttransform(path, objectAssign({}, viewport, { scale: 1 }));\n    \n\t\tswitch(viewport.rotation % 360) {\n\t\t\tcase 90:\n\t\t\t\tnode.setAttribute('x', viewport.width - y - width);\n\t\t\t\tnode.setAttribute('y', x);\n\t\t\t\tsvg.setAttribute('x', 1);\n\t\t\t\tsvg.setAttribute('y', 0);\n\t\t\t\tbreak;\n\t\t\tcase 180:\n\t\t\t\tnode.setAttribute('x', viewport.width - x - width);\n\t\t\t\tnode.setAttribute('y', viewport.height - y - height);\n\t\t\t\tsvg.setAttribute('y', 2);\n\t\t\t\tbreak;\n\t\t\tcase 270:\n\t\t\t\tnode.setAttribute('x', y);\n\t\t\t\tnode.setAttribute('y', viewport.height - x - height);\n\t\t\t\tsvg.setAttribute('x', -1);\n\t\t\t\tsvg.setAttribute('y', 0);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn node;\n}\n\n/**\n * Append an annotation as a child of an SVG.\n *\n * @param {SVGElement} svg The SVG element to append the annotation to\n * @param {Object} annotation The annotation definition to render and append\n * @param {Object} viewport The page's viewport data\n * @return {SVGElement} A node that was created and appended by this function\n */\nexport default function appendChild(svg, annotation, viewport) {\n\tif (!viewport) {\n\t\tviewport = JSON.parse(svg.getAttribute('data-pdf-annotate-viewport'));\n\t}\n  \n\tlet child;\n\tswitch (annotation.type) {\n\t\tcase 'area':\n\t\tcase 'comment-highlight':\n\t\tcase 'highlight':\n\t\t\tchild = renderRect(annotation);\n\t\t\tbreak;\n\t\tcase 'strikeout':\n\t\t\tchild = renderLine(annotation);\n\t\t\tbreak;\n\t\tcase 'point':\n\t\t\tchild = renderPoint(annotation);\n\t\t\tbreak;\n\t\tcase 'textbox':\n\t\t\tchild = renderText(annotation);\n\t\t\tbreak;\n\t\tcase 'drawing':\n\t\t\tchild = renderPath(annotation);\n\t\t\tbreak;\n\t}\n\n\t// If no type was provided for an annotation it will result in node being null.\n\t// Skip appending/transforming if node doesn't exist.\n\tif (child) {\n\t\t// Set attributes\n\t\tchild.setAttribute('data-pdf-annotate-id', annotation.uuid);\n\t\tchild.setAttribute('data-pdf-annotate-type', annotation.type);\n\t\tchild.setAttribute('aria-hidden', true);\n\n\n\t\t// INSERT the group element into its CORRECT order, not before its wrapper\n\t\tlet wrapperNode = findWrapperNode(svg, child);\n\t\tif(wrapperNode != null)\n\t\t\twrapperNode.before(transform(child, viewport));\n\t\telse\n\t\t\tsvg.appendChild(transform(child, viewport));\n\t}\n\n\treturn child;\n}\n\nfunction isArrayInArray(arr, childArr){\n\tlet isWrapped = true;\n\tlet arrString = arr.toString();\n\tfor(let i = 0; i < childArr.length; i++){\n\t\tif(!arrString.includes(childArr[i])){\n\t\t\tisWrapped = false;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn isWrapped;\n}\n\nfunction findWrapperNode(svg, node){\n\tlet rects = node.childNodes;\n\tif(rects.length > 0){\n\t\tlet wrapperRects = svg.querySelectorAll(\"rect[y='\" + rects[0].getAttribute('y') + \"']\");\n\t\tif(wrapperRects.length > 0){\n\t\t\tif(rects.length == 1){\n\t\t\t\tif(wrapperRects[0].parentNode.childNodes.length == 1){\n\t\t\t\t\tlet rectX = parseInt(rects[0].getAttribute('x'));\n\t\t\t\t\tlet rectWidth = parseInt(rects[0].getAttribute('width'));\n\t\t\t\t\tlet wrapperX = parseInt(wrapperRects[0].getAttribute('x'));\n\t\t\t\t\tlet wrapperWidth = parseInt(wrapperRects[0].getAttribute('width'));\n\t\t\t\t\tif(rectX < wrapperX && rectWidth > wrapperWidth)\n\t\t\t\t\t\treturn null;\n\t\t\t\t} \n\t\t\t} else {\n\t\t\t\t// node has more than 1 rects\n\t\t\t\tlet wrapper =  null;\n\t\t\t\tlet rectsY = Array.prototype.slice.call(rects).map(function(r) { return r.getAttribute('y'); });\n\t\t\t\t// check all parents of wrapperRects\n\t\t\t\tfor(let i = 0; i < wrapperRects.length; i++){\n\t\t\t\t\tlet item = wrapperRects[i];\n\t\t\t\t\tlet wrapperChildRects = item.parentNode.childNodes;\n\t\t\t\t\tif(rects.length <= wrapperChildRects.length){\n\t\t\t\t\t\tlet wrapperY = Array.prototype.slice.call(wrapperChildRects).map(function(r) { return r.getAttribute('y'); });\n\t\t\t\t\t\tif(isArrayInArray(wrapperY, rectsY)){\n\t\t\t\t\t\t\twrapper = item.parentNode;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn wrapper;\n\t\t\t}\n\t\t\treturn wrapperRects[0].parentNode;\n\t\t} \n\t}\n\treturn null;\n}\n","/**\n * Create a node that is only visible to screen readers\n *\n * @param {String} content The text content that should be read by screen reader\n * @param {String} [annotationId] The ID of the annotation assocaited\n * @return {Element} An Element that is only visible to screen readers\n */\nexport default function createScreenReaderOnly(content, annotationId) {\n\tlet node = document.createElement('div');\n\tlet text = document.createTextNode(content);\n\tnode.appendChild(text);\n\tnode.setAttribute('id', `pdf-annotate-screenreader-${annotationId}`);\n\tnode.style.position = 'absolute';\n\tnode.style.left = '-10000px';\n\tnode.style.top = 'auto';\n\tnode.style.width = '1px';\n\tnode.style.height = '1px';\n\tnode.style.overflow = 'hidden';\n\treturn node;\n}\n","import {\n\tpointIntersectsRect,\n\tscaleUp,\n\tscaleDown\n} from '../UI/utils'; \n\n/**\n * Insert an element at a point within the document.\n * This algorithm will only insert within an element amidst it's text content.\n *\n * @param {Element} el The element to be inserted\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page number to limit elements to\n * @param {Boolean} insertBefore Whether the element is to be inserted before or after x\n * @return {Boolean} True if element was able to be inserted, otherwise false\n */\nexport default function insertElementWithinElement(el, x, y, pageNumber, insertBefore) {\n\tconst OFFSET_ADJUST = 2;\n\n\t// If inserting before adjust `x` by looking for element a few px to the right\n\t// Otherwise adjust a few px to the left\n\t// This is to allow a little tolerance by searching within the box, instead\n\t// of getting a false negative by testing right on the border.\n\tx = Math.max(x + (OFFSET_ADJUST * (insertBefore ? 1 : -1)), 0);\n\n\tlet node = textLayerElementFromPoint(x, y + OFFSET_ADJUST, pageNumber);\n\tif (!node) {\n\t\treturn false;\n\t}\n  \n\t// Now that node has been found inverse the adjustment for `x`.\n\t// This is done to accomodate tolerance by cutting off on the outside of the\n\t// text boundary, instead of missing a character by cutting off within.\n\tx = x + (OFFSET_ADJUST * (insertBefore ? -1 : 1));\n\n\tlet svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n\tlet left = scaleDown(svg, {left: node.getBoundingClientRect().left}).left - svg.getBoundingClientRect().left;\n\tlet temp = node.cloneNode(true);\n\tlet head = temp.innerHTML.split('');\n\tlet tail = [];\n\n\t// Insert temp off screen\n\ttemp.style.position = 'absolute';\n\ttemp.style.top = '-10000px';\n\ttemp.style.left = '-10000px';\n\tdocument.body.appendChild(temp);\n\n\twhile (head.length) {\n\t\t// Don't insert within HTML tags\n\t\tif (head[head.length - 1] === '>') {\n\t\t\twhile(head.length) {\n\t\t\t\ttail.unshift(head.pop());\n\t\t\t\tif (tail[0] === '<') {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n    \n\t\t// Check if width of temp based on current head value satisfies x\n\t\ttemp.innerHTML = head.join('');\n\t\tlet width = scaleDown(svg, {width: temp.getBoundingClientRect().width}).width;\n\t\tif (left + width <= x) {\n\t\t\tbreak;\n\t\t}\n\t\ttail.unshift(head.pop());\n\t}\n  \n\t// Update original node with new markup, including element to be inserted\n\tnode.innerHTML = head.join('') + el.outerHTML + tail.join('');\n\ttemp.parentNode.removeChild(temp);\n\n\treturn true;\n}\n\n/**\n * Get a text layer element at a given point on a page\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page to limit elements to\n * @return {Element} First text layer element found at the point\n */\nfunction textLayerElementFromPoint(x, y, pageNumber) {\n\tlet svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n\tlet rect = svg.getBoundingClientRect();\n\ty = scaleUp(svg, {y}).y + rect.top;\n\tx = scaleUp(svg, {x}).x + rect.left;\n\treturn [...svg.parentNode.querySelectorAll('.textLayer [data-canvas-width]')].filter((el) => {\n\t\treturn pointIntersectsRect(x, y, el.getBoundingClientRect());\n\t})[0];\n}\n","import insertElementWithinElement from './insertElementWithinElement';\nimport { pointIntersectsRect } from '../UI/utils';\nimport { scaleUp } from '../UI/utils'; \n\n/**\n * Insert an element at a point within the document.\n * This algorithm will try to insert between elements if possible.\n * It will however use `insertElementWithinElement` if it is more accurate.\n *\n * @param {Element} el The element to be inserted\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n * @param {Number} pageNumber The page number to limit elements to\n * @return {Boolean} True if element was able to be inserted, otherwise false\n */\nexport default function insertElementWithinChildren(el, x, y, pageNumber) {\n\t// Try and use most accurate method of inserting within an element\n\tif (insertElementWithinElement(el, x, y, pageNumber, true)) {\n\t\treturn true;\n\t}\n\n\t// Fall back to inserting between elements\n\tlet svg = document.querySelector(`svg[data-pdf-annotate-page=\"${pageNumber}\"]`);\n\tlet rect = svg.getBoundingClientRect();\n\tlet nodes = [...svg.parentNode.querySelectorAll('.textLayer > div')];\n\n\ty = scaleUp(svg, {y}).y + rect.top;\n\tx = scaleUp(svg, {x}).x + rect.left;\n\n\t// Find the best node to insert before\n\tfor (let i=0, l=nodes.length; i<l; i++) {\n\t\tlet n = nodes[i];\n\t\tlet r = n.getBoundingClientRect();\n\t\tif (y <= r.top) {\n\t\t\tn.parentNode.insertBefore(el, n);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t// If all else fails try to append to the bottom\n\tlet textLayer = svg.parentNode.querySelector('.textLayer');\n\tif (textLayer) {\n\t\tlet textRect = textLayer.getBoundingClientRect();\n\t\tif (pointIntersectsRect(x, y, textRect)) {\n\t\t\ttextLayer.appendChild(el);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n","/**\n * Insert a comment into the DOM to be available by screen reader\n *\n * @param {Object} comment The comment to be inserted\n */\nexport default function insertScreenReaderComment(comment) {\n\tif (!comment) {\n\t\treturn;\n\t}\n\n\tlet list = document.querySelector(`#pdf-annotate-screenreader-${comment.annotation} ol`);\n\tif (list) {\n\t\tlet item = document.createElement('li');\n\t\titem.setAttribute('id', `pdf-annotate-screenreader-comment-${comment.uuid}`);\n\t\titem.appendChild(document.createTextNode(`${comment.content}`));\n\t\tlist.appendChild(item);\n\t}\n}\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport insertScreenReaderComment from './insertScreenReaderComment';\n\n/**\n * Insert the comments into the DOM to be available by screen reader\n *\n * Example output:\n *   <div class=\"screenReaderOnly\">\n *    <div>Begin highlight 1</div>\n *    <ol aria-label=\"Comments\">\n *      <li>Foo</li>\n *      <li>Bar</li>\n *      <li>Baz</li>\n *      <li>Qux</li>\n *    </ol>\n *  </div>\n *  <div>Some highlighted text goes here...</div>\n *  <div class=\"screenReaderOnly\">End highlight 1</div>\n *\n * NOTE: `screenReaderOnly` is not a real class, just used for brevity\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The ID of the annotation\n * @param {Array} [comments] Optionally preloaded comments to be rendered\n * @return {Promise}\n */\nexport default function renderScreenReaderComments(documentId, annotationId, comments) {\n\tlet promise;\n\n\tif (Array.isArray(comments)) {\n\t\tpromise = Promise.resolve(comments);\n\t} else {\n\t\tpromise = PDFJSAnnotate.getStoreAdapter().getComments(documentId, annotationId);\n\t}\n\n\treturn promise.then((comments) => {\n\t\t// Node needs to be found by querying DOM as it may have been inserted as innerHTML\n\t\t// leaving `screenReaderNode` as an invalid reference (see `insertElementWithinElement`).\n\t\tlet node = document.getElementById(`pdf-annotate-screenreader-${annotationId}`);\n\t\tif (node) { \n\t\t\tlet list = document.createElement('ol');\n\t\t\tlist.setAttribute('id', `pdf-annotate-screenreader-comment-list-${annotationId}`);\n\t\t\tlist.setAttribute('aria-label', 'Comments');\n\t\t\tnode.appendChild(list);\n\t\t\tcomments.forEach(insertScreenReaderComment);\n\t\t}\n\t});\n}\n","/* eslint-disable no-case-declarations */\nimport createScreenReaderOnly from './createScreenReaderOnly';\nimport insertElementWithinChildren from './insertElementWithinChildren';\nimport insertElementWithinElement from './insertElementWithinElement';\nimport renderScreenReaderComments from './renderScreenReaderComments';\n\n// Annotation types that support comments\nconst COMMENT_TYPES = ['highlight', 'point', 'area'];\n\n/**\n * Insert a hint into the DOM for screen readers for a specific annotation.\n *\n * @param {Object} annotation The annotation to insert a hint for\n * @param {Number} num The number of the annotation out of all annotations of the same type\n */\nexport default function insertScreenReaderHint(annotation, num = 0) {\n\tswitch (annotation.type) {\n\t\tcase 'highlight':\n\t\tcase 'strikeout':\n\t\t\tlet rects = annotation.rectangles;\n\t\t\tlet first = rects[0];\n\t\t\tlet last = rects[rects.length - 1];\n\n\t\t\tinsertElementWithinElement(\n\t\t\t\tcreateScreenReaderOnly(`Begin ${annotation.type} annotation ${num}`, annotation.uuid),\n\t\t\t\tfirst.x, first.y, annotation.page, true\n\t\t\t);\n\n\t\t\tinsertElementWithinElement(\n\t\t\t\tcreateScreenReaderOnly(`End ${annotation.type} annotation ${num}`, `${annotation.uuid}-end`),\n\t\t\t\tlast.x + last.width, last.y, annotation.page, false\n\t\t\t);\n\t\t\tbreak;\n\n\t\tcase 'textbox':\n\t\tcase 'point':\n\t\t\tlet text = annotation.type === 'textbox' ? ` (content: ${annotation.content})` : '';\n\n\t\t\tinsertElementWithinChildren(\n\t\t\t\tcreateScreenReaderOnly(`${annotation.type} annotation ${num}${text}`, annotation.uuid),\n\t\t\t\tannotation.x, annotation.y, annotation.page\n\t\t\t);\n\t\t\tbreak;\n\n\t\tcase 'drawing':\n\t\tcase 'area':\n\t\t\tlet x = typeof annotation.x !== 'undefined' ? annotation.x : annotation.lines[0][0];\n\t\t\tlet y = typeof annotation.y !== 'undefined' ? annotation.y : annotation.lines[0][1];\n\n\t\t\tinsertElementWithinChildren(\n\t\t\t\tcreateScreenReaderOnly('Unlabeled drawing', annotation.uuid),\n\t\t\t\tx, y, annotation.page\n\t\t\t);\n\t\t\tbreak;\n\t}\n\n\t// Include comments in screen reader hint\n\tif (COMMENT_TYPES.includes(annotation.type)) {\n\t\trenderScreenReaderComments(annotation.documentId, annotation.uuid);\n\t}\n}\n","/* eslint-disable no-unused-vars */\nimport insertScreenReaderHint from './insertScreenReaderHint';\nimport renderScreenReaderHints from './renderScreenReaderHints';\nimport insertScreenReaderComment from './insertScreenReaderComment';\nimport renderScreenReaderComments from './renderScreenReaderComments';\nimport { addEventListener } from '../UI/event';\nimport PDFJSAnnotate from '../PDFJSAnnotate';\n\n/**\n * Initialize the event handlers for keeping screen reader hints synced with data\n */\nexport default function initEventHandlers() {\n\taddEventListener('annotation:add', (documentId, pageNumber, annotation) => {\n\t\treorderAnnotationsByType(documentId, pageNumber, annotation.type);\n\t});\n\taddEventListener('annotation:edit', (documentId, annotationId, annotation) => {\n\t\treorderAnnotationsByType(documentId, annotation.page, annotation.type);\n\t});\n\taddEventListener('annotation:delete', removeAnnotation);\n\taddEventListener('comment:add', insertComment);\n\taddEventListener('comment:delete', removeComment);\n}\n\n/**\n * Reorder the annotation numbers by annotation type\n *\n * @param {String} documentId The ID of the document\n * @param {Number} pageNumber The page number of the annotations\n * @param {Strig} type The annotation type\n */\nfunction reorderAnnotationsByType(documentId, pageNumber, type) {\n\tPDFJSAnnotate.getStoreAdapter().getAnnotations(documentId, pageNumber)\n\t\t.then((annotations) => {\n\t\t\treturn annotations.annotations.filter((a) => {\n\t\t\t\treturn a.type === type;\n\t\t\t});\n\t\t})\n\t\t.then((annotations) => {\n\t\t\tannotations.forEach((a) => {\n\t\t\t\tremoveAnnotation(documentId, a.uuid);\n\t\t\t});\n\n\t\t\treturn annotations;\n\t\t})\n\t\t.then(renderScreenReaderHints);\n}\n\n/**\n * Remove the screen reader hint for an annotation\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The Id of the annotation\n */\nfunction removeAnnotation(documentId, annotationId) {\n\tremoveElementById(`pdf-annotate-screenreader-${annotationId}`);\n\tremoveElementById(`pdf-annotate-screenreader-${annotationId}-end`);\n}\n\n/**\n * Insert a screen reader hint for a comment\n *\n * @param {String} documentId The ID of the document\n * @param {String} annotationId The ID of tha assocated annotation\n * @param {Object} comment The comment to insert a hint for\n */\nfunction insertComment(documentId, annotationId, comment) {\n\t// let list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\n\t// let promise;\n\n\t// if (!list) {\n\t//   promise = renderScreenReaderComments(documentId, annotationId, []).then(() => {\n\t//     list = document.querySelector(`pdf-annotate-screenreader-comment-list-${annotationId}`);\n\t//     return true;\n\t//   });\n\t// } else {\n\t//   promise = Promise.resolve(true);\n\t// }\n\n\t// promise.then(() => {\n\t//   insertScreenReaderComment(comment);\n\t// });\n}\n\n/**\n * Remove a screen reader hint for a comment\n *\n * @param {String} documentId The ID of the document\n * @param {String} commentId The ID of the comment\n */\nfunction removeComment(documentId, commentId) {\n\tremoveElementById(`pdf-annotate-screenreader-comment-${commentId}`);\n}\n\n/**\n * Remove an element from the DOM by it's ID if it exists\n *\n * @param {String} elementID The ID of the element to be removed\n */\nfunction removeElementById(elementId) {\n\tlet el = document.getElementById(elementId);\n\tif (el) {\n\t\tel.parentNode.removeChild(el);\n\t}\n}\n","import insertScreenReaderHint from './insertScreenReaderHint';\nimport initEventHandlers from './initEventHandlers';\n\n// TODO This is not the right place for this to live\ninitEventHandlers();\n\n/**\n * Insert hints into the DOM for screen readers.\n *\n * @param {Array} annotations The annotations that hints are inserted for\n */\nexport default function renderScreenReaderHints(annotations) {\n\tannotations = Array.isArray(annotations) ? annotations : [];\n\n\t// Insert hints for each type\n\tObject.keys(SORT_TYPES).forEach((type) => {\n\t\tlet sortBy = SORT_TYPES[type];\n\t\tannotations\n\t\t\t.filter((a) => a.type === type)\n\t\t\t.sort(sortBy)\n\t\t\t.forEach((a, i) => insertScreenReaderHint(a, i + 1));\n\t});\n}\n\n// Sort annotations first by y, then by x.\n// This allows hints to be injected in the order they appear,\n// which makes numbering them easier.\nfunction sortByPoint(a, b) {\n\tif (a.y < b.y) {\n\t\treturn a.x - b.x;\n\t} else {\n\t\treturn 1;\n\t}\n}\n\n// Sort annotation by it's first rectangle\nfunction sortByRectPoint(a, b) {\n\treturn sortByPoint(a.rectangles[0], b.rectangles[0]);\n}\n\n// Sort annotation by it's first line\nfunction sortByLinePoint(a, b) {\n\tlet lineA = a.lines[0];\n\tlet lineB = b.lines[0];\n\treturn sortByPoint(\n\t\t{x: lineA[0], y: lineA[1]},\n\t\t{x: lineB[0], y: lineB[1]}\n\t);\n}\n\n// Arrange supported types and associated sort methods\nconst SORT_TYPES = {\n\t'highlight': sortByRectPoint,\n\t'strikeout': sortByRectPoint,\n\t'drawing': sortByLinePoint,\n\t'textbox': sortByPoint,\n\t'point': sortByPoint,\n\t'area': sortByPoint\n};\n\n","/* eslint-disable no-unused-vars */\nimport PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from './appendChild';\nimport renderScreenReaderHints from '../a11y/renderScreenReaderHints';\n\n/**\n * Render the response from PDFJSAnnotate.getStoreAdapter().getAnnotations to SVG\n *\n * @param {SVGElement} svg The SVG element to render the annotations to\n * @param {Object} viewport The page viewport data\n * @param {Object} data The response from PDFJSAnnotate.getStoreAdapter().getAnnotations\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: SVGElement\n *    - rejected: Error\n */\nexport default function render(svg, viewport, data) {\n\treturn new Promise((resolve, reject) => {\n\t\t// Reset the content of the SVG\n\t\tsvg.innerHTML = ''; \n\t\tsvg.setAttribute('data-pdf-annotate-container', true);\n\t\tsvg.setAttribute('data-pdf-annotate-viewport', JSON.stringify(viewport));\n\t\tsvg.removeAttribute('data-pdf-annotate-document');\n\t\tsvg.removeAttribute('data-pdf-annotate-page');\n\n\t\t// If there's no data nothing can be done\n\t\tif (!data) {\n\t\t\treturn resolve(svg);\n\t\t}\n\n\t\tsvg.setAttribute('data-pdf-annotate-document', data.documentId);\n\t\tsvg.setAttribute('data-pdf-annotate-page', data.pageNumber);\n  \n\t\t// Make sure annotations is an array\n\t\tif (!Array.isArray(data.annotations) || data.annotations.length === 0) {\n\t\t\treturn resolve(svg);\n\t\t}\n\t\t//console.log(data.annotations);\n\t\t// Append annotation to svg\n\t\tdata.annotations.forEach((a) => {\n\t\t\tappendChild(svg, a, viewport);\n\t\t});\n\n\t\tresolve(svg);\n\t});\n}\n","/* eslint-disable no-unused-vars */\nimport PDFJSAnnotate from '../PDFJSAnnotate';\n\nimport appendChild from '../render/appendChild';\nimport {\n\taddEventListener,\n\tremoveEventListener\n} from './event';\nimport {\n\tBORDER_COLOR,\n\tdisableUserSelect,\n\tenableUserSelect,\n\tfindSVGContainer,\n\tfindSVGAtPoint,\n\tgetAnnotationRect,\n\tgetMetadata,\n\tscaleDown,\n\tscaleUp\n} from './utils';\n\nlet _enabled = false;\nlet isDragging = false, overlay;\nlet dragOffsetX, dragOffsetY, dragStartX, dragStartY;\nconst OVERLAY_BORDER_SIZE = 3;\n\n/**\n * Create an overlay for editing an annotation.\n *\n * @param {Element} target The annotation element to apply overlay for\n */\nfunction createEditOverlay(target) {\n\tdestroyEditOverlay();\n\n\toverlay = document.createElement('div');\n\tlet anchor = document.createElement('a');\n\tlet parentNode = findSVGContainer(target).parentNode;\n\tlet id = target.getAttribute('data-pdf-annotate-id');\n\tlet rect = getAnnotationRect(target);\n\tlet styleLeft = rect.left - OVERLAY_BORDER_SIZE;\n\tlet styleTop = rect.top - OVERLAY_BORDER_SIZE;\n  \n\toverlay.setAttribute('id', 'pdf-annotate-edit-overlay');\n\toverlay.setAttribute('data-target-id', id);\n\toverlay.style.boxSizing = 'content-box';\n\toverlay.style.position = 'absolute';\n\toverlay.style.top = `${styleTop}px`;\n\toverlay.style.left = `${styleLeft}px`;\n\toverlay.style.width = `${rect.width}px`;\n\toverlay.style.height = `${rect.height}px`;\n\toverlay.style.border = `${OVERLAY_BORDER_SIZE}px solid ${BORDER_COLOR}`;\n\toverlay.style.borderRadius = `${OVERLAY_BORDER_SIZE}px`;\n\n\tanchor.innerHTML = '×';\n\tanchor.setAttribute('href', 'javascript://');\n\tanchor.style.background = '#fff';\n\tanchor.style.borderRadius = '20px';\n\tanchor.style.border = '1px solid #bbb';\n\tanchor.style.color = '#bbb';\n\tanchor.style.fontSize = '16px';\n\tanchor.style.padding = '2px';\n\tanchor.style.textAlign = 'center';\n\tanchor.style.textDecoration = 'none';\n\tanchor.style.position = 'absolute';\n\tanchor.style.top = '-13px';\n\tanchor.style.right = '-13px';\n\tanchor.style.width = '25px';\n\tanchor.style.height = '25px';\n  \n\toverlay.appendChild(anchor);\n\tparentNode.appendChild(overlay);\n\tdocument.addEventListener('click', handleDocumentClick);\n\tdocument.addEventListener('keyup', handleDocumentKeyup);\n\tdocument.addEventListener('mousedown', handleDocumentMousedown);\n\tanchor.addEventListener('click', deleteAnnotation);\n\tanchor.addEventListener('mouseover', () => {\n\t\tanchor.style.color = '#35A4DC';\n\t\tanchor.style.borderColor = '#999';\n\t\tanchor.style.boxShadow = '0 1px 1px #ccc';\n\t});\n\tanchor.addEventListener('mouseout', () => {\n\t\tanchor.style.color = '#bbb';\n\t\tanchor.style.borderColor = '#bbb';\n\t\tanchor.style.boxShadow = '';\n\t});\n\toverlay.addEventListener('mouseover', () => {\n\t\tif (!isDragging) { anchor.style.display = ''; }\n\t});\n\toverlay.addEventListener('mouseout', () => {\n\t\tanchor.style.display = 'none';\n\t});\n}\n\n/**\n * Destroy the edit overlay if it exists.\n */\nfunction destroyEditOverlay() {\n\tif (overlay) {\n\t\toverlay.parentNode.removeChild(overlay);\n\t\toverlay = null;\n\t}\n\n\tdocument.removeEventListener('click', handleDocumentClick);\n\tdocument.removeEventListener('keyup', handleDocumentKeyup);\n\tdocument.removeEventListener('mousedown', handleDocumentMousedown);\n\tdocument.removeEventListener('mousemove', handleDocumentMousemove);\n\tdocument.removeEventListener('mouseup', handleDocumentMouseup);\n\tenableUserSelect();\n}\n\n/**\n * Delete currently selected annotation\n */\nfunction deleteAnnotation() {\n\tif (!overlay) { return; }\n\n\tlet annotationId = overlay.getAttribute('data-target-id');\n\tlet nodes = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n\tlet svg = overlay.parentNode.querySelector('svg.annotationLayer');\n\tlet { documentId } = getMetadata(svg);\n\n\t[...nodes].forEach((n) => {\n\t\tn.parentNode.removeChild(n);\n\t});\n  \n\tPDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, annotationId);\n\n\tdestroyEditOverlay();\n}\n\n/**\n * Handle document.click event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentClick(e) {\n\tif (!findSVGAtPoint(e.clientX, e.clientY)) { return; }\n\n\t// Remove current overlay\n\tlet overlay = document.getElementById('pdf-annotate-edit-overlay');\n\tif (overlay) {\n\t\tif (isDragging || e.target === overlay) {\n\t\t\treturn;\n\t\t}\n\n\t\tdestroyEditOverlay();\n\t}\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentKeyup(e) {\n\tif (overlay && e.keyCode === 46 &&\n      e.target.nodeName.toLowerCase() !== 'textarea' &&\n      e.target.nodeName.toLowerCase() !== 'input') {\n\t\tdeleteAnnotation();\n\t}\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMousedown(e) {\n\tif (e.target !== overlay) { return; }\n\n\t// Highlight and strikeout annotations are bound to text within the document.\n\t// It doesn't make sense to allow repositioning these types of annotations.\n\tlet annotationId = overlay.getAttribute('data-target-id');\n\tlet target = document.querySelector(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n\tlet type = target.getAttribute('data-pdf-annotate-type');\n\n\tif (type === 'highlight' || type === 'strikeout') { return; }\n\n\tisDragging = true;\n\tdragOffsetX = e.clientX;\n\tdragOffsetY = e.clientY;\n\tdragStartX = overlay.offsetLeft;\n\tdragStartY = overlay.offsetTop;\n\n\toverlay.style.background = 'rgba(255, 255, 255, 0.7)';\n\toverlay.style.cursor = 'move';\n\toverlay.querySelector('a').style.display = 'none';\n\n\tdocument.addEventListener('mousemove', handleDocumentMousemove);\n\tdocument.addEventListener('mouseup', handleDocumentMouseup);\n\tdisableUserSelect();\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMousemove(e) {\n\tlet annotationId = overlay.getAttribute('data-target-id');\n\tlet parentNode = overlay.parentNode;\n\tlet rect = parentNode.getBoundingClientRect();\n\tlet y = (dragStartY + (e.clientY - dragOffsetY));\n\tlet x = (dragStartX + (e.clientX - dragOffsetX));\n\tlet minY = 0;\n\tlet maxY = rect.height;\n\tlet minX = 0;\n\tlet maxX = rect.width;\n\n\tif (y > minY && y + overlay.offsetHeight < maxY) {\n\t\toverlay.style.top = `${y}px`;\n\t}\n\n\tif (x > minX && x + overlay.offsetWidth < maxX) {\n\t\toverlay.style.left = `${x}px`;\n\t}\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event that needs to be handled\n */\nfunction handleDocumentMouseup(e) {\n\tlet annotationId = overlay.getAttribute('data-target-id');\n\tlet target = document.querySelectorAll(`[data-pdf-annotate-id=\"${annotationId}\"]`);\n\tlet type = target[0].getAttribute('data-pdf-annotate-type');\n\tlet svg = overlay.parentNode.querySelector('svg.annotationLayer');\n\tlet { documentId } = getMetadata(svg);\n  \n\toverlay.querySelector('a').style.display = '';\n\n\tfunction getDelta(propX, propY) {\n\t\treturn calcDelta(parseInt(target[0].getAttribute(propX), 10), parseInt(target[0].getAttribute(propY), 10));\n\t}\n\n\tfunction calcDelta(x, y) {\n\t\treturn {\n\t\t\tdeltaX: OVERLAY_BORDER_SIZE + scaleDown(svg, {x: overlay.offsetLeft}).x - x,\n\t\t\tdeltaY: OVERLAY_BORDER_SIZE + scaleDown(svg, {y: overlay.offsetTop}).y - y\n\t\t};\n\t}\n\n\tPDFJSAnnotate.getStoreAdapter().getAnnotation(documentId, annotationId).then((annotation) => {\n\t\tif (['area', 'highlight', 'point', 'textbox'].indexOf(type) > -1) {\n\t\t\tlet { deltaX, deltaY } = getDelta('x', 'y');\n\t\t\t[...target].forEach((t, i) => {\n\t\t\t\tif (deltaY !== 0) {\n\t\t\t\t\tlet modelY = parseInt(t.getAttribute('y'), 10) + deltaY;\n\t\t\t\t\tlet viewY = modelY;\n\n\t\t\t\t\tif (type === 'textbox') {\n\t\t\t\t\t\tviewY += annotation.size;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (type === 'point') {\n\t\t\t\t\t\tviewY = scaleUp(svg, { viewY }).viewY;\n\t\t\t\t\t}\n\n\t\t\t\t\tt.setAttribute('y', viewY);\n\t\t\t\t\tif (annotation.rectangles) {\n\t\t\t\t\t\tannotation.rectangles[i].y = modelY;\n\t\t\t\t\t} else if (annotation.y) {\n\t\t\t\t\t\tannotation.y = modelY;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (deltaX !== 0) {\n\t\t\t\t\tlet modelX = parseInt(t.getAttribute('x'), 10) + deltaX;\n\t\t\t\t\tlet viewX = modelX;\n\n\t\t\t\t\tif (type === 'point') {\n\t\t\t\t\t\tviewX = scaleUp(svg, { viewX }).viewX;\n\t\t\t\t\t}\n\n\t\t\t\t\tt.setAttribute('x', viewX);\n\t\t\t\t\tif (annotation.rectangles) {\n\t\t\t\t\t\tannotation.rectangles[i].x = modelX;\n\t\t\t\t\t} else if (annotation.x) {\n\t\t\t\t\t\tannotation.x = modelX;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t// } else if (type === 'strikeout') {\n\t\t\t//   let { deltaX, deltaY } = getDelta('x1', 'y1');\n\t\t\t//   [...target].forEach(target, (t, i) => {\n\t\t\t//     if (deltaY !== 0) {\n\t\t\t//       t.setAttribute('y1', parseInt(t.getAttribute('y1'), 10) + deltaY);\n\t\t\t//       t.setAttribute('y2', parseInt(t.getAttribute('y2'), 10) + deltaY);\n\t\t\t//       annotation.rectangles[i].y = parseInt(t.getAttribute('y1'), 10);\n\t\t\t//     }\n\t\t\t//     if (deltaX !== 0) {\n\t\t\t//       t.setAttribute('x1', parseInt(t.getAttribute('x1'), 10) + deltaX);\n\t\t\t//       t.setAttribute('x2', parseInt(t.getAttribute('x2'), 10) + deltaX);\n\t\t\t//       annotation.rectangles[i].x = parseInt(t.getAttribute('x1'), 10);\n\t\t\t//     }\n\t\t\t//   });\n\t\t} else if (type === 'drawing') {\n\t\t\tlet rect = scaleDown(svg, getAnnotationRect(target[0]));\n\t\t\tlet [originX, originY] = annotation.lines[0];\n\t\t\tlet { deltaX, deltaY } = calcDelta(originX, originY);\n\n\t\t\t// origin isn't necessarily at 0/0 in relation to overlay x/y\n\t\t\t// adjust the difference between overlay and drawing coords\n\t\t\tdeltaY += (originY - rect.top);\n\t\t\tdeltaX += (originX - rect.left);\n\n\t\t\tannotation.lines.forEach((line, i) => {\n\t\t\t\tlet [x, y] = annotation.lines[i];\n\t\t\t\tannotation.lines[i][0] = x + deltaX;\n\t\t\t\tannotation.lines[i][1] = y + deltaY;\n\t\t\t});\n\n\t\t\ttarget[0].parentNode.removeChild(target[0]);\n\t\t\tappendChild(svg, annotation);\n\t\t}\n\n\t\tPDFJSAnnotate.getStoreAdapter().editAnnotation(documentId, annotationId, annotation);\n\t});\n\n\tsetTimeout(() => {\n\t\tisDragging = false;\n\t}, 0);\n\n\toverlay.style.background = '';\n\toverlay.style.cursor = '';\n\n\tdocument.removeEventListener('mousemove', handleDocumentMousemove);\n\tdocument.removeEventListener('mouseup', handleDocumentMouseup);\n\tenableUserSelect();\n}\n\n/**\n * Handle annotation.click event\n *\n * @param {Element} e The annotation element that was clicked\n */\nfunction handleAnnotationClick(target) {\n\tcreateEditOverlay(target);\n}\n\n/**\n * Enable edit mode behavior.\n */\nexport function enableEdit () {\n\tif (_enabled) { return; }\n\n\t_enabled = true;\n\taddEventListener('annotation:click', handleAnnotationClick);\n}\n\n/**\n * Disable edit mode behavior.\n */\nexport function disableEdit () {\n\tdestroyEditOverlay();\n\n\tif (!_enabled) { return; }\n\n\t_enabled = false;\n\tremoveEventListener('annotation:click', handleAnnotationClick);\n}\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n\tdisableUserSelect,\n\tenableUserSelect,\n\tfindSVGAtPoint,\n\tgetMetadata,\n\tscaleDown\n} from './utils';\n\nlet _enabled = false;\nlet _penSize;\nlet _penColor;\nlet path;\nlet lines;\n\n/**\n * Handle document.mousedown event\n */\nfunction handleDocumentMousedown() {\n\tpath = null;\n\tlines = [];\n\n\tdocument.addEventListener('mousemove', handleDocumentMousemove);\n\tdocument.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMouseup(e) {\n\tlet svg;\n\tif (lines.length > 1 && (svg = findSVGAtPoint(e.clientX, e.clientY))) {\n\t\tlet { documentId, pageNumber } = getMetadata(svg);\n\n\t\tPDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, {\n\t\t\ttype: 'drawing',\n\t\t\twidth: _penSize,\n\t\t\tcolor: _penColor,\n\t\t\tlines\n\t\t}\n\t\t).then((annotation) => {\n\t\t\tif (path) {\n\t\t\t\tsvg.removeChild(path);\n\t\t\t}\n\n\t\t\tappendChild(svg, annotation);\n\t\t});\n\t}\n\n\tdocument.removeEventListener('mousemove', handleDocumentMousemove);\n\tdocument.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentMousemove(e) {\n\tsavePoint(e.clientX, e.clientY);\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to be handled\n */\nfunction handleDocumentKeyup(e) {\n\t// Cancel rect if Esc is pressed\n\tif (e.keyCode === 27) {\n\t\tlines = null;\n\t\tpath.parentNode.removeChild(path);\n\t\tdocument.removeEventListener('mousemove', handleDocumentMousemove);\n\t\tdocument.removeEventListener('mouseup', handleDocumentMouseup);\n\t}\n}\n\n/**\n * Save a point to the line being drawn.\n *\n * @param {Number} x The x coordinate of the point\n * @param {Number} y The y coordinate of the point\n */\nfunction savePoint(x, y) {\n\tlet svg = findSVGAtPoint(x, y);\n\tif (!svg) {\n\t\treturn;\n\t}\n\n\tlet rect = svg.getBoundingClientRect();\n\tlet point = scaleDown(svg, {\n\t\tx: x - rect.left,\n\t\ty: y - rect.top\n\t});\n\n\tlines.push([point.x, point.y]);\n\n\tif (lines.length <= 1) {\n\t\treturn;\n\t}\n\n\tif (path) {\n\t\tsvg.removeChild(path);\n\t}\n\n\tpath = appendChild(svg, {\n\t\ttype: 'drawing',\n\t\tcolor: _penColor,\n\t\twidth: _penSize,\n\t\tlines\n\t});\n}\n\n/**\n * Set the attributes of the pen.\n *\n * @param {Number} penSize The size of the lines drawn by the pen\n * @param {String} penColor The color of the lines drawn by the pen\n */\nexport function setPen(penSize = 1, penColor = '000000') {\n\t_penSize = parseInt(penSize, 10);\n\t_penColor = penColor;\n}\n\n/**\n * Enable the pen behavior\n */\nexport function enablePen() {\n\tif (_enabled) { return; }\n\n\t_enabled = true;\n\tdocument.addEventListener('mousedown', handleDocumentMousedown);\n\tdocument.addEventListener('keyup', handleDocumentKeyup);\n\tdisableUserSelect();\n}\n\n/**\n * Disable the pen behavior\n */\nexport function disablePen() {\n\tif (!_enabled) { return; }\n\n\t_enabled = false;\n\tdocument.removeEventListener('mousedown', handleDocumentMousedown);\n\tdocument.removeEventListener('keyup', handleDocumentKeyup);\n\tenableUserSelect();\n}\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n\tBORDER_COLOR,\n\tfindSVGAtPoint,\n\tgetMetadata,\n\tscaleDown\n} from './utils';\n\nlet _enabled = false;\nlet input;\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} The DOM event to be handled\n */\nfunction handleDocumentMouseup(e) {\n\tif (input || !findSVGAtPoint(e.clientX, e.clientY)) {\n\t\treturn;\n\t}\n  \n\tinput = document.createElement('input');\n\tinput.setAttribute('id', 'pdf-annotate-point-input');\n\tinput.setAttribute('placeholder', 'Enter comment');\n\tinput.style.border = `3px solid ${BORDER_COLOR}`;\n\tinput.style.borderRadius = '3px';\n\tinput.style.position = 'absolute';\n\tinput.style.top = `${e.clientY}px`;\n\tinput.style.left = `${e.clientX}px`;\n\n\tinput.addEventListener('blur', handleInputBlur);\n\tinput.addEventListener('keyup', handleInputKeyup);\n\n\tdocument.body.appendChild(input);\n\tinput.focus();\n}\n\n/**\n * Handle input.blur event\n */\nfunction handleInputBlur() {\n\tsavePoint();\n}\n\n/**\n * Handle input.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleInputKeyup(e) {\n\tif (e.keyCode === 27) {\n\t\tcloseInput();\n\t} else if (e.keyCode === 13) {\n\t\tsavePoint();\n\t}\n}\n\n/**\n * Save a new point annotation from input\n */\nfunction savePoint() {\n\tif (input.value.trim().length > 0) {\n\t\tlet clientX = parseInt(input.style.left, 10);\n\t\tlet clientY = parseInt(input.style.top, 10);\n\t\tlet content = input.value.trim();\n\t\tlet svg = findSVGAtPoint(clientX, clientY);\n\t\tif (!svg) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet rect = svg.getBoundingClientRect();\n\t\tlet { documentId, pageNumber } = getMetadata(svg);\n\t\tlet annotation = Object.assign({\n\t\t\ttype: 'point'\n\t\t}, scaleDown(svg, {\n\t\t\tx: clientX - rect.left,\n\t\t\ty: clientY - rect.top\n\t\t})\n\t\t);\n\n\t\tPDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n\t\t\t.then((annotation) => {\n\t\t\t\tPDFJSAnnotate.getStoreAdapter().addComment(\n\t\t\t\t\tdocumentId,\n\t\t\t\t\tannotation.uuid,\n\t\t\t\t\tcontent\n\t\t\t\t);\n\n\t\t\t\tappendChild(svg, annotation);\n\t\t\t});\n\t}\n\n\tcloseInput();\n}\n\n/**\n * Close the input element\n */\nfunction closeInput() {\n\tinput.removeEventListener('blur', handleInputBlur);\n\tinput.removeEventListener('keyup', handleInputKeyup);\n\tdocument.body.removeChild(input);\n\tinput = null;\n}\n\n/**\n * Enable point annotation behavior\n */\nexport function enablePoint() {\n\tif (_enabled) { return; }\n\n\t_enabled = true;\n\tdocument.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n/**\n * Disable point annotation behavior\n */\nexport function disablePoint() {\n\tif (!_enabled) { return; }\n\n\t_enabled = false;\n\tdocument.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n","/* eslint-disable no-empty */\n/* eslint-disable no-unused-vars */\nimport PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n\tBORDER_COLOR,\n\tdisableUserSelect,\n\tenableUserSelect,\n\tfindSVGAtPoint,\n\tgetMetadata,\n\tgetOffset,\n\tscaleDown,\n\tscaleUp\n} from './utils';\n\nlet _enabled = false;\nlet _type;\nlet overlay;\nlet originY;\nlet originX;\n\n/**\n * Get the current window selection as rects\n *\n * @return {Array} An Array of rects\n */\nfunction getSelectionRects() {\n\ttry {\n\t\tlet selection = window.getSelection();\n\t\tlet range = selection.getRangeAt(0);\n\t\tlet rects = range.getClientRects();\n\n\t\tif (rects.length > 0 &&\n        rects[0].width > 0 &&\n        rects[0].height > 0) {\n\t\t\treturn rects;\n\t\t}\n\t} catch (e) {}\n  \n\treturn null;\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousedown(e) {\n\tlet svg;\n\tif (_type !== 'area' || !(svg = findSVGAtPoint(e.clientX, e.clientY))) {\n\t\treturn;\n\t}\n\n\tlet rect = svg.getBoundingClientRect();\n\toriginY = e.clientY;\n\toriginX = e.clientX;\n\n\toverlay = document.createElement('div');\n\toverlay.style.position = 'absolute';\n\toverlay.style.top = `${originY - rect.top}px`;\n\toverlay.style.left = `${originX - rect.left}px`;\n\toverlay.style.border = `3px solid ${BORDER_COLOR}`;\n\toverlay.style.borderRadius = '3px';\n\tsvg.parentNode.appendChild(overlay);\n  \n\tdocument.addEventListener('mousemove', handleDocumentMousemove);\n\tdisableUserSelect();\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousemove(e) {\n\tlet svg = overlay.parentNode.querySelector('svg.annotationLayer');\n\tlet rect = svg.getBoundingClientRect();\n\n\tif (originX + (e.clientX - originX) < rect.right) {\n\t\toverlay.style.width = `${e.clientX - originX}px`;\n\t}\n\n\tif (originY + (e.clientY - originY) < rect.bottom) {\n\t\toverlay.style.height = `${e.clientY - originY}px`;\n\t}\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n\tlet rects;\n\tif (_type !== 'area' && (rects = getSelectionRects())) {\n\t\tlet svg = findSVGAtPoint(rects[0].left, rects[0].top);\n\t\tsaveRect(_type, [...rects].map((r) => {\n\t\t\treturn {\n\t\t\t\ttop: r.top,\n\t\t\t\tleft: r.left,\n\t\t\t\twidth: r.width,\n\t\t\t\theight: r.height\n\t\t\t};\n\t\t}));\n\t} else if (_type === 'area' && overlay) {\n\t\tlet svg = overlay.parentNode.querySelector('svg.annotationLayer');\n\t\tlet rect = svg.getBoundingClientRect();\n\t\tsaveRect(_type, [{\n\t\t\ttop: parseInt(overlay.style.top, 10) + rect.top,\n\t\t\tleft: parseInt(overlay.style.left, 10) + rect.left,\n\t\t\twidth: parseInt(overlay.style.width, 10),\n\t\t\theight: parseInt(overlay.style.height, 10)\n\t\t}]);\n\n\t\toverlay.parentNode.removeChild(overlay);\n\t\toverlay = null;\n\n\t\tdocument.removeEventListener('mousemove', handleDocumentMousemove);\n\t\tenableUserSelect();\n\t}\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentKeyup(e) {\n\t// Cancel rect if Esc is pressed\n\tif (e.keyCode === 27) {\n\t\tlet selection = window.getSelection();\n\t\tselection.removeAllRanges();\n\t\tif (overlay && overlay.parentNode) {\n\t\t\toverlay.parentNode.removeChild(overlay);\n\t\t\toverlay = null;\n\t\t\tdocument.removeEventListener('mousemove', handleDocumentMousemove);\n\t\t}\n\t}\n}\n\n/**\n * Save a rect annotation\n *\n * @param {String} type The type of rect (area, highlight, strikeout)\n * @param {Array} rects The rects to use for annotation\n * @param {String} color The color of the rects\n */\nfunction saveRect(type, rects, color) {\n\tlet svg = findSVGAtPoint(rects[0].left, rects[0].top);\n\tlet node;\n\tlet annotation;\n\n\tif (!svg) {\n\t\treturn;\n\t}\n\n\tlet boundingRect = svg.getBoundingClientRect();\n\n\tif (!color) {\n\t\tif (type === 'highlight') {\n\t\t\tcolor = 'FFFF00';\n\t\t} else if (type === 'strikeout') {\n\t\t\tcolor = 'FF0000';\n\t\t}\n\t}\n\n\t// Initialize the annotation\n\tannotation = {\n\t\ttype,\n\t\tcolor,\n\t\trectangles: [...rects].map((r) => {\n\t\t\tlet offset = 0;\n\n\t\t\tif (type === 'strikeout') {\n\t\t\t\toffset = r.height / 2;\n\t\t\t}\n\n\t\t\treturn scaleDown(svg, {\n\t\t\t\ty: (r.top + offset) - boundingRect.top,\n\t\t\t\tx: r.left - boundingRect.left,\n\t\t\t\twidth: r.width,\n\t\t\t\theight: r.height\n\t\t\t});\n\t\t}).filter((r) => r.width > 0 && r.height > 0 && r.x > -1 && r.y > -1)\n\t};\n  \n\t// Short circuit if no rectangles exist\n\tif (annotation.rectangles.length === 0) {\n\t\treturn;\n\t}\n\n\t// Special treatment for area as it only supports a single rect\n\tif (type === 'area') {\n\t\tlet rect = annotation.rectangles[0];\n\t\tdelete annotation.rectangles;\n\t\tannotation.x = rect.x;\n\t\tannotation.y = rect.y;\n\t\tannotation.width = rect.width;\n\t\tannotation.height = rect.height;\n\t}\n\n\tlet { documentId, pageNumber } = getMetadata(svg);\n\n\t// Add the annotation\n\tPDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n\t\t.then((annotation) => {\n\t\t\tappendChild(svg, annotation);\n\t\t});\n}\n\n/**\n * Enable rect behavior\n */\nexport function enableRect(type) {\n\t_type = type;\n  \n\tif (_enabled) { return; }\n\n\t_enabled = true;\n\tdocument.addEventListener('mouseup', handleDocumentMouseup);\n\tdocument.addEventListener('mousedown', handleDocumentMousedown);\n\tdocument.addEventListener('keyup', handleDocumentKeyup);\n}\n\n/**\n * Disable rect behavior\n */\nexport function disableRect() {\n\tif (!_enabled) { return; }\n\n\t_enabled = false;\n\tdocument.removeEventListener('mouseup', handleDocumentMouseup);\n\tdocument.removeEventListener('mousedown', handleDocumentMousedown);\n\tdocument.removeEventListener('keyup', handleDocumentKeyup);\n}\n\n","import PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport {\n\tBORDER_COLOR,\n\tfindSVGAtPoint,\n\tgetMetadata,\n\tscaleDown\n} from './utils';\n\nlet _enabled = false;\nlet input;\nlet _textSize;\nlet _textColor;\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n\tif (input || !findSVGAtPoint(e.clientX, e.clientY)) {\n\t\treturn;\n\t}\n\n\tinput = document.createElement('input');\n\tinput.setAttribute('id', 'pdf-annotate-text-input');\n\tinput.setAttribute('placeholder', 'Enter text');\n\tinput.style.border = `3px solid ${BORDER_COLOR}`;\n\tinput.style.borderRadius = '3px';\n\tinput.style.position = 'absolute';\n\tinput.style.top = `${e.clientY}px`;\n\tinput.style.left = `${e.clientX}px`;\n\tinput.style.fontSize = `${_textSize}px`;\n\n\tinput.addEventListener('blur', handleInputBlur);\n\tinput.addEventListener('keyup', handleInputKeyup);\n\n\tdocument.body.appendChild(input);\n\tinput.focus();\n}\n\n/**\n * Handle input.blur event\n */\nfunction handleInputBlur() {\n\tsaveText();\n}\n\n/**\n * Handle input.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleInputKeyup(e) {\n\tif (e.keyCode === 27) {\n\t\tcloseInput();\n\t} else if (e.keyCode === 13) {\n\t\tsaveText();\n\t}\n}\n\n/**\n * Save a text annotation from input\n */\nfunction saveText() {\n\tif (input.value.trim().length > 0) {\n\t\tlet clientX = parseInt(input.style.left, 10);\n\t\tlet clientY = parseInt(input.style.top, 10);\n\t\tlet svg = findSVGAtPoint(clientX, clientY);\n\t\tif (!svg) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet { documentId, pageNumber } = getMetadata(svg);\n\t\tlet rect = svg.getBoundingClientRect();\n\t\tlet annotation = Object.assign({\n\t\t\ttype: 'textbox',\n\t\t\tsize: _textSize,\n\t\t\tcolor: _textColor,\n\t\t\tcontent: input.value.trim()\n\t\t}, scaleDown(svg, {\n\t\t\tx: clientX - rect.left,\n\t\t\ty: clientY -  rect.top,\n\t\t\twidth: input.offsetWidth,\n\t\t\theight: input.offsetHeight\n\t\t})\n\t\t);\n\n\t\tPDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n\t\t\t.then((annotation) => {\n\t\t\t\tappendChild(svg, annotation);\n\t\t\t});\n\t}\n  \n\tcloseInput();\n}\n\n/**\n * Close the input\n */\nfunction closeInput() {\n\tif (input) {\n\t\tinput.removeEventListener('blur', handleInputBlur);\n\t\tinput.removeEventListener('keyup', handleInputKeyup);\n\t\tdocument.body.removeChild(input);\n\t\tinput = null;\n\t}\n}\n\n/**\n * Set the text attributes\n *\n * @param {Number} textSize The size of the text\n * @param {String} textColor The color of the text\n */\nexport function setText(textSize = 12, textColor = '000000') {\n\t_textSize = parseInt(textSize, 10);\n\t_textColor = textColor;\n}\n\n\n/**\n * Enable text behavior\n */\nexport function enableText() {\n\tif (_enabled) { return; }\n\n\t_enabled = true;\n\tdocument.addEventListener('mouseup', handleDocumentMouseup);\n}\n\n\n/**\n * Disable text behavior\n */\nexport function disableText() {\n\tif (!_enabled) { return; }\n\n\t_enabled = false;\n\tdocument.removeEventListener('mouseup', handleDocumentMouseup);\n}\n\n","/* eslint-disable no-unused-vars */\n/* eslint-disable no-constant-condition */\nimport PDFJSAnnotate from '../PDFJSAnnotate';\nimport renderScreenReaderHints from '../a11y/renderScreenReaderHints';\nimport { DefaultTextLayerFactory } from 'pdf-dist/web/pdf_viewer.js';\n// Template for creating a new page\nconst PAGE_TEMPLATE = `\n  <div style=\"visibility: hidden;\" class=\"page\" data-loaded=\"false\">\n    <div class=\"canvasWrapper\">\n      <canvas></canvas>\n\t\t</div>\n\t\t<svg class=\"annotationLayer\"></svg>\n\t\t<div class=\"textLayer\"></div>\n  </div>\n`;\n\n/**\n * Create a new page to be appended to the DOM.\n *\n * @param {Number} pageNumber The page number that is being created\n * @return {HTMLElement}\n */\nexport function createPage(pageNumber) {\n\tlet temp = document.createElement('div');\n\ttemp.innerHTML = PAGE_TEMPLATE;\n\n\tlet page = temp.children[0];\n\tlet canvas = page.querySelector('canvas');\n\n\tpage.setAttribute('id', `pageContainer${pageNumber}`);\n\tpage.setAttribute('data-page-number', pageNumber);\n\n\tcanvas.mozOpaque = true;\n\tcanvas.setAttribute('id', `page${pageNumber}`);\n\n\treturn page;\n}\n\n/**\n * Render a page that has already been created.\n *\n * @param {Number} pageNumber The page number to be rendered\n * @param {Object} renderOptions The options for rendering\n * @return {Promise} Settled once rendering has completed\n *  A settled Promise will be either:\n *    - fulfilled: [pdfPage, annotations]\n *    - rejected: Error\n */\nexport async function renderPage(pageNumber, renderOptions) {\n\tlet {\n\t\tdocumentId,\n\t\tpdfDocument,\n\t\tscale,\n\t\trotate\n\t} = renderOptions;\n\n\t// Load the page and annotations\n\treturn Promise.all([\n\t\tpdfDocument.getPage(pageNumber),\n\t\tPDFJSAnnotate.getAnnotations(documentId, pageNumber)\n\t]).then(async ([pdfPage, annotations]) => {\n\t\tlet page = document.getElementById(`pageContainer${pageNumber}`);\n\t\tlet svg = page.querySelector('.annotationLayer');\n\t\tlet canvas = page.querySelector('.canvasWrapper canvas');\n\t\tlet canvasContext = canvas.getContext('2d', { alpha: false });\n\t\tlet viewport = pdfPage.getViewport({ scale, rotate });\n\t\tlet transform = scalePage(pageNumber, viewport, canvasContext);\n\t\tawait pdfPage.render({ canvasContext, viewport, transform }).promise;\n\t\tawait PDFJSAnnotate.render(svg, viewport, annotations).promise;\n\t\tlet textContent = await pdfPage.getTextContent({ normalizeWhitespace: true });\n\t\t// Render text layer for a11y of text content\n\t\tlet textLayer = page.querySelector('.textLayer');\n\t\tlet textLayerFactory = new DefaultTextLayerFactory();\n\t\tlet textLayerBuilder = textLayerFactory.createTextLayerBuilder(textLayer, pageNumber - 1, viewport);\n\t\ttextLayerBuilder.setTextContent(textContent);\n\t\ttextLayerBuilder.render();\n\t\t// Enable a11y for annotations\n\t\t// Timeout is needed to wait for `textLayerBuilder.render`\n\t\tsetTimeout(() => {\n\t\t\ttry {\n\t\t\t\trenderScreenReaderHints(annotations.annotations);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log(e);\n\t\t\t}\n\t\t});\n\n\t\treturn [pdfPage, annotations];\n\t\t// return pdfPage.getTextContent({ normalizeWhitespace: true })\n\t\t// \t.then((textContent) => {\n\t\t// \treturn new Promise((resolve, reject) => {\n\t\t// \t\t// Render text layer for a11y of text content\n\t\t// \t\tlet textLayer = page.querySelector(`.textLayer`);\n\t\t// \t\tlet textLayerFactory = new DefaultTextLayerFactory();\n\t\t// \t\tlet textLayerBuilder = textLayerFactory.createTextLayerBuilder(textLayer, pageNumber - 1, viewport);\n\t\t// \t\ttextLayerBuilder.setTextContent(textContent);\n\t\t// \t\ttextLayerBuilder.render();\n\n\t\t// \t\t// Enable a11y for annotations\n\t\t// \t\t// Timeout is needed to wait for `textLayerBuilder.render`\n\t\t// \t\tsetTimeout(() => {\n\t\t// \t\t\ttry {\n\t\t// \t\t\t\trenderScreenReaderHints(annotations.annotations);\n\t\t// \t\t\t\tresolve();\n\t\t// \t\t\t} catch (e) {\n\t\t// \t\t\t\treject(e);\n\t\t// \t\t\t}\n\t\t// \t\t});\n\t\t// \t});\n\t\t// });\n\n\n\n\n\t\t// // Render the page\n\t\t// return Promise.all([\n\t\t// \tpdfPage.render({ canvasContext, viewport, transform }),\n\t\t// \tPDFJSAnnotate.render(svg, viewport, annotations)\n\t\t// ]).then(() => {\n\t\t// \t// Text content is needed for a11y, but is also necessary for creating\n\t\t// \t// highlight and strikeout annotations which require selecting text.\n\t\t// \treturn pdfPage.getTextContent({ normalizeWhitespace: true }).then((textContent) => {\n\t\t// \t\treturn new Promise((resolve, reject) => {\n\t\t// \t\t\t// Render text layer for a11y of text content\n\t\t// \t\t\tlet textLayer = page.querySelector(`.textLayer`);\n\t\t// \t\t\tlet textLayerFactory = new DefaultTextLayerFactory();\n\t\t// \t\t\tlet textLayerBuilder = textLayerFactory.createTextLayerBuilder(textLayer, pageNumber - 1, viewport);\n\t\t// \t\t\ttextLayerBuilder.setTextContent(textContent);\n\t\t// \t\t\ttextLayerBuilder.render();\n\n\t\t// \t\t\t// Enable a11y for annotations\n\t\t// \t\t\t// Timeout is needed to wait for `textLayerBuilder.render`\n\t\t// \t\t\tsetTimeout(() => {\n\t\t// \t\t\t\ttry {\n\t\t// \t\t\t\t\trenderScreenReaderHints(annotations.annotations);\n\t\t// \t\t\t\t\tresolve();\n\t\t// \t\t\t\t} catch (e) {\n\t\t// \t\t\t\t\treject(e);\n\t\t// \t\t\t\t}\n\t\t// \t\t\t});\n\t\t// \t\t});\n\t\t// \t});\n\t\t// }).then(() => {\n\t\t// \t// Indicate that the page was loaded\n\t\t// \tpage.setAttribute('data-loaded', 'true');\n\n\t\t// \treturn [pdfPage, annotations];\n\t\t//});\n\n\n\n\t});\n}\n\n/**\n * Scale the elements of a page.\n *\n * @param {Number} pageNumber The page number to be scaled\n * @param {Object} viewport The viewport of the PDF page (see pdfPage.getViewport(scale, rotate))\n * @param {Object} context The canvas context that the PDF page is rendered to\n * @return {Array} The transform data for rendering the PDF page\n */\nfunction scalePage(pageNumber, viewport, context) {\n\tlet page = document.getElementById(`pageContainer${pageNumber}`);\n\tlet canvas = page.querySelector('.canvasWrapper canvas');\n\tlet svg = page.querySelector('.annotationLayer');\n\tlet wrapper = page.querySelector('.canvasWrapper');\n\tlet textLayer = page.querySelector('.textLayer');\n\tlet outputScale = getOutputScale(context);\n\tlet transform = !outputScale.scaled ? null : [outputScale.sx, 0, 0, outputScale.sy, 0, 0];\n\tlet sfx = approximateFraction(outputScale.sx);\n\tlet sfy = approximateFraction(outputScale.sy);\n\n\t// Adjust width/height for scale\n\tpage.style.visibility = '';\n\tcanvas.width = roundToDivide(viewport.width * outputScale.sx, sfx[0]);\n\tcanvas.height = roundToDivide(viewport.height * outputScale.sy, sfy[0]);\n\tcanvas.style.width = roundToDivide(viewport.width, sfx[1]) + 'px';\n\tcanvas.style.height = roundToDivide(viewport.height, sfx[1]) + 'px';\n\tsvg.setAttribute('width', viewport.width);\n\tsvg.setAttribute('height', viewport.height);\n\tsvg.style.width = `${viewport.width}px`;\n\tsvg.style.height = `${viewport.height}px`;\n\tpage.style.width = `${viewport.width}px`;\n\tpage.style.height = `${viewport.height}px`;\n\twrapper.style.width = `${viewport.width}px`;\n\twrapper.style.height = `${viewport.height}px`;\n\ttextLayer.style.width = `${viewport.width}px`;\n\ttextLayer.style.height = `${viewport.height}px`;\n\n\treturn transform;\n}\n\n/**\n * The following methods are taken from mozilla/pdf.js and as such fall under\n * the Apache License (http://www.apache.org/licenses/).\n *\n * Original source can be found at mozilla/pdf.js:\n * https://github.com/mozilla/pdf.js/blob/master/web/ui_utils.js\n */\n\n/**\n * Approximates a float number as a fraction using Farey sequence (max order\n * of 8).\n *\n * @param {Number} x Positive float number\n * @return {Array} Estimated fraction: the first array item is a numerator,\n *                 the second one is a denominator.\n */\nfunction approximateFraction(x) {\n\t// Fast path for int numbers or their inversions.\n\tif (Math.floor(x) === x) {\n\t\treturn [x, 1];\n\t}\n\n\tconst xinv = 1 / x;\n\tconst limit = 8;\n\tif (xinv > limit) {\n\t\treturn [1, limit];\n\t} else if (Math.floor(xinv) === xinv) {\n\t\treturn [1, xinv];\n\t}\n\n\tconst x_ = x > 1 ? xinv : x;\n\n\t// a/b and c/d are neighbours in Farey sequence.\n\tlet a = 0, b = 1, c = 1, d = 1;\n\n\t// Limit search to order 8.\n\twhile (true) {\n\t\t// Generating next term in sequence (order of q).\n\t\tlet p = a + c, q = b + d;\n\t\tif (q > limit) {\n\t\t\tbreak;\n\t\t}\n\t\tif (x_ <= p / q) {\n\t\t\tc = p; d = q;\n\t\t} else {\n\t\t\ta = p; b = q;\n\t\t}\n\t}\n\n\t// Select closest of neighbours to x.\n\tif (x_ - a / b < c / d - x_) {\n\t\treturn x_ === x ? [a, b] : [b, a];\n\t} else {\n\t\treturn x_ === x ? [c, d] : [d, c];\n\t}\n}\n\nfunction getOutputScale(ctx) {\n\tlet devicePixelRatio = window.devicePixelRatio || 1;\n\tlet backingStoreRatio = ctx.webkitBackingStorePixelRatio ||\n\t\tctx.mozBackingStorePixelRatio ||\n\t\tctx.msBackingStorePixelRatio ||\n\t\tctx.oBackingStorePixelRatio ||\n\t\tctx.backingStorePixelRatio || 1;\n\tlet pixelRatio = devicePixelRatio / backingStoreRatio;\n\treturn {\n\t\tsx: pixelRatio,\n\t\tsy: pixelRatio,\n\t\tscaled: pixelRatio !== 1\n\t};\n}\n\nfunction roundToDivide(x, div) {\n\tlet r = x % div;\n\treturn r === 0 ? x : Math.round(x - r + div);\n}\n","/* eslint-disable no-empty */\n/* eslint-disable no-unused-vars */\nimport PDFJSAnnotate from '../PDFJSAnnotate';\nimport appendChild from '../render/appendChild';\nimport { addEventListener } from './event';\nimport {\n\tBORDER_COLOR,\n\tdisableUserSelect,\n\tenableUserSelect,\n\tfindSVGAtPoint,\n\tgetMetadata,\n\tgetOffset,\n\tscaleDown,\n\tscaleUp,\n\tgetAnnotationRect\n} from './utils';\n\nlet _enabled = false;\nlet _type;\nlet overlay;\nlet originY;\nlet originX;\nlet _rects;\nlet _svg;\nlet _target;\nlet _annotation;\nlet _selectedText;\nlet _topPos;\nlet _endPos;\nlet _inputHeight;\nlet _order;\n/**\n * Get the current window selection as rects\n *\n * @return {Array} An Array of rects\n */\nfunction getSelectionRects() {\n\ttry {\n\t\tlet selection = window.getSelection();\n\t\tlet range = selection.getRangeAt(0);\n\t\tlet rects = range.getClientRects();\n\n\t\tif (rects.length > 0 &&\n        rects[0].width > 0 &&\n        rects[0].height > 0) {\n\t\t\treturn rects;\n\t\t}\n\t} catch (e) {}\n  \n\treturn null;\n}\n\n/**\n * Handle document.mousedown event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousedown(e) {\n\tlet svg;\n\tif (_type === 'select' || !(svg = findSVGAtPoint(e.clientX, e.clientY))) {\n\t\t// hide text bool buttons\n\t\tif(!e.target.classList.contains('textToolBtn') && \n        !e.target.classList.contains('svg-inline--fa') &&\n        !e.target.parentElement.classList.contains('svg-inline--fa')){\n\t\t\tlet textTool = document.getElementById('textTool');\n\t\t\ttextTool.style.visibility = 'hidden';\n\t\t}\n\t\t// Hide add new comment form\n\t\tlet newCommentWrapper = document.getElementById('add-new-comment');\n\t\tif(newCommentWrapper && newCommentWrapper.style.display != 'none'){\n\t\t\tlet validTarget = hasAParentWithClass(e.target, 'add-new-comment');\n\t\t\tlet comment = document.getElementById('comment-text-area').value;\n\t\t\tif(!validTarget && comment.replace(/\\s/g, '').length == 0)\n\t\t\t\tcancelCommentText();\n\t\t}\n\t\t// Unselect highlight comment\n\t\tif(!e.target.classList.contains('comment-highlight-selected')){\n\t\t\tlet validTarget = hasAParentWithClass(e.target, 'comment-card-selected');\n\t\t\tif(!validTarget)\n\t\t\t\tunselectHighlightComment();\n\t\t}\n\t\treturn;\n\t}\n\n\tlet rect = svg.getBoundingClientRect();\n\toriginY = e.clientY;\n\toriginX = e.clientX;\n\n\toverlay = document.createElement('div');\n\toverlay.style.position = 'absolute';\n\toverlay.style.top = `${originY - rect.top}px`;\n\toverlay.style.left = `${originX - rect.left}px`;\n\toverlay.style.border = `3px solid ${BORDER_COLOR}`;\n\toverlay.style.borderRadius = '3px';\n\tsvg.parentNode.appendChild(overlay);\n  \n\tdocument.addEventListener('mousemove', handleDocumentMousemove);\n\tdisableUserSelect();\n}\n\nfunction hasAParentWithClass(element, className) {\n\tfor(let i = 0; i <= 5; i++){\n\t\tif (element.classList.contains(className)) \n\t\t\treturn true;\n\t\telse\n\t\t\telement = element.parentNode;\n\t}\n\treturn false;\n\t// if (element.classList.contains(className)) return true;\n\t// return element.parentNode && hasAParentWithClass(element.parentNode, className);\n}\n\n/**\n * Handle document.mousemove event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMousemove(e) {\n\tlet svg = overlay.parentNode.querySelector('svg.annotationLayer');\n\tlet rect = svg.getBoundingClientRect();\n\n\tif (originX + (e.clientX - originX) < rect.right) {\n\t\toverlay.style.width = `${e.clientX - originX}px`;\n\t}\n\n\tif (originY + (e.clientY - originY) < rect.bottom) {\n\t\toverlay.style.height = `${e.clientY - originY}px`;\n\t}\n}\n\n/**\n * Handle document.mouseup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentMouseup(e) {\n\tif(e.target.parentElement.classList.contains('textLayer')){\n    \n\t\tlet rects;\n\t\tif (_type === 'select' && (rects = getSelectionRects())) {\n    \n\t\t\tlet text = window\n\t\t\t\t.getSelection()\n\t\t\t\t.toString()\n\t\t\t\t.trim();\n\t\t\t// Display text tool bar if text is selected.\n\t\t\tif (text) {\n\t\t\t\tlet textTool = document.getElementById('textTool');\n\t\t\t\tlet posX = rects[rects.length - 1].left + (rects[rects.length - 1].width / 2);\n\t\t\t\tlet posY = rects[rects.length - 1].top + 20;\n\t\t\t\ttextTool.style =\n          'position: absolute; top: ' +\n          posY +\n          'px; left: ' +\n          posX +\n          'px;';\n\n\t\t\t\t_rects = rects;\n\t\t\t\t_svg = findSVGAtPoint(rects[0].left, rects[0].top);\n\t\t\t\t_target = e.target;\n\t\t\t\t_selectedText = text;\n\t\t\t} else {\n\t\t\t\t// Display different tool bar\n\t\t\t}\n\t\t} \n\t}\n}\n\n/**\n * Handle document.keyup event\n *\n * @param {Event} e The DOM event to handle\n */\nfunction handleDocumentKeyup(e) {\n\t// Cancel rect if Esc is pressed\n\tif (e.keyCode === 27) {\n\t\tlet selection = window.getSelection();\n\t\tselection.removeAllRanges();\n\t\tif (overlay && overlay.parentNode) {\n\t\t\toverlay.parentNode.removeChild(overlay);\n\t\t\toverlay = null;\n\t\t\tdocument.removeEventListener('mousemove', handleDocumentMousemove);\n\t\t}\n\t}\n}\n\n/**\n * Save a highlight annotation\n */\nexport async function highlightText(type) {\n\tlet svg = _svg; //findSVGAtPoint(rects[0].left, rects[0].top);\n\tlet rects = _rects;\n\tlet annotation;\n\n\tif (!svg) {\n\t\treturn;\n\t}\n\n\tlet boundingRect = svg.getBoundingClientRect();\n  \n\tlet color = 'FFFF00';\n\tif(type == 'strikeout')\n\t\tcolor = 'FF0000';\n\t// Initialize the annotation\n\tannotation = {\n\t\ttype,\n\t\tcolor,\n\t\trectangles: [...rects].map((r) => {\n\t\t\tlet offset = 0;\n\t\t\tif(type == 'strikeout')\n\t\t\t\toffset = r.height / 2;\n\t\t\treturn scaleDown(svg, {\n\t\t\t\ty: (r.top + offset) - boundingRect.top,\n\t\t\t\tx: r.left - boundingRect.left,\n\t\t\t\twidth: r.width,\n\t\t\t\theight: r.height\n\t\t\t});\n\t\t}).filter((r) => r.width > 0 && r.height > 0 && r.x > -1 && r.y > -1)\n\t};\n  \n  \n\t// Short circuit if no rectangles exist\n\tif (annotation.rectangles.length === 0) {\n\t\treturn;\n\t}\n\n\tif(annotation.rectangles.length > 2){\n\t\tannotation.rectangles = removeMinHeigthRects(annotation.rectangles);\n\t}\n\n\tlet { documentId, pageNumber } = getMetadata(svg);\n\n\tannotation.top = parseInt(_target.style.top.substring(0, _target.style.top.length - 2));\n\tannotation.pageNum = pageNumber;\n\tannotation.pageHeight = svg.getAttribute('height');\n\t_annotation = annotation;\n  \n  \n\t// Add the annotation\n\tawait PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n\t\t.then((annotation) => {\n\t\t\tappendChild(svg, annotation);\n\t\t\thideTextToolBar();\n\t\t});\n}\n\nfunction removeMinHeigthRects(arr) {\n\tlet min = Math.min(...arr.map(a => a.height));\n\treturn arr.filter(a => a.height != min);\n}\n\nfunction hideTextToolBar(){\n\tlet textTool = document.getElementById('textTool');\n\ttextTool.style.visibility = 'hidden';\n}\n\nfunction updateCommentPositions(){\n\tlet commentCards = document.querySelectorAll('.comment-card');\n\tlet commentHighlights = document.querySelectorAll(\"g[data-pdf-annotate-type='comment-highlight']\");\n\tlet highlightArr = Array.prototype.slice.call(commentHighlights);\n\t// Sort the highlights\n\thighlightArr.sort(compareTopAttributes);\n\t// Get order of the current highlight\n\t_order = highlightArr.findIndex(item => {\n\t\treturn item.dataset.pdfAnnotateId == _annotation.uuid;\n\t});\n\n\tif(!hasEnoughSpace(commentCards)){\n\t\t// Update comment positions\n\n\t\t// get add new form's top position\n\t\tlet svg = _svg;\n\t\tlet rectTop = parseInt(_target.style.top.substring(0, _target.style.top.length - 2));\n\t\tlet svgHeight = svg.getAttribute('height');\n\t\tlet svgPageNum = svg.getAttribute('data-pdf-annotate-page');\n\t\tlet svgTop = 0;\n\t\tif(svgPageNum > 1)\n\t\t\tsvgTop += ((svgPageNum - 1) * svgHeight);\n\t\tlet topPos = svgTop + rectTop - 35;\n\t\tlet endPos = topPos + 105;\n\n\t\tif(_order == 0){\n\t\t\t// Move down all comment cards\n\t\t\t//moveDownCommentCards(commentCards, 0, commentCards.length - 1, topPos, endPos);\n\t\t\tmoveDownFromEndPos(commentCards, 0, endPos);\n\t\t} else if(_order == highlightArr.length - 1){\n\t\t\t// Move up all comment cards\n\t\t\t//moveUpCommentCards(commentCards, commentCards.length - 1, 0, topPos, endPos);\n\t\t\tmoveUpFromTopPos(commentCards, commentCards.length - 1, topPos);\n\t\t} else {\n\t\t\t// Move up commentCards[0] -> commentCards[i - 1]\n\t\t\t//moveUpCommentCards(commentCards, _order - 1, 0, topPos, endPos)\n\t\t\tlet upperTop = parseInt(commentCards[_order - 1].style.top.substring(0, commentCards[_order - 1].style.top.length - 2));\n\t\t\tlet upperEnd = upperTop + commentCards[_order - 1].offsetHeight;\n\t\t\t// Check if move up is necessary\n\t\t\tif(upperEnd > (topPos - 10)){\n\t\t\t\tmoveUpFromTopPos(commentCards, _order - 1, topPos);\n\t\t\t} else {\n\t\t\t\t// Check if move down is necessary\n\t\t\t\tlet commentId = commentCards[_order - 1].getAttribute('highlight-id');\n\t\t\t\tlet g = getHighlightByCommentId(commentId);\n\t\t\t\tlet gTop = parseInt(g.getAttribute('top')) - 35;\n\t\t\t\tif(g.getAttribute('page-num') > 1)\n\t\t\t\t\tgTop += ((g.getAttribute('page-num') - 1) * g.getAttribute('page-height'));\n\t\t\t\tif(upperTop < gTop){\n\t\t\t\t\tmoveDownToTopPos(commentCards, _order - 1, topPos);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Move down commentCards[i] -> commentCards[commentCards.length - 1]\n\t\t\t//moveDownCommentCards(commentCards, _order, commentCards.length, topPos, endPos);\n\t\t\tlet lowerTop = parseInt(commentCards[_order].style.top.substring(0, commentCards[_order].style.top.length - 2));\n\t\t\tif(lowerTop < (endPos + 10)){\n\t\t\t\tmoveDownFromEndPos(commentCards, _order, endPos);\n\t\t\t} else {\n\t\t\t\t// Check if move up is necessary\n\t\t\t\tlet commentId = commentCards[_order].getAttribute('highlight-id');\n\t\t\t\tlet g = getHighlightByCommentId(commentId);\n\t\t\t\tlet gTop = parseInt(g.getAttribute('top')) - 35;\n\t\t\t\tif(g.getAttribute('page-num') > 1)\n\t\t\t\t\tgTop += ((g.getAttribute('page-num') - 1) * g.getAttribute('page-height'));\n\t\t\t\tif(lowerTop > gTop){\n\t\t\t\t\tmoveUpToEndPos(commentCards, _order, endPos);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function updatePositionsAfterCommentAdded(){\n\tlet newComment = document.querySelector(\".comment-card[highlight-id='\"+ _annotation.uuid +\"']\");\n\tlet commentCards = document.querySelectorAll('.comment-card');\n\tlet endPos = parseInt(newComment.getAttribute('top-position')) + newComment.offsetHeight;\n\tif(_order < (commentCards.length - 1))\n\t\tmoveUpToEndPos(commentCards, _order + 1, endPos);\n\tnewComment.addEventListener('click', handleCommentCardClick);\n}\n\nexport function updatePositionsAfterCommentDeleted(){\n\n}\n\nfunction moveUpFromTopPos(commentCards, startIndex, topPos){\n\t// Get start index card's position\n\tlet adjTop = parseInt(commentCards[startIndex].style.top.substring(0, commentCards[startIndex].style.top.length - 2));\n\tlet adjEnd = adjTop + commentCards[startIndex].offsetHeight;\n\t// Move the start index card up first\n\tcommentCards[startIndex].style.top = adjTop - (adjEnd - topPos) - 10 + 'px';\n\tcommentCards[startIndex].setAttribute('top-position', adjTop - (adjEnd - topPos) - 10);\n\tif(startIndex > 0){\n\t\tfor(let m = startIndex - 1; m >= 0; m--){\n\t\t\tlet previousTop = parseInt(commentCards[m + 1].style.top.substring(0, commentCards[m + 1].style.top.length - 2));\n\t\t\tlet thisTop = parseInt(commentCards[m].style.top.substring(0, commentCards[m].style.top.length - 2));\n\t\t\tlet thisEnd = thisTop + commentCards[m].offsetHeight;\n\t\t\tif(thisEnd > (previousTop - 10)){\n\t\t\t\tcommentCards[m].style.top = thisTop - (thisEnd - previousTop) - 10 + 'px';\n\t\t\t\tcommentCards[m].setAttribute('top-position', thisTop - (thisEnd - previousTop) - 10);\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction moveUpToEndPos(commentCards, startIndex, endPos){\n\n\tlet commentId = commentCards[startIndex].getAttribute('highlight-id');\n\tlet g = getHighlightByCommentId(commentId);\n\tlet gTop = parseInt(g.getAttribute('top')) - 35;\n\tif(g.getAttribute('page-num') > 1)\n\t\tgTop += ((g.getAttribute('page-num') - 1) * g.getAttribute('page-height'));\n\n\tlet desiredTop = gTop >= (endPos + 10) ? gTop : (endPos + 10) ;\n\t// Move start index card up\n\tcommentCards[startIndex].style.top = desiredTop + 'px';\n\tcommentCards[startIndex].setAttribute('top-position', desiredTop);\n\n\t// let adjTop = parseInt(commentCards[startIndex].style.top.substring(0, commentCards[startIndex].style.top.length - 2));\n\t// commentCards[startIndex].style.top = adjTop - (adjTop - endPos) + 10 + \"px\";\n\t// commentCards[startIndex].setAttribute(\"top-position\", adjTop - (adjTop - endPos) + 10);\n\n\tif(commentCards.length > (startIndex + 1)){\n\n\t\tfor(let n = startIndex + 1; n < commentCards.length; n++){\n\t\t\tlet previousTop = parseInt(commentCards[n - 1].style.top.substring(0, commentCards[n - 1].style.top.length - 2));\n\t\t\tlet previousEnd = previousTop + commentCards[n - 1].offsetHeight;\n\t\t\tlet thisTop = parseInt(commentCards[n].style.top.substring(0, commentCards[n].style.top.length - 2));\n      \n\t\t\t// Check if move down is necessary\n\t\t\tif(thisTop > (previousEnd + 10)){\n\t\t\t\tlet thisCommentId = commentCards[n].getAttribute('highlight-id');\n\t\t\t\tlet thisG = getHighlightByCommentId(thisCommentId);\n\t\t\t\tlet thisGTop = parseInt(thisG.getAttribute('top')) - 35;\n\t\t\t\tif(thisG.getAttribute('page-num') > 1)\n\t\t\t\t\tthisGTop += ((thisG.getAttribute('page-num') - 1) * thisG.getAttribute('page-height'));\n\t\t\t\tif(thisTop > thisGTop){\n\t\t\t\t\tlet thisDesiredTop = thisGTop >= (previousEnd + 10) ? thisGTop : (previousEnd + 10) ;\n\t\t\t\t\tcommentCards[n].style.top = thisDesiredTop + 'px';\n\t\t\t\t\tcommentCards[n].setAttribute('top-position', thisDesiredTop);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction moveDownToTopPos(commentCards, startIndex, topPos){\n\t// Get start index card's position\n\tlet adjTop = parseInt(commentCards[startIndex].style.top.substring(0, commentCards[startIndex].style.top.length - 2));\n\tlet adjEnd = adjTop + commentCards[startIndex].offsetHeight;\n\t// Check if move down is necessary\n\tlet commentId = commentCards[startIndex].getAttribute('highlight-id');\n\tlet g = getHighlightByCommentId(commentId);\n\tlet gTop = parseInt(g.getAttribute('top')) - 35;\n\tif(g.getAttribute('page-num') > 1)\n\t\tgTop += ((g.getAttribute('page-num') - 1) * g.getAttribute('page-height'));\n\t// Only move cards down if the upper card is higher that its highlight\n\tif(adjTop < gTop ){\n\t\tlet desiredTop = gTop <= (adjTop + (topPos - adjEnd) - 10) ? gTop : (adjTop + (topPos - adjEnd) - 10) ;\n\t\t// Move upper adjacent card down\n\t\tcommentCards[startIndex].style.top = desiredTop + 'px';\n\t\tcommentCards[startIndex].setAttribute('top-position', desiredTop);\n\t\t// Move other cards down\n\t\tif(startIndex > 0){\n\t\t\tfor(let n = startIndex - 1; n >= 0; n--){\n\t\t\t\tlet previousTop = parseInt(commentCards[n + 1].style.top.substring(0, commentCards[n + 1].style.top.length - 2));\n\t\t\t\t//let previousEnd = previousTop + commentCards[n + 1].offsetHeight;\n\t\t\t\tlet thisTop = parseInt(commentCards[n].style.top.substring(0, commentCards[n].style.top.length - 2));\n\t\t\t\tlet thisEnd = thisTop + commentCards[n].offsetHeight;\n\t\t\t\t// Check if move down is necessary\n\t\t\t\tif(thisEnd < (previousTop - 10)){\n\t\t\t\t\tlet thisCommentId = commentCards[n].getAttribute('highlight-id');\n\t\t\t\t\tlet thisG = getHighlightByCommentId(thisCommentId);\n\t\t\t\t\tlet thisGTop = parseInt(thisG.getAttribute('top')) - 35;\n\t\t\t\t\tif(thisG.getAttribute('page-num') > 1)\n\t\t\t\t\t\tthisGTop += ((thisG.getAttribute('page-num') - 1) * thisG.getAttribute('page-height'));\n\t\t\t\t\tif(thisTop < thisGTop){\n\t\t\t\t\t\tlet thisDesiredTop = thisGTop <= (thisTop + (previousTop - thisEnd) - 10) ? thisGTop : (thisTop + (previousTop - thisEnd) - 10) ;\n\t\t\t\t\t\tcommentCards[n].style.top = thisDesiredTop + 'px';\n\t\t\t\t\t\tcommentCards[n].setAttribute('top-position', thisDesiredTop);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n  \n}\n\nfunction moveDownFromEndPos(commentCards, startIndex, endPos){\n\t// Move the start index card down first\n\t//let adjTop = parseInt(commentCards[startIndex].style.top.substring(0, commentCards[startIndex].style.top.length - 2));\n\tcommentCards[startIndex].style.top = endPos + 10 + 'px';\n\tcommentCards[startIndex].setAttribute('top-position', endPos + 10);\n\t// Move other cards down ward\n\tif(commentCards.length > (startIndex + 1)){\n\t\tfor(let j = startIndex + 1; j < commentCards.length; j++){\n\t\t\tlet previousTop = parseInt(commentCards[j - 1].style.top.substring(0, commentCards[j - 1].style.top.length - 2));\n\t\t\tlet previousEnd = previousTop + commentCards[j - 1].offsetHeight;\n\t\t\tlet thisTop = parseInt(commentCards[j].style.top.substring(0, commentCards[j].style.top.length - 2));\n\t\t\tif(thisTop < (previousEnd + 10)){\n\t\t\t\tcommentCards[j].style.top = thisTop + (previousEnd - thisTop) + 10 + 'px';\n\t\t\t\tcommentCards[j].setAttribute('top-position', thisTop + (previousEnd - thisTop) + 10 );\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction moveUpCommentCards(commentCards, startIndex, endIndex, topPos, endPos){\n\t// Get adjacent card's position\n\tlet adjTop = parseInt(commentCards[startIndex].style.top.substring(0, commentCards[startIndex].style.top.length - 2));\n\tlet adjEnd = adjTop + commentCards[startIndex].offsetHeight;\n\t// Check if move up is necessary\n\tif(adjEnd > (topPos - 10)){\n\t\t// Move the upper adjacent card up first\n\t\tcommentCards[startIndex].style.top = adjTop - (adjEnd - topPos) - 10 + 'px';\n\t\tcommentCards[startIndex].setAttribute('top-position', adjTop - (adjEnd - topPos) - 10);\n\t\t// Move other cards upward\n\t\tif(startIndex > 0){\n\t\t\tfor(let m = startIndex - 1; m >= 0; m--){\n\t\t\t\tlet previousTop = parseInt(commentCards[m + 1].style.top.substring(0, commentCards[m + 1].style.top.length - 2));\n\t\t\t\tlet thisTop = parseInt(commentCards[m].style.top.substring(0, commentCards[m].style.top.length - 2));\n\t\t\t\tlet thisEnd = thisTop + commentCards[m].offsetHeight;\n\t\t\t\tif(thisEnd > (previousTop - 10)){\n\t\t\t\t\tcommentCards[m].style.top = thisTop - (thisEnd - previousTop) - 10 + 'px';\n\t\t\t\t\tcommentCards[m].setAttribute('top-position', thisTop - (thisEnd - previousTop) - 10);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// Check if move down is necessary\n\t\tlet commentId = commentCards[startIndex].getAttribute('highlight-id');\n\t\tlet g = getHighlightByCommentId(commentId);\n\t\tlet gTop = parseInt(g.getAttribute('top')) - 35;\n\n\t\tif(adjTop < gTop){\n\t\t\tlet desiredTop = gTop <= (adjTop + (topPos - adjEnd) - 10) ? gTop : (adjTop + (topPos - adjEnd) - 10) ;\n\t\t\t// Move upper adjacent card down\n\t\t\tcommentCards[startIndex].style.top = desiredTop + 'px';\n\t\t\tcommentCards[startIndex].setAttribute('top-position', desiredTop);\n\t\t\t// Move other cards down\n\t\t\tif(startIndex > 0){\n\t\t\t\tfor(let n = startIndex - 1; n >= 0; n--){\n\t\t\t\t\tlet previousTop = parseInt(commentCards[n + 1].style.top.substring(0, commentCards[n + 1].style.top.length - 2));\n\t\t\t\t\tlet previousEnd = previousTop + commentCards[n + 1].offsetHeight;\n\t\t\t\t\tlet thisTop = parseInt(commentCards[n].style.top.substring(0, commentCards[n].style.top.length - 2));\n\t\t\t\t\tlet thisEnd = thisTop + commentCards[n].offsetHeight;\n\t\t\t\t\t// Check if move down is necessary\n\t\t\t\t\tif(thisEnd < (previousTop - 10)){\n\t\t\t\t\t\tlet thisCommentId = commentCards[n].getAttribute('highlight-id');\n\t\t\t\t\t\tlet thisG = getHighlightByCommentId(thisCommentId);\n\t\t\t\t\t\tlet thisGTop = parseInt(thisG.getAttribute('top')) - 35;\n\t\t\t\t\t\tif(thisTop < thisGTop){\n\t\t\t\t\t\t\tlet thisDesiredTop = thisGTop <= (thisTop + (previousTop - thisEnd) - 10) ? gTop : (thisTop + (previousTop - thisEnd) - 10) ;\n\t\t\t\t\t\t\tcommentCards[n].style.top = thisDesiredTop + 'px';\n\t\t\t\t\t\t\tcommentCards[n].setAttribute('top-position', thisDesiredTop);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n  \n}\n\nfunction moveDownCommentCards(commentCards, startIndex, endIndex, topPos, endPos){\n\t// Move the upper adjacent card down first\n\tlet adjTop = parseInt(commentCards[startIndex].style.top.substring(0, commentCards[startIndex].style.top.length - 2));\n\tif(adjTop < (endPos + 10)){\n\t\tcommentCards[startIndex].style.top = endPos + 10 + 'px';\n\t\tcommentCards[startIndex].setAttribute('top-position', endPos + 10);\n\n\t\t// Move other cards down ward\n\t\tif(commentCards.length > (startIndex + 1)){\n\t\t\tfor(let j = startIndex + 1; j < commentCards.length; j++){\n\t\t\t\tlet previousTop = parseInt(commentCards[j - 1].style.top.substring(0, commentCards[j - 1].style.top.length - 2));\n\t\t\t\tlet previousEnd = previousTop + commentCards[j - 1].offsetHeight;\n\t\t\t\tlet thisTop = parseInt(commentCards[j].style.top.substring(0, commentCards[j].style.top.length - 2));\n\t\t\t\tif(thisTop < (previousEnd + 10)){\n\t\t\t\t\tcommentCards[j].style.top = thisTop + (previousEnd - thisTop) + 10 + 'px';\n\t\t\t\t\tcommentCards[j].setAttribute('top-position', thisTop + (previousEnd - thisTop) + 10 );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// Check if move up is necessary\n\t\tlet commentId = commentCards[startIndex].getAttribute('highlight-id');\n\t\tlet g = getHighlightByCommentId(commentId);\n\t\tlet gTop = parseInt(g.getAttribute('top')) - 35;\n\n\t\tif(adjTop > gTop){\n\t\t\tlet desiredTop = gTop >= (endPos + 10) ? gTop : (endPos + 10) ;\n\t\t\t// Move lower adjacent card up\n\t\t\tcommentCards[startIndex].style.top = desiredTop + 'px';\n\t\t\tcommentCards[startIndex].setAttribute('top-position', desiredTop);\n\t\t\t// Move other cards up\n\t\t\tif(commentCards.length > (startIndex + 1)){\n\t\t\t\tfor(let n = startIndex + 1; n < commentCards.length; n++){\n\t\t\t\t\tlet previousTop = parseInt(commentCards[n - 1].style.top.substring(0, commentCards[n - 1].style.top.length - 2));\n\t\t\t\t\tlet previousEnd = previousTop + commentCards[n - 1].offsetHeight;\n\t\t\t\t\tlet thisTop = parseInt(commentCards[n].style.top.substring(0, commentCards[n].style.top.length - 2));\n\t\t\t\t\t//let thisEnd = thisTop + commentCards[n].offsetHeight;\n\t\t\t\t\t// Check if move down is necessary\n\t\t\t\t\tif(thisTop > (previousEnd + 10)){\n\t\t\t\t\t\tlet thisCommentId = commentCards[n].getAttribute('highlight-id');\n\t\t\t\t\t\tlet thisG = getHighlightByCommentId(thisCommentId);\n\t\t\t\t\t\tlet thisGTop = parseInt(thisG.getAttribute('top')) - 35;\n\t\t\t\t\t\tif(thisTop > thisGTop){\n\t\t\t\t\t\t\tlet thisDesiredTop = thisGTop >= (previousEnd + 10) ? thisGTop : (previousEnd + 10) ;\n\t\t\t\t\t\t\tcommentCards[n].style.top = thisDesiredTop + 'px';\n\t\t\t\t\t\t\tcommentCards[n].setAttribute('top-position', thisDesiredTop);\n\t\t\t\t\t\t}\n            \n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction compareTopAttributes(a, b){\n\tlet top1 = parseInt(a.getAttribute('top'));\n\tif(a.getAttribute('page-num') > 1)\n\t\ttop1 += ((a.getAttribute('page-num') - 1) * a.getAttribute('page-height'));\n  \n\tlet top2 = parseInt(b.getAttribute('top'));\n\tif(b.getAttribute('page-num') > 1)\n\t\ttop2 += ((b.getAttribute('page-num') - 1) * b.getAttribute('page-height'));\n\tif (top1 > top2) return 1;\n\tif (top2 > top1) return -1;\n\tif (top2 == top1) {\n\t\t// compare order attributes\n\t\tlet order1 = parseInt(a.getAttribute('order'));\n\t\tlet order2 = parseInt(b.getAttribute('order'));\n\t\tif (order1 > order2) return 1;\n\t\tif (order2 > order1) return -1;\n\t}\n\treturn 0;\n}\n\nfunction hasEnoughSpace(commentCards){\n\tif(commentCards.length > 0){\n\t\tlet svg = _svg;\n\t\tlet rectTop = parseInt(_target.style.top.substring(0, _target.style.top.length - 2));\n\t\tlet svgHeight = svg.getAttribute('height');\n\t\tlet svgPageNum = svg.getAttribute('data-pdf-annotate-page');\n    \n\t\tlet svgTop = 0;\n\t\tif(svgPageNum > 1)\n\t\t\tsvgTop += ((svgPageNum - 1) * svgHeight);\n\t\tlet topPos = svgTop + rectTop - 35;\n\t\tlet endPos = topPos + 105;\n\n\t\t// Check first and last position\n\t\tlet firstTopPos = parseInt(commentCards[0].getAttribute('top-position'));\n\t\tlet lastEndPos = parseInt(commentCards[commentCards.length - 1].getAttribute('top-position')) + \n                      parseInt(commentCards[commentCards.length - 1].offsetHeight);\n\n\t\tif(endPos < firstTopPos || topPos > lastEndPos)\n\t\t\treturn true;\n\t\tif(commentCards.length > 1){\n\t\t\tfor(let i = 0; i < commentCards.length - 1; i++){\n\t\t\t\tlet thisTopPos = parseInt(commentCards[i].getAttribute('top-position'));\n\t\t\t\tlet thisEndPos = thisTopPos + commentCards[i].offsetHeight;\n  \n\t\t\t\tlet nextTopPos = parseInt(commentCards[i + 1].getAttribute('top-position'));\n\t\t\t\t//let nextEndPos = nextTopPos + commentCards[i + 1].offsetHeight;\n  \n\t\t\t\tif(topPos > thisEndPos && endPos < nextTopPos){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n    \n\t\treturn false;\n\t}\n\treturn true;\n}\n\n\nfunction updateCommentsAfterSave(){\n\n}\n\nfunction getHighlightByCommentId(commentId){\n\treturn  document.querySelector(\"g[data-pdf-annotate-id='\"+ commentId +\"']\");\n}\n\n// Add comment tab to the pdf viewer\nfunction displayAddNewCommentForm(){\n\tlet newCommentWrapper = document.getElementById('add-new-comment');\n\n\tnewCommentWrapper.style.visibility = 'visible';\n\n\tlet svg = _svg;\n\tlet rectTop = parseInt(_target.style.top.substring(0, _target.style.top.length - 2));\n\tlet svgHeight = svg.getAttribute('height');\n\tlet svgPageNum = svg.getAttribute('data-pdf-annotate-page');\n  \n\tlet svgTop = 0;\n\tif(svgPageNum > 1)\n\t\tsvgTop += ((svgPageNum - 1) * svgHeight);\n\tlet topPos = svgTop + rectTop - 35;\n\tnewCommentWrapper.style =\n    'position: absolute; right: 5px; top: ' + topPos + 'px;';\n\thideTextToolBar();\n\tlet textArea = document.getElementById('comment-text-area');\n\ttextArea.focus();\n\t_inputHeight = parseInt(textArea.style.height.substring(0, textArea.style.height.length - 2));\n\n\ttextArea.addEventListener('keydown', function (e){\n\t\tlet commentCards = document.querySelectorAll('.comment-card');\n\t\tif(commentCards.length > 0){\n\t\t\tsetTimeout(function(){ \n\t\t\t\tlet newHeight = parseInt(textArea.style.height.substring(0, textArea.style.height.length - 2));\n\t\t\t\tlet newCommentWrapper = document.getElementById('add-new-comment');\n\t\t\t\tlet topPos = parseInt(newCommentWrapper.style.top.substring(0, newCommentWrapper.style.top.length - 2));\n\t\t\t\tlet endPos = topPos + newCommentWrapper.offsetHeight;\n\t\t\t\tif(_inputHeight < newHeight){\n\t\t\t\t\tif(_order <= commentCards.length - 1 )\n\t\t\t\t\t\tmoveDownFromEndPos(commentCards, _order, endPos);\n\t\t\t\t} else if(_inputHeight > newHeight){\n\t\t\t\t\tif(_order < commentCards.length)\n\t\t\t\t\t\tmoveUpToEndPos(commentCards, _order, endPos);\n\t\t\t\t}\n\t\t\t\t_inputHeight = newHeight;\n\t\t\t}, 100);\n\t\t}\n\t});\n\n}\n\nexport function cancelCommentText(){\n\tlet { documentId, pageNumber } = getMetadata(_svg);\n\tlet newCommentWrapper = document.getElementById('add-new-comment');\n\tlet topPos = parseInt(newCommentWrapper.style.top.substring(0, newCommentWrapper.style.top.length - 2));\n\tlet endPos  = topPos + newCommentWrapper.offsetHeight;\n\tnewCommentWrapper.style.display = 'none';\n\tlet commentCards = document.querySelectorAll('.comment-card');\n\tif(commentCards.length > 0){\n\t\tif(_order <= (commentCards.length - 1)){\n\t\t\tmoveUpToEndPos(commentCards, _order, topPos);\n\t\t\tif(_order > 0){\n\t\t\t\tlet orderTopPos = parseInt(commentCards[_order].style.top.substring(0, commentCards[_order].style.top.length - 2)); \n\t\t\t\tmoveDownToTopPos(commentCards, _order - 1, orderTopPos);\n\t\t\t}\n\t\t}\n\t\tif(_order == commentCards.length){\n\t\t\tmoveDownToTopPos(commentCards, _order - 1, endPos);\n\t\t}\n\t}\n\t// Remove the annotation\n\tPDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, _annotation.uuid)\n\t\t.then((isDeleted) => {\n\t\t\tif(isDeleted){\n\t\t\t\t//remove highlight in UI\n\t\t\t\tdocument.querySelector(\"g[data-pdf-annotate-id='\"+ _annotation.uuid +\"']\").remove();\n\t\t\t\t_annotation = null;\n\t\t\t}\n      \n\t\t});\n}\n\nexport async function addCommentText(commentContent, documentId){\n\tlet commentWrapper = document.getElementById('add-new-comment');\n\tlet topPos = parseInt(commentWrapper.style.top.substring(0, commentWrapper.style.top.length - 2));\n\tlet annotation = _annotation;\n\treturn await PDFJSAnnotate.getStoreAdapter().addComment(documentId,\n\t\tannotation,\n\t\tcommentContent,\n\t\t_selectedText,\n\t\ttopPos);\n}\n\nexport async function commentText(){\n\t// Highlight the text first\n\tawait highlightText('comment-highlight');\n\t// Update positions of comment boxes\n\tupdateCommentPositions();\n\t// Display add new form\n\tdisplayAddNewCommentForm();\n\tevent.stopPropagation();\n}\n/**\n * Enable rect behavior\n */\nexport function enableSelect(type) {\n\t_type = type;\n  \n\tif (_enabled) { return; }\n\n\t_enabled = true;\n\tdocument.addEventListener('mouseup', handleDocumentMouseup);\n\tdocument.addEventListener('mousedown', handleDocumentMousedown);\n\tdocument.addEventListener('keyup', handleDocumentKeyup);\n\taddEventListener('annotation:click', handleCommentAnnotationClick);\n\n\tlet commentCards = document.querySelectorAll('.comment-card');\n\tcommentCards.forEach(item => {\n\t\titem.addEventListener('click', handleCommentCardClick);\n\t});\n  \n\t//document.getElementById(\"restore\").addEventListener(\"click\", restoreCommentPositions);\n\twindow.addEventListener('beforeunload', restoreCommentPositions);\n}\n\nfunction handleCommentCardClick(){\n\tlet highlightId = this.getAttribute('highlight-id');\n\tlet highlight = document.querySelector(\"g[data-pdf-annotate-id='\"+ highlightId +\"']\");\n\thandleCommentAnnotationClick(highlight);\n}\n\nfunction unselectHighlightComment(){\n\tlet selectedHighlight = document.getElementsByClassName('comment-highlight-selected');\n\tif(selectedHighlight.length > 0)\n\t\tselectedHighlight[0].classList.remove('comment-highlight-selected');\n\tlet selectedComment = document.getElementsByClassName('comment-card-selected');\n\tif(selectedComment.length > 0)\n\t\tselectedComment[0].classList.remove('comment-card-selected');\n}\n\nasync function restoreCommentPositions(e){\n\tlet documentId = document.getElementById('viewer').getAttribute('document-id');\n\tlet highlights = document.querySelectorAll(\"g[data-pdf-annotate-type='comment-highlight']\");\n\thandleCommentAnnotationClick(highlights[0]);\n\tlet comments = await updateCommentAnnotations(documentId);\n\tconsole.log(comments);\n\tawait PDFJSAnnotate.getStoreAdapter().updateComments(documentId, comments);\n}\n\nasync function updateCommentAnnotations(documentId){\n\tlet comments = await PDFJSAnnotate.getStoreAdapter().getComments(documentId);\n\tcomments.forEach(comment => {\n\t\tlet thisCard = document.querySelector(\".comment-card[highlight-id='\"+ comment.uuid +\"']\");\n\t\tcomment.topPosition = parseInt(thisCard.getAttribute('top-position'));\n\t});\n\treturn comments;\n}\n\nfunction handleCommentAnnotationClick(target){\n\tlet text = window\n\t\t.getSelection()\n\t\t.toString()\n\t\t.trim();\n\t// Display text tool bar if text is selected.\n\tif (!text){\n\t\tlet type = target.getAttribute('data-pdf-annotate-type');\n\t\tif(type == 'comment-highlight'){\n\t\t\tlet selectedHighlight = document.getElementsByClassName('comment-highlight-selected');\n\t\t\tif(selectedHighlight.length > 0)\n\t\t\t\tselectedHighlight[0].classList.remove('comment-highlight-selected');\n\t\t\ttarget.classList.add('comment-highlight-selected');\n\n\t\t\tlet commentCards = document.querySelectorAll('.comment-card');\n\t\t\tlet commentHighlights = document.querySelectorAll(\"g[data-pdf-annotate-type='comment-highlight']\");\n\t\t\tlet highlightArr = Array.prototype.slice.call(commentHighlights);\n\t\t\t// Sort the highlights\n\t\t\thighlightArr.sort(compareTopAttributes);\n\t\t\t// Get order of the current highlight\n\t\t\t_order = highlightArr.findIndex(item => {\n\t\t\t\treturn item.dataset.pdfAnnotateId == target.getAttribute('data-pdf-annotate-id');\n\t\t\t});\n      \n\t\t\tlet gTop = parseInt(target.getAttribute('top')) - 35;\n\t\t\tlet svgHeight = parseInt(target.getAttribute('page-height'));\n\t\t\tlet svgPageNum = parseInt(target.getAttribute('page-num'));\n\t\t\tif(svgPageNum > 1)\n\t\t\t\tgTop += ((svgPageNum - 1) * svgHeight);\n\n\t\t\tlet cTop = parseInt(commentCards[_order].style.top.substring(0, commentCards[_order].style.top.length - 2));\n      \n\t\t\t// remove current selected comment card class if any\n\t\t\tlet selected = document.getElementsByClassName('comment-card-selected');\n\t\t\tif(selected.length > 0)\n\t\t\t\tselected[0].classList.remove('comment-card-selected');\n\t\t\t// Set this card as selected\n\t\t\tcommentCards[_order].classList.add('comment-card-selected');\n\n\t\t\tif(cTop != gTop){\n\t\t\t\t// Move the comment up to gTop\n\t\t\t\tcommentCards[_order].style.top = gTop + 'px';\n\t\t\t\tcommentCards[_order].setAttribute('top-position', gTop);\n\n        \n\t\t\t\tlet selected = document.getElementsByClassName('comment-card-selected');\n\t\t\t\tif(selected.length > 0)\n\t\t\t\t\tselected[0].classList.remove('comment-card-selected');\n\t\t\t\tcommentCards[_order].classList.add('comment-card-selected');\n\t\t\t\tlet endPos = gTop + commentCards[_order].offsetHeight;\n\t\t\t\tif(cTop > gTop){\n\t\t\t\t\t// Move up other uppen comments\n\t\t\t\t\tif(_order > 0)\n\t\t\t\t\t\tmoveUpFromTopPos(commentCards, _order - 1, gTop);\n\t\t\t\t\t// Move up other lower comments\n\t\t\t\t\tif(_order < commentCards.length - 1)\n\t\t\t\t\t\tmoveUpToEndPos(commentCards, _order + 1, endPos);\n\t\t\t\t} else if(cTop < gTop){\n\t\t\t\t\t// Move down other uppen comments\n\t\t\t\t\tif(_order > 0)\n\t\t\t\t\t\tmoveDownToTopPos(commentCards, _order - 1, gTop);\n\t\t\t\t\t// Move down other lower comments\n\t\t\t\t\tif(_order < commentCards.length - 1)\n\t\t\t\t\t\tmoveDownFromEndPos(commentCards, _order + 1, endPos);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n/**\n * Disable rect behavior\n */\nexport function disableSelect() {\n\tif (!_enabled) { return; }\n\n\t_enabled = false;\n\tdocument.removeEventListener('mouseup', handleDocumentMouseup);\n\tdocument.removeEventListener('mousedown', handleDocumentMousedown);\n\tdocument.removeEventListener('keyup', handleDocumentKeyup);\n}\n\n","import { addEventListener, removeEventListener, fireEvent } from './event';\nimport { disableEdit, enableEdit } from './edit';\nimport { disablePen, enablePen, setPen } from './pen';\nimport { disablePoint, enablePoint } from './point';\nimport { disableRect, enableRect } from './rect';\nimport { disableText, enableText, setText } from './text';\nimport { createPage, renderPage } from './page';\nimport { disableSelect, enableSelect, highlightText, \n\tstrikethroughText, commentText, addCommentText, \n\tcancelCommentText, updatePositionsAfterCommentAdded } from './select';\n\nexport default {\n\taddEventListener, removeEventListener, fireEvent,\n\tdisableEdit, enableEdit,\n\tdisablePen, enablePen, setPen,\n\tdisablePoint, enablePoint,\n\tdisableRect, enableRect,\n\tdisableText, enableText, setText,\n\tcreatePage, renderPage,\n\tdisableSelect, enableSelect, highlightText, strikethroughText, \n\tcommentText, addCommentText, cancelCommentText, updatePositionsAfterCommentAdded\n};\n","import StoreAdapter from './adapter/StoreAdapter';\nimport LocalStoreAdapter from './adapter/LocalStoreAdapter';\nimport render from './render';\nimport UI from './UI';\n\nexport default {\n\t/**\n   * Abstract class that needs to be defined so PDFJSAnnotate\n   * knows how to communicate with your server.\n   */\n\tStoreAdapter,\n\n\t/**\n   * Implementation of StoreAdapter that stores annotation data to localStorage.\n   */\n\tLocalStoreAdapter,\n\n\t/**\n   * Abstract instance of StoreAdapter\n   */\n\t__storeAdapter: new StoreAdapter(),\n\n\t/**\n   * Getter for the underlying StoreAdapter property\n   *\n   * @return {StoreAdapter}\n   */\n\tgetStoreAdapter() {\n\t\treturn this.__storeAdapter;\n\t},\n\n\t/**\n   * Setter for the underlying StoreAdapter property\n   *\n   * @param {StoreAdapter} adapter The StoreAdapter implementation to be used.\n   */\n\tsetStoreAdapter(adapter) {\n\t\t// TODO this throws an error when bundled\n\t\t// if (!(adapter instanceof StoreAdapter)) {\n\t\t//   throw new Error('adapter must be an instance of StoreAdapter');\n\t\t// }\n\n\t\tthis.__storeAdapter = adapter;\n\t},\n\n\t/**\n   * UI is a helper for instrumenting UI interactions for creating,\n   * editing, and deleting annotations in the browser.\n   */\n\tUI,\n\n\t/**\n   * Render the annotations for a page in the PDF Document\n   *\n   * @param {SVGElement} svg The SVG element that annotations should be rendered to\n   * @param {PageViewport} viewport The PDFPage.getViewport data\n   * @param {Object} data The StoreAdapter.getAnnotations data\n   * @return {Promise}\n   */\n\trender,\n\n\t/**\n   * Convenience method for getting annotation data\n   *\n   * @alias StoreAdapter.getAnnotations\n   * @param {String} documentId The ID of the document\n   * @param {String} pageNumber The page number\n   * @return {Promise}\n   */\n\tgetAnnotations(documentId, pageNumber) {\n\t\treturn this.getStoreAdapter().getAnnotations(documentId, pageNumber);\n\t}\n};\n","/* eslint-disable no-unused-vars */\n// Color picker component\nconst COLORS = [\n\t{hex: '#000000', name: 'Black'},\n\t{hex: '#EF4437', name: 'Red'},\n\t{hex: '#E71F63', name: 'Pink'},\n\t{hex: '#8F3E97', name: 'Purple'},\n\t{hex: '#65499D', name: 'Deep Purple'},\n\t{hex: '#4554A4', name: 'Indigo'},\n\t{hex: '#2083C5', name: 'Blue'},\n\t{hex: '#35A4DC', name: 'Light Blue'},\n\t{hex: '#09BCD3', name: 'Cyan'},\n\t{hex: '#009688', name: 'Teal'},\n\t{hex: '#43A047', name: 'Green'},\n\t{hex: '#8BC34A', name: 'Light Green'},\n\t{hex: '#FDC010', name: 'Yellow'},\n\t{hex: '#F8971C', name: 'Orange'},\n\t{hex: '#F0592B', name: 'Deep Orange'},\n\t{hex: '#F06291', name: 'Light Pink'}\n];\n\nexport default function initColorPicker(el, value, onChange) {\n\tfunction setColor(value, fireOnChange = true) {\n\t\tcurrentValue = value;\n\t\ta.setAttribute('data-color', value);\n\t\ta.style.background = value;\n\t\tif (fireOnChange && typeof onChange === 'function') {\n\t\t\tonChange(value);\n\t\t}\n\t\tclosePicker();\n\t}\n\n\tfunction togglePicker() {\n\t\tif (isPickerOpen) {\n\t\t\tclosePicker();\n\t\t} else {\n\t\t\topenPicker();\n\t\t}\n\t}\n\n\tfunction closePicker() {\n\t\tdocument.removeEventListener('keyup', handleDocumentKeyup);\n\t\tif (picker && picker.parentNode) {\n\t\t\tpicker.parentNode.removeChild(picker);\n\t\t}\n\t\tisPickerOpen = false;\n\t\ta.focus();\n\t}\n\n\tfunction openPicker() {\n\t\tif (!picker) {\n\t\t\tpicker = document.createElement('div');\n\t\t\tpicker.style.background = '#fff';\n\t\t\tpicker.style.border = '1px solid #ccc';\n\t\t\tpicker.style.padding = '2px';\n\t\t\tpicker.style.position = 'absolute';\n\t\t\tpicker.style.width = '122px';\n\t\t\tel.style.position = 'relative';\n\n\t\t\tCOLORS.map(createColorOption).forEach((c) => {\n\t\t\t\tc.style.margin = '2px';\n\t\t\t\tc.onclick = function () { setColor(c.getAttribute('data-color')); };\n\t\t\t\tpicker.appendChild(c);\n\t\t\t});\n\t\t}\n\n\t\tdocument.addEventListener('keyup', handleDocumentKeyup);\n\t\tel.appendChild(picker);\n\t\tisPickerOpen = true;\n\t}\n\n\tfunction createColorOption(color) {\n\t\tlet e = document.createElement('a');\n\t\te.className = 'color';\n\t\te.setAttribute('href', 'javascript://');\n\t\te.setAttribute('title', color.name);\n\t\te.setAttribute('data-color', color.hex);\n\t\te.style.background = color.hex;\n\t\treturn e;\n\t}\n\n\tfunction handleDocumentKeyup(e) {\n\t\tif (e.keyCode === 27) {\n\t\t\tclosePicker();\n\t\t}\n\t}\n\n\tlet picker;\n\tlet isPickerOpen = false;\n\tlet currentValue;\n\tlet a = createColorOption({hex: value});\n\ta.onclick = togglePicker;\n\tel.appendChild(a);\n\tsetColor(value, false);\n}\n","<template>\n  <div>\n    <div class=\"toolbar\">\n      <button class=\"cursor\" type=\"button\" title=\"Cursor\" data-tooltype=\"cursor\">\n        ➚\n      </button>\n\n      <div class=\"spacer\" />\n\n      <button class=\"rectangle\" type=\"button\" title=\"Rectangle\" data-tooltype=\"area\">\n&nbsp;\n      </button>\n      <button class=\"highlight\" type=\"button\" title=\"Highlight\" data-tooltype=\"highlight\">\n&nbsp;\n      </button>\n      <button class=\"strikeout\" type=\"button\" title=\"Strikeout\" data-tooltype=\"strikeout\">\n&nbsp;\n      </button>\n\n      <div class=\"spacer\" />\n\n      <button class=\"text\" type=\"button\" title=\"Text Tool\" data-tooltype=\"text\" />\n      <select class=\"text-size\" />\n      <div class=\"text-color\" />\n\n      <div class=\"spacer\" />\n\n      <div class=\"spacer\" />\n\n      <button class=\"comment\" type=\"button\" title=\"Comment\" data-tooltype=\"point\">\n        🗨\n      </button>\n\n      <div class=\"spacer\" />\n\n      <select class=\"scale\">\n        <option value=\".5\">\n          50%\n        </option>\n        <option value=\"1\">\n          100%\n        </option>\n        <option value=\"1.33\">\n          133%\n        </option>\n        <option value=\"1.5\">\n          150%\n        </option>\n        <option value=\"2\">\n          200%\n        </option>\n      </select>\n\n      <a href=\"javascript://\" class=\"rotate-ccw\" title=\"Rotate Counter Clockwise\">⟲</a>\n      <a href=\"javascript://\" class=\"rotate-cw\" title=\"Rotate Clockwise\">⟳</a>\n\n      <div class=\"spacer\" />\n\n      <a href=\"javascript://\" class=\"clear\" title=\"Clear\">×</a>\n      <button id=\"restore\" title=\"Restore\">\n        Restore\n      </button>\n    </div>\n\n    <div id=\"rubric-wrapper\">\n      <h4>Rubrics</h4>\n    </div>\n\n    <div id=\"content-wrapper\">\n      <div id=\"viewer\" class=\"pdfViewer\" :style=\"{ width: viewerWidth + 'px' }\" :document-id=\"documentId\" />\n    </div>\n\n    <div id=\"comment-wrapper\">\n      <el-card id=\"add-new-comment\" class=\"box-card add-new-comment\" style=\"width: 100%; display: none;\">\n        <div slot=\"header\" class=\"clearfix\">\n          <div>\n            <div style=\"font-size: 15px; font-weight: bold; text-align: left;\">\n              Dat Le\n            </div>\n          </div>\n        </div>\n        <div>\n          <el-input\n            id=\"comment-text-area\"\n            v-model=\"newComment\"\n            type=\"textarea\"\n            autosize\n            placeholder=\"Add comment\"\n          />\n          <div style=\"height: 20px; margin-top: 10px;\">\n            <el-button type=\"primary\" :disabled=\"newComment.replace(/\\s/g, '').length == 0\" style=\"float: left; padding: 5px;\" @click=\"addCommentText()\">\n              Comment\n            </el-button>\n            <el-button style=\"float: right; padding: 5px;\" @click=\"cancelCommentText()\">\n              Cancel\n            </el-button>\n          </div>\n        </div>\n      </el-card>\n\n      <el-card\n        v-for=\"(comment, idx) in comments\"\n        :key=\"comment.uuid\"\n        class=\"box-card comment-card\"\n        :highlight-id=\"comment.uuid\"\n        :top-position=\"comment.topPosition\"\n        :style=\"{top: comment.topPosition + 'px', width: '100%'}\"\n      >\n        <div slot=\"header\" class=\"clearfix\">\n          <div>\n            <div style=\"font-size: 15px; font-weight: bold; text-align: left;\">\n              Dat Le\n            </div>\n            <div style=\"font-size: 12px; text-align: left;\">\n              3:16 PM Jul 7\n            </div>\n          </div>\n          <el-button style=\"right: -10px;\" class=\"action-card-btn\"\ttitle=\"Delete Comment\"\t@click=\"deleteCommentCard(comment)\">\n            <i class=\"far fa-trash-alt\" />\n          </el-button>\n          <el-button style=\"right: 10px;\" class=\"action-card-btn\"\ttitle=\"Edit Comment\"\t@click=\"displayEditComment(comment, idx)\">\n            <i class=\"far fa-edit\" />\n          </el-button>\n        </div>\n        <div>\n          <div\n            v-show=\"!comment.isSelected\"\n            :id=\"'comment-text-' + comment.uuid\"\n            style=\"text-align: left; overflow-wrap: break-word; white-space: pre-wrap;\"\n          >\n            {{ comment.content }}\n          </div>\n          <el-input\n            v-show=\"comment.isSelected == true\"\n            :id=\"'comment-input-' + comment.uuid\"\n            :ref=\"'comment' + comment.uuid\"\n            v-model=\"comment.content\"\n            type=\"textarea\"\n            autosize\n          />\n          <div v-show=\"comment.isSelected == true\" style=\"height: 20px; margin-top: 10px;\">\n            <el-button type=\"primary\" :disabled=\"comment.content.replace(/\\s/g, '').length == 0\" style=\"float: left; padding: 5px;\" @click=\"editCommentCard()\">\n              Comment\n            </el-button>\n            <el-button style=\"float: right; padding: 5px;\" @click=\"cancelCommentText()\">\n              Cancel\n            </el-button>\n          </div>\n        </div>\n      </el-card>\n    </div>\n\n    <el-button-group id=\"textTool\" style=\"display: none;\">\n      <el-button class=\"textToolBtn\" @click=\"HighlightText()\">\n        <i class=\"fas fa-highlighter\" />\n      </el-button>\n      <el-button class=\"textToolBtn\" @click=\"StrikethroughText()\">\n        <i class=\"fas fa-strikethrough\" />\n      </el-button>\n      <el-button id=\"comment-text\" class=\"textToolBtn\" @click=\"CommentText()\">\n        <i class=\"fas fa-comment-alt\" />\n      </el-button>\n    </el-button-group>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\n\n// import { PDFJS } from \"@/shared/pdf.js\";\n\n// PDFJS.workerSrc = \"/src/shared/pdf.worker.js\";\n// import {\n//   PDFLinkService,\n//   PDFPageView,\n//   PDFFindController,\n//   DefaultAnnotationLayerFactory,\n//   DefaultTextLayerFactory\n// } from \"pdfjs-dist/web/pdf_viewer.js\";\n\nimport '@/pdfjs/shared/document.css'\nimport '@/pdfjs/shared/toolbar.css'\nimport '@/pdfjs/shared/pdf_viewer.css'\nimport PDFJS from 'pdf-dist/webpack.js'\n\n// PDFJSAnnotate\nimport PDFJSAnnotate from '@/pdfjs/PDFJSAnnotate'\nconst { UI } = PDFJSAnnotate\nPDFJSAnnotate.setStoreAdapter(new PDFJSAnnotate.LocalStoreAdapter())\n\n// initColorPicker\nimport initColorPicker from '@/pdfjs/shared/initColorPicker'\nimport {\n\n  findSVGAtPoint,\n  getMetadata,\n  // getOffset,\n  scaleDown\n  // scaleUp,\n  // getAnnotationRect\n} from '@/pdfjs/UI/utils'\nimport { addEventListener } from '@/pdfjs/UI/event'\nimport appendChild from '@/pdfjs/render/appendChild'\n\nexport default {\n  name: 'Document',\n  data() {\n    return {\n      viewer: null,\n      PAGE_HEIGHT: 1,\n      NUM_PAGES: 0,\n      documentId: './static/demand.pdf',\n      RENDER_OPTIONS: {\n        documentId: './static/demand.pdf',\n        pdfDocument: null,\n        scale:\n          parseFloat(localStorage.getItem(`${this.documentId}/scale`), 10) || 1.2,\n        rotate: parseInt(localStorage.getItem(`${this.documentId}/rotate`), 10) || 0\n      },\n      newComment: '',\n      comments: [],\n      viewerWidth: 900,\n      type: null,\n      rects: null,\n      svg: null,\n      target: null,\n      annotation: null,\n      selectedText: null,\n      inputHeight: null,\n      order: null,\n      hasSpace: true,\n      editClicked: false\n    }\n  },\n  mounted() {\n    // Render stuff\n    // #57 fix\n    const renderedPages = {}\n    const self = this\n    document\n      .getElementById('content-wrapper')\n      .addEventListener('scroll', function(e) {\n        const textTool = document.getElementById('textTool')\n        textTool.style.visibility = 'hidden'\n        const visiblePageNum =\n          Math.round(e.target.scrollTop / self.PAGE_HEIGHT) + 1\n        const visiblePage = document.querySelector(\n          `.page[data-page-number=\"${visiblePageNum}\"][data-loaded=\"false\"]`\n        )\n        if (visiblePage) {\n          // Prevent invoking UI.renderPage on the same page more than once.\n          if (!renderedPages[visiblePageNum]) {\n            renderedPages[visiblePageNum] = true\n            setTimeout(function() {\n              UI.renderPage(visiblePageNum, self.RENDER_OPTIONS)\n            })\n          }\n        }\n      })\n\n    this.render()\n    this.TextStuff()\n    this.ToolbarButtons()\n    this.ClearToolbarButton()\n    // this.ScaleAndRotate();\n    // this.ClearToolbarButton();\n  },\n  methods: {\n    async render() {\n      const self = this\n      const pdf = await PDFJS.getDocument(this.RENDER_OPTIONS.documentId)\n        .promise\n      self.RENDER_OPTIONS.pdfDocument = pdf\n      self.viewer = document.getElementById('viewer')\n      self.viewer.innerHTML = ''\n      self.NUM_PAGES = pdf.numPages\n\n      for (let i = 0; i < self.NUM_PAGES; i++) {\n        const page = UI.createPage(i + 1)\n        self.viewer.appendChild(page)\n      }\n\n      // eslint-disable-next-line no-unused-vars\n      const renderer = await UI.renderPage(1, self.RENDER_OPTIONS)\n      const obj = {\n        scale: self.RENDER_OPTIONS.scale,\n        rotation: self.RENDER_OPTIONS.rotate\n      }\n      const viewport = renderer[0].getViewport(obj)\n      self.PAGE_HEIGHT = viewport.height\n\n      const pageWidth = document.getElementById('pageContainer1').offsetWidth\n      this.viewerWidth = pageWidth + 250\n      this.commentleftPos = pageWidth + 15\n\n      const viewer = document.getElementById('viewer')\n      const commentWrapper = document.getElementById('comment-wrapper')\n      commentWrapper.style.left = pageWidth + 15 + 'px'\n      viewer.appendChild(commentWrapper)\n\n      this.comments = await PDFJSAnnotate.getStoreAdapter().getComments(this.documentId)\n      await this.comments.forEach(function(element) {\n        element.isSelected = false\n      })\n      await this.comments.sort((a, b) => (a.topPosition >= b.topPosition) ? 1 : -1)\n      this.TextSelection()\n    },\n    async TextStuff() {\n      const self = this\n      let textSize\n      let textColor\n\n      function initText() {\n        const size = document.querySelector('.toolbar .text-size');\n        [8, 9, 10, 11, 12, 14, 18, 24, 30, 36, 48, 60, 72, 96].forEach(s => {\n          size.appendChild(new Option(s, s))\n        })\n\n        setText(\n          localStorage.getItem(`${self.RENDER_OPTIONS.documentId}/text/size`) ||\n            10,\n          localStorage.getItem(\n            `${self.RENDER_OPTIONS.documentId}/text/color`\n          ) || '#000000'\n        )\n\n        initColorPicker(\n          document.querySelector('.text-color'),\n          textColor,\n          function(value) {\n            setText(textSize, value)\n          }\n        )\n      }\n\n      function setText(size, color) {\n        let modified = false\n\n        if (textSize !== size) {\n          modified = true\n          textSize = size\n          localStorage.setItem(\n            `${self.RENDER_OPTIONS.documentId}/text/size`,\n            textSize\n          )\n          document.querySelector('.toolbar .text-size').value = textSize\n        }\n\n        if (textColor !== color) {\n          modified = true\n          textColor = color\n          localStorage.setItem(\n            `${self.RENDER_OPTIONS.documentId}/text/color`,\n            textColor\n          )\n\n          let selected = document.querySelector(\n            '.toolbar .text-color.color-selected'\n          )\n          if (selected) {\n            selected.classList.remove('color-selected')\n            selected.removeAttribute('aria-selected')\n          }\n\n          selected = document.querySelector(\n            `.toolbar .text-color[data-color=\"${color}\"]`\n          )\n          if (selected) {\n            selected.classList.add('color-selected')\n            selected.setAttribute('aria-selected', true)\n          }\n        }\n\n        if (modified) {\n          UI.setText(textSize, textColor)\n        }\n      }\n\n      function handleTextSizeChange(e) {\n        setText(e.target.value, textColor)\n      }\n\n      document\n        .querySelector('.toolbar .text-size')\n        .addEventListener('change', handleTextSizeChange)\n\n      initText()\n    },\n    async ToolbarButtons() {\n      const self = this\n      let tooltype =\n        localStorage.getItem(`${self.RENDER_OPTIONS.documentId}/tooltype`) ||\n        'cursor'\n      if (tooltype) {\n        setActiveToolbarItem(\n          tooltype,\n          document.querySelector(`.toolbar button[data-tooltype=${tooltype}]`)\n        )\n      }\n\n      function setActiveToolbarItem(type, button) {\n        const active = document.querySelector('.toolbar button.active')\n        if (active) {\n          active.classList.remove('active')\n\n          switch (tooltype) {\n            case 'text':\n              UI.disableText()\n              break\n            case 'point':\n              UI.disablePoint()\n              break\n            case 'area':\n            case 'highlight':\n            case 'strikeout':\n              UI.disableRect()\n              break\n          }\n        }\n\n        if (button) {\n          button.classList.add('active')\n        }\n        if (tooltype !== type) {\n          localStorage.setItem(\n            `${self.RENDER_OPTIONS.documentId}/tooltype`,\n            type\n          )\n        }\n        tooltype = type\n\n        switch (type) {\n          case 'text':\n            UI.enableText()\n            break\n          case 'point':\n            UI.enablePoint()\n            break\n          case 'area':\n          case 'highlight':\n          case 'strikeout':\n            UI.enableRect(type)\n            break\n        }\n      }\n\n      function handleToolbarClick(e) {\n        if (e.target.nodeName === 'BUTTON') {\n          setActiveToolbarItem(\n            e.target.getAttribute('data-tooltype'),\n            e.target\n          )\n        }\n      }\n\n      document\n        .querySelector('.toolbar')\n        .addEventListener('click', handleToolbarClick)\n    },\n    // Clear toolbar button\n    ClearToolbarButton() {\n      const self = this\n      function handleClearClick() {\n        if (confirm('Are you sure you want to clear annotations?')) {\n          for (let i = 0; i < self.NUM_PAGES; i++) {\n            document.querySelector(`div#pageContainer${i + 1} svg.annotationLayer`).innerHTML = ''\n          }\n\n          localStorage.removeItem(`${self.RENDER_OPTIONS.documentId}/annotations`)\n        }\n      }\n      document.querySelector('a.clear').addEventListener('click', handleClearClick)\n    },\n    TextSelection() {\n      const that = this\n      // Register necessary events\n      document.addEventListener('mouseup', handleDocumentMouseup)\n      document.addEventListener('mousedown', handleDocumentMousedown)\n      window.addEventListener('beforeunload', restoreCommentPositions)\n      addEventListener('annotation:click', annotationClick)\n      const commentCards = document.querySelectorAll('.comment-card')\n      commentCards.forEach(item => {\n        item.addEventListener('click', commentCardClick)\n      })\n      function handleDocumentMouseup(e) {\n        if (e.target.classList.contains('textLayer') || e.target.parentElement.classList.contains('textLayer')) {\n          const rects = that.getSelectionRects()\n          if (rects) {\n            const text = window\n              .getSelection()\n              .toString()\n              .trim()\n            // Display text tool bar if text is selected.\n            if (text) {\n              if (e.target.style.top == '') {\n                window.getSelection().removeAllRanges()\n                that.hideTextToolBar()\n              } else {\n                const textTool = document.getElementById('textTool')\n                const posX = rects[rects.length - 1].left + (rects[rects.length - 1].width / 2)\n                const posY = rects[rects.length - 1].top + 20\n                textTool.style = 'position: absolute; top: ' + posY + 'px; left: ' + posX + 'px;'\n                that.rects = rects\n                that.svg = findSVGAtPoint(rects[0].left, rects[0].top)\n                that.target = e.target\n                that.selectedText = text\n              }\n            } else {\n              // Display different tool bar\n            }\n          }\n        }\n      }\n      function handleDocumentMousedown(e) {\n        const svg = findSVGAtPoint(e.clientX, e.clientY)\n        if (svg) {\n          // hide text bool buttons\n          if (!e.target.classList.contains('textToolBtn') &&\n              !e.target.classList.contains('svg-inline--fa') &&\n              !e.target.parentElement.classList.contains('svg-inline--fa')) {\n            const textTool = document.getElementById('textTool')\n            textTool.style.visibility = 'hidden'\n          }\n          // Hide add new comment form\n          const newCommentWrapper = document.getElementById('add-new-comment')\n          if (newCommentWrapper && newCommentWrapper.style.display != 'none') {\n            const validTarget = that.hasAParentWithClass(e.target, 'add-new-comment')\n            const comment = document.getElementById('comment-text-area').value\n            if (!validTarget && comment.replace(/\\s/g, '').length == 0) { that.cancelCommentText() }\n          }\n          // Unselect highlight comment\n          if (!e.target.classList.contains('comment-highlight-selected')) {\n            const validTarget = that.hasAParentWithClass(e.target, 'comment-card-selected')\n            if (!validTarget) { that.unselectHighlightComment() }\n          }\n          return\n        }\n      }\n      function annotationClick(target) {\n        that.handleCommentAnnotationClick(target)\n      }\n      function commentCardClick() {\n        that.handleCommentCardClick(this)\n      }\n      async function restoreCommentPositions() {\n        await that.handleCommentPositionsRestore()\n      }\n    },\n    handleCommentAnnotationClick(target) {\n      const text = window.getSelection().toString().trim()\n      // Display text tool bar if text is selected.\n      if (!text) {\n        const type = target.getAttribute('data-pdf-annotate-type')\n        if (type == 'comment-highlight') {\n          const selectedHighlight = document.getElementsByClassName('comment-highlight-selected')\n          if (selectedHighlight.length > 0) { selectedHighlight[0].classList.remove('comment-highlight-selected') }\n          target.classList.add('comment-highlight-selected')\n\n          const commentCards = document.querySelectorAll('.comment-card')\n          const commentHighlights = document.querySelectorAll(\"g[data-pdf-annotate-type='comment-highlight']\")\n          const highlightArr = Array.prototype.slice.call(commentHighlights)\n          // Sort the highlights\n          highlightArr.sort(this.compareTopAttributes)\n          // Get order of the current highlight\n          this.order = highlightArr.findIndex(item => {\n            return item.dataset.pdfAnnotateId == target.getAttribute('data-pdf-annotate-id')\n          })\n\n          let gTop = parseInt(target.getAttribute('top')) - 35\n          const svgHeight = parseInt(target.getAttribute('page-height'))\n          const svgPageNum = parseInt(target.getAttribute('page-num'))\n          if (svgPageNum > 1) { gTop += ((svgPageNum - 1) * svgHeight) }\n\n          const cTop = this.comments[this.order].topPosition\n          // parseInt(commentCards[this.order].style.top.substring(0, commentCards[this.order].style.top.length - 2));\n\n          // remove current selected comment card class if any\n          const selected = document.getElementsByClassName('comment-card-selected')\n          if (selected.length > 0) { selected[0].classList.remove('comment-card-selected') }\n          // Set this card as selected\n          commentCards[this.order].classList.add('comment-card-selected')\n\n          if (cTop != gTop) {\n            // Move the comment up to gTop\n            this.comments[this.order].topPosition = gTop\n\n            const selected = document.getElementsByClassName('comment-card-selected')\n            if (selected.length > 0) { selected[0].classList.remove('comment-card-selected') }\n            commentCards[this.order].classList.add('comment-card-selected')\n\n            const endPos = gTop + commentCards[this.order].offsetHeight\n            if (cTop > gTop) {\n              // Move up other uppen comments\n              if (this.order > 0) { this.moveUpFromTopPos(commentCards, this.order - 1, gTop) }\n              // Move up other lower comments\n              if (this.order < commentCards.length - 1) { this.moveUpToEndPos(commentCards, this.order + 1, endPos) }\n            } else if (cTop < gTop) {\n              // Move down other uppen comments\n              if (this.order > 0) { this.moveDownToTopPos(commentCards, this.order - 1, gTop) }\n              // Move down other lower comments\n              if (this.order < commentCards.length - 1) { this.moveDownFromEndPos(commentCards, this.order + 1, endPos) }\n            }\n          }\n        }\n      }\n    },\n    handleCommentCardClick(el) {\n      const highlightId = el.getAttribute('highlight-id')\n      const highlight = document.querySelector(\"g[data-pdf-annotate-id='\" + highlightId + \"']\")\n      this.handleCommentAnnotationClick(highlight)\n    },\n    async handleCommentPositionsRestore() {\n      const documentId = document.getElementById('viewer').getAttribute('document-id')\n      const highlights = document.querySelectorAll(\"g[data-pdf-annotate-type='comment-highlight']\")\n      const highlightArr = Array.prototype.slice.call(highlights)\n      // Sort the highlights\n      highlightArr.sort(this.compareTopAttributes)\n      this.handleCommentAnnotationClick(highlightArr[0])\n      const comments = await this.updateCommentAnnotations(documentId)\n      await PDFJSAnnotate.getStoreAdapter().updateComments(documentId, comments)\n    },\n    async updateCommentAnnotations(documentId) {\n      const comments = await PDFJSAnnotate.getStoreAdapter().getComments(documentId)\n      comments.forEach(comment => {\n        const thisCard = document.querySelector(\".comment-card[highlight-id='\" + comment.uuid + \"']\")\n        comment.topPosition = parseInt(thisCard.getAttribute('top-position'))\n      })\n      return comments\n    },\n    async HighlightText() {\n      await this.highlightText('highlight')\n    },\n    async StrikethroughText() {\n      await this.highlightText('strikeout')\n      const textTool = document.getElementById('textTool')\n      textTool.style.visibility = 'hidden'\n    },\n    // Migration code starts here\n    async CommentText() {\n      if (this.newComment.replace(/\\s/g, '').length != 0) {\n        // Save in-progress comment\n        await this.addCommentText()\n      }\n      await this.commentText()\n    },\n    async addCommentText() {\n      // let newComment = await UI.addCommentText(this.newComment, this.RENDER_OPTIONS.documentId);\n      const commentWrapper = document.getElementById('add-new-comment')\n      const topPos = parseInt(commentWrapper.style.top.substring(0, commentWrapper.style.top.length - 2))\n      const newComment = await PDFJSAnnotate.getStoreAdapter().addComment(this.documentId,\n        this.annotation,\n        this.newComment,\n        this.selectedText,\n        topPos)\n      await this.comments.push(newComment)\n      await this.comments.sort((a, b) => (a.topPosition >= b.topPosition) ? 1 : -1)\n      document.getElementById('add-new-comment').style.display = 'none'\n\n      await this.updatePositionsAfterCommentAdded()\n      this.newComment = ''\n    },\n    // Begin migrating code from select.js to document.vue\n    async commentText() {\n      // Highlight the text first\n      await this.highlightText('comment-highlight')\n      // Update positions of comment boxes\n      this.updateCommentPositions()\n      // Display add new form\n      this.displayAddNewCommentForm()\n      event.stopPropagation()\n    },\n    async highlightText(type) {\n      if (!this.svg) {\n        return\n      }\n      const boundingRect = this.svg.getBoundingClientRect()\n\n      let color = 'FFFF00'\n      if (type == 'strikeout') { color = 'FF0000' }\n\n      // Initialize the annotation\n      const annotation = {\n        type,\n        color,\n        rectangles: [...this.rects].map((r) => {\n          let offset = 0\n          if (type == 'strikeout') { offset = r.height / 2 }\n          return scaleDown(this.svg, {\n            y: (r.top + offset) - boundingRect.top,\n            x: r.left - boundingRect.left,\n            width: r.width,\n            height: r.height\n          })\n        }).filter((r) => r.width > 0 && r.height > 0 && r.x > -1 && r.y > -1)\n      }\n\n      // Short circuit if no rectangles exist\n      if (annotation.rectangles.length === 0) {\n        return\n      }\n\n      if (annotation.rectangles.length > 2) {\n        annotation.rectangles = this.removeMinHeigthRects(annotation.rectangles)\n      }\n\n      const { documentId, pageNumber } = getMetadata(this.svg)\n\n      annotation.top = parseInt(this.target.style.top.substring(0, this.target.style.top.length - 2))\n      annotation.pageNum = pageNumber\n      annotation.pageHeight = this.svg.getAttribute('height')\n      this.annotation = annotation\n      // Add the annotation\n      await PDFJSAnnotate.getStoreAdapter().addAnnotation(documentId, pageNumber, annotation)\n        .then((annotation) => {\n          appendChild(this.svg, annotation)\n          this.hideTextToolBar()\n        })\n    },\n    updateCommentPositions() {\n      const commentCards = document.querySelectorAll('.comment-card')\n      const commentHighlights = document.querySelectorAll(\"g[data-pdf-annotate-type='comment-highlight']\")\n      const highlightArr = Array.prototype.slice.call(commentHighlights)\n      // Sort the highlights\n      highlightArr.sort(this.compareTopAttributes)\n      // Get order of the current highlight\n      this.order = highlightArr.findIndex(item => {\n        return item.dataset.pdfAnnotateId == this.annotation.uuid\n      })\n      this.hasSpace = this.hasEnoughSpace(commentCards)\n      if (!this.hasSpace) {\n        // Update comment positions\n\n        // get add new form's top position\n        const svg = this.svg\n        const rectTop = parseInt(this.target.style.top.substring(0, this.target.style.top.length - 2))\n        const svgHeight = svg.getAttribute('height')\n        const svgPageNum = svg.getAttribute('data-pdf-annotate-page')\n        let svgTop = 0\n        if (svgPageNum > 1) { svgTop += ((svgPageNum - 1) * svgHeight) }\n        const topPos = svgTop + rectTop - 35\n        const endPos = topPos + 126\n\n        if (this.order == 0) {\n          // Move down all comment cards\n          this.moveDownFromEndPos(commentCards, 0, endPos)\n        } else if (this.order == highlightArr.length - 1) {\n          // Move up all comment cards\n          this.moveUpFromTopPos(commentCards, commentCards.length - 1, topPos)\n        } else {\n          // Move up commentCards[0] -> commentCards[i - 1]\n          const upperTop = parseInt(commentCards[this.order - 1].style.top.substring(0, commentCards[this.order - 1].style.top.length - 2))\n          const upperEnd = upperTop + commentCards[this.order - 1].offsetHeight\n          // Check if move up is necessary\n          if (upperEnd > (topPos - 10)) {\n            this.moveUpFromTopPos(commentCards, this.order - 1, topPos)\n          } else {\n            // Check if move down is necessary\n            const commentId = commentCards[this.order - 1].getAttribute('highlight-id')\n            const g = this.getHighlightByCommentId(commentId)\n            let gTop = parseInt(g.getAttribute('top')) - 35\n            if (g.getAttribute('page-num') > 1) { gTop += ((g.getAttribute('page-num') - 1) * g.getAttribute('page-height')) }\n            if (upperTop < gTop) {\n              this.moveDownToTopPos(commentCards, this.order - 1, topPos)\n            }\n          }\n          // Move down commentCards[i] -> commentCards[commentCards.length - 1]\n          const lowerTop = parseInt(commentCards[this.order].style.top.substring(0, commentCards[this.order].style.top.length - 2))\n          if (lowerTop < (endPos + 10)) {\n            this.moveDownFromEndPos(commentCards, this.order, endPos)\n          } else {\n            // Check if move up is necessary\n            const commentId = commentCards[this.order].getAttribute('highlight-id')\n            const g = this.getHighlightByCommentId(commentId)\n            let gTop = parseInt(g.getAttribute('top')) - 35\n            if (g.getAttribute('page-num') > 1) { gTop += ((g.getAttribute('page-num') - 1) * g.getAttribute('page-height')) }\n            if (lowerTop > gTop) {\n              this.moveUpToEndPos(commentCards, this.order, endPos)\n            }\n          }\n        }\n      }\n    },\n    async updatePositionsAfterCommentAdded() {\n      const newComment = document.querySelector(\".comment-card[highlight-id='\" + this.annotation.uuid + \"']\")\n\n      if (!this.hasSpace) {\n        const commentCards = document.querySelectorAll('.comment-card')\n        const endPos = parseInt(newComment.getAttribute('top-position')) + newComment.offsetHeight\n        if (this.order < (commentCards.length - 1)) { this.moveUpToEndPos(commentCards, this.order + 1, endPos) }\n      }\n      const that = this\n      newComment.addEventListener('click', function commentCardClick() {\n        that.handleCommentCardClick(this)\n      })\n    },\n    displayAddNewCommentForm() {\n      const newCommentWrapper = document.getElementById('add-new-comment')\n      newCommentWrapper.style.visibility = 'visible'\n      const svg = this.svg\n      const rectTop = parseInt(this.target.style.top.substring(0, this.target.style.top.length - 2))\n      const svgHeight = svg.getAttribute('height')\n      const svgPageNum = svg.getAttribute('data-pdf-annotate-page')\n\n      let svgTop = 0\n      if (svgPageNum > 1) { svgTop += ((svgPageNum - 1) * svgHeight) }\n      const topPos = svgTop + rectTop - 35\n      newCommentWrapper.style = 'width: 100%; position: absolute; left: 5px; top: ' + topPos + 'px;'\n      this.hideTextToolBar()\n      const textArea = document.getElementById('comment-text-area')\n      textArea.focus()\n      this.inputHeight = parseInt(textArea.style.height.substring(0, textArea.style.height.length - 2))\n      const that = this\n      textArea.addEventListener('keydown', function() {\n        const commentCards = document.querySelectorAll('.comment-card')\n        if (commentCards.length > 0) {\n          setTimeout(function() {\n            const newHeight = parseInt(textArea.style.height.substring(0, textArea.style.height.length - 2))\n            const newCommentWrapper = document.getElementById('add-new-comment')\n            const topPos = parseInt(newCommentWrapper.style.top.substring(0, newCommentWrapper.style.top.length - 2))\n            const endPos = topPos + newCommentWrapper.offsetHeight\n            if (that.inputHeight < newHeight) {\n              if (that.order <= commentCards.length - 1) { that.moveDownFromEndPos(commentCards, that.order, endPos) }\n            } else if (that.inputHeight > newHeight) {\n              if (that.order < commentCards.length) { that.moveUpToEndPos(commentCards, that.order, endPos) }\n            }\n            that.inputHeight = newHeight\n          }, 100)\n        }\n      })\n    },\n    cancelCommentText() {\n      this.newComment = ''\n      const documentId = getMetadata(this.svg).documentId\n      const newCommentWrapper = document.getElementById('add-new-comment')\n      const topPos = parseInt(newCommentWrapper.style.top.substring(0, newCommentWrapper.style.top.length - 2))\n      const endPos = topPos + newCommentWrapper.offsetHeight\n      newCommentWrapper.style.display = 'none'\n      const commentCards = document.querySelectorAll('.comment-card')\n      if (commentCards.length > 0) {\n        if (this.order <= (commentCards.length - 1)) {\n          this.moveUpToEndPos(commentCards, this.order, topPos)\n          if (this.order > 0) {\n            const orderTopPos = this.comments[this.order].topPosition\n            // parseInt(commentCards[this.order].style.top.substring(0, commentCards[this.order].style.top.length - 2));\n            this.moveDownToTopPos(commentCards, this.order - 1, orderTopPos)\n          }\n        }\n        if (this.order == commentCards.length) {\n          this.moveDownToTopPos(commentCards, this.order - 1, endPos)\n        }\n      }\n      // Remove the annotation\n      PDFJSAnnotate.getStoreAdapter().deleteAnnotation(documentId, this.annotation.uuid)\n        .then((isDeleted) => {\n          if (isDeleted) {\n            // remove highlight in UI\n            document.querySelector(\"g[data-pdf-annotate-id='\" + this.annotation.uuid + \"']\").remove()\n            this.annotation = null\n          }\n        })\n    },\n    unselectHighlightComment() {\n      const selectedHighlight = document.getElementsByClassName('comment-highlight-selected')\n      if (selectedHighlight.length > 0) { selectedHighlight[0].classList.remove('comment-highlight-selected') }\n      const selectedComment = document.getElementsByClassName('comment-card-selected')\n      if (selectedComment.length > 0) { selectedComment[0].classList.remove('comment-card-selected') }\n    },\n    moveUpFromTopPos(commentCards, startIndex, topPos) {\n      // Get start index card's position\n      const adjTop = this.comments[startIndex].topPosition\n      const adjEnd = adjTop + commentCards[startIndex].offsetHeight\n      // Move the start index card up first\n\n      this.comments[startIndex].topPosition = adjTop - (adjEnd - topPos) - 10\n      if (startIndex > 0) {\n        for (let m = startIndex - 1; m >= 0; m--) {\n          const previousTop = this.comments[m + 1].topPosition\n          const thisTop = this.comments[m].topPosition\n          const thisEnd = thisTop + commentCards[m].offsetHeight\n          if (thisEnd > (previousTop - 10)) {\n            this.comments[m].topPosition = thisTop - (thisEnd - previousTop) - 10\n          } else {\n            break\n          }\n        }\n      }\n    },\n    moveUpToEndPos(commentCards, startIndex, endPos) {\n      const g = this.getHighlightByCommentId(this.comments[startIndex].uuid)\n      let gTop = parseInt(g.getAttribute('top')) - 35\n      if (g.getAttribute('page-num') > 1) { gTop += ((g.getAttribute('page-num') - 1) * g.getAttribute('page-height')) }\n      if (this.comments[startIndex].topPosition > gTop) {\n        const desiredTop = gTop >= (endPos + 10) ? gTop : (endPos + 10)\n        // Move start index card up\n        this.comments[startIndex].topPosition = desiredTop\n        if (commentCards.length > (startIndex + 1)) {\n          for (let n = startIndex + 1; n < this.comments.length; n++) {\n            const previousTop = this.comments[n - 1].topPosition\n            const previousEnd = previousTop + commentCards[n - 1].offsetHeight\n            const thisTop = this.comments[n].topPosition\n\n            // Check if move down is necessary\n            if (thisTop > (previousEnd + 10)) {\n              const thisG = this.getHighlightByCommentId(this.comments[n].uuid)\n              let thisGTop = parseInt(thisG.getAttribute('top')) - 35\n              if (thisG.getAttribute('page-num') > 1) { thisGTop += ((thisG.getAttribute('page-num') - 1) * thisG.getAttribute('page-height')) }\n              if (thisTop > thisGTop) {\n                const thisDesiredTop = thisGTop >= (previousEnd + 10) ? thisGTop : (previousEnd + 10)\n                this.comments[n].topPosition = thisDesiredTop\n              }\n            } else {\n              break\n            }\n          }\n        }\n      }\n    },\n    moveDownToTopPos(commentCards, startIndex, topPos) {\n      // Get start index card's position\n      const adjTop = this.comments[startIndex].topPosition\n      const adjEnd = adjTop + commentCards[startIndex].offsetHeight\n      // Check if move down is necessary\n      const g = this.getHighlightByCommentId(this.comments[startIndex].uuid)\n      let gTop = parseInt(g.getAttribute('top')) - 35\n      if (g.getAttribute('page-num') > 1) { gTop += ((g.getAttribute('page-num') - 1) * g.getAttribute('page-height')) }\n      // Only move cards down if the upper card is higher that its highlight\n      if (adjTop < gTop) {\n        const desiredTop = gTop <= (adjTop + (topPos - adjEnd) - 10) ? gTop : (adjTop + (topPos - adjEnd) - 10)\n        // Move upper adjacent card down\n        this.comments[startIndex].topPosition = desiredTop\n        // Move other cards down\n        if (startIndex > 0) {\n          for (let n = startIndex - 1; n >= 0; n--) {\n            const previousTop = this.comments[n + 1].topPosition\n            // let previousEnd = previousTop + commentCards[n + 1].offsetHeight;\n            const thisTop = this.comments[n].topPosition\n            const thisEnd = thisTop + commentCards[n].offsetHeight\n            // Check if move down is necessary\n            if (thisEnd < (previousTop - 10)) {\n              const thisG = this.getHighlightByCommentId(this.comments[n].uuid)\n              let thisGTop = parseInt(thisG.getAttribute('top')) - 35\n              if (thisG.getAttribute('page-num') > 1) { thisGTop += ((thisG.getAttribute('page-num') - 1) * thisG.getAttribute('page-height')) }\n              if (thisTop < thisGTop) {\n                const thisDesiredTop = thisGTop <= (thisTop + (previousTop - thisEnd) - 10) ? thisGTop : (thisTop + (previousTop - thisEnd) - 10)\n                this.comments[n].topPosition = thisDesiredTop\n              }\n            } else {\n              break\n            }\n          }\n        }\n      }\n    },\n    moveDownFromEndPos(commentCards, startIndex, endPos) {\n      // Move the start index card down first\n      this.comments[startIndex].topPosition = endPos + 10\n      // Move other cards down ward\n      if (this.comments.length > (startIndex + 1)) {\n        for (let j = startIndex + 1; j < this.comments.length; j++) {\n          const previousTop = this.comments[j - 1].topPosition\n          const previousEnd = previousTop + commentCards[j - 1].offsetHeight\n          const thisTop = this.comments[j].topPosition\n          if (thisTop < (previousEnd + 10)) {\n            this.comments[j].topPosition = thisTop + (previousEnd - thisTop) + 10\n          } else {\n            break\n          }\n        }\n      }\n    },\n    hasEnoughSpace(commentCards) {\n      if (this.comments.length > 0) {\n        const svg = this.svg\n        const rectTop = parseInt(this.target.style.top.substring(0, this.target.style.top.length - 2))\n        const svgHeight = svg.getAttribute('height')\n        const svgPageNum = svg.getAttribute('data-pdf-annotate-page')\n\n        let svgTop = 0\n        if (svgPageNum > 1) { svgTop += ((svgPageNum - 1) * svgHeight) }\n        const topPos = svgTop + rectTop - 35\n        const endPos = topPos + 105\n\n        // Check first and last position\n        const firstTopPos = this.comments[0].topPosition\n        const lastEndPos = this.comments[this.comments.length - 1].topPosition + commentCards[commentCards.length - 1].offsetHeight\n\n        if (endPos < firstTopPos || topPos > lastEndPos) { return true }\n        if (this.comments.length > 1) {\n          for (let i = 0; i < this.comments.length - 1; i++) {\n            const thisTopPos = this.comments[i].topPosition\n            const thisEndPos = thisTopPos + commentCards[i].offsetHeight\n            const nextTopPos = this.comments[i + 1].topPosition\n            if (topPos > thisEndPos && endPos < nextTopPos) {\n              return true\n            }\n          }\n        }\n\n        return false\n      }\n      return true\n    },\n    compareTopAttributes(a, b) {\n      let top1 = parseInt(a.getAttribute('top'))\n      if (a.getAttribute('page-num') > 1) { top1 += ((a.getAttribute('page-num') - 1) * a.getAttribute('page-height')) }\n\n      let top2 = parseInt(b.getAttribute('top'))\n      if (b.getAttribute('page-num') > 1) { top2 += ((b.getAttribute('page-num') - 1) * b.getAttribute('page-height')) }\n      if (top1 > top2) return 1\n      if (top2 > top1) return -1\n      if (top2 == top1) {\n        // compare order attributes\n        const order1 = parseInt(a.getAttribute('order'))\n        const order2 = parseInt(b.getAttribute('order'))\n        if (order1 > order2) return 1\n        if (order2 > order1) return -1\n      }\n      return 0\n    },\n    removeMinHeigthRects(arr) {\n      const min = Math.min(...arr.map(a => a.height))\n      return arr.filter(a => a.height != min)\n    },\n    displayEditComment(comment) {\n      this.comments.forEach(function(element) {\n        element.isSelected = false\n      })\n      comment.isSelected = true\n      this.$forceUpdate()\n      const refName = 'comment' + comment.uuid\n      this.$refs[refName][0].$el.childNodes[0].focus()\n    },\n    editCommentCard() {\n\n    },\n    deleteCommentCard(commentId) {\n      console.log(commentId)\n    },\n    hideTextToolBar() {\n      const textTool = document.getElementById('textTool')\n      textTool.style.visibility = 'hidden'\n    },\n    getHighlightByCommentId(commentId) {\n      return document.querySelector(\"g[data-pdf-annotate-id='\" + commentId + \"']\")\n    },\n    getSelectionRects() {\n      const selection = window.getSelection()\n      const range = selection.getRangeAt(0)\n      const rects = range.getClientRects()\n\n      if (rects.length > 0 &&\n          rects[0].width > 0 &&\n          rects[0].height > 0) {\n        return rects\n      }\n      return null\n    },\n    hasAParentWithClass(element, className) {\n      for (let i = 0; i <= 5; i++) {\n        if (element.classList.contains(className)) { return true } else { element = element.parentNode }\n      }\n      return false\n    }\n    // End migration\n  }\n}\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Document.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Document.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Document.vue?vue&type=template&id=08dccdf3&\"\nimport script from \"./Document.vue?vue&type=script&lang=js&\"\nexport * from \"./Document.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"test\"},[_c('div',[_c('div',{staticStyle:{\"width\":\"420px\",\"margin\":\"auto\",\"padding\":\"30px\",\"border\":\"#d4d3d3 solid 1px\",\"border-radius\":\"8px\",\"background-color\":\"white\"}},[_c('div',[_c('el-form',{attrs:{\"model\":_vm.form}},[_c('div',[_c('el-button',{attrs:{\"plain\":\"\"}},[_vm._v(\" Edvision Logo \")]),_c('p',{staticClass:\"welcome\"},[_vm._v(\" Welcome back, please login to your account. \")])],1),_c('el-form-item',{staticStyle:{\"text-align\":\"left\"}},[_c('span',{staticStyle:{\"font-size\":\"15px\",\"font-weight\":\"bold\",\"color\":\"#409eff\"}},[_vm._v(\" Institution Email \")]),_c('el-input',{attrs:{\"id\":\"email\",\"type\":\"text\"},model:{value:(_vm.form.username),callback:function ($$v) {_vm.$set(_vm.form, \"username\", $$v)},expression:\"form.username\"}}),_c('br')],1),_c('el-form-item',{staticStyle:{\"text-align\":\"left\"}},[_c('span',{staticStyle:{\"font-size\":\"15px\",\"font-weight\":\"bold\",\"color\":\"#409eff\"}},[_vm._v(\" Password \")]),_c('el-input',{attrs:{\"id\":\"password\",\"type\":\"password\",\"autocomplete\":\"off\"},model:{value:(_vm.form.password),callback:function ($$v) {_vm.$set(_vm.form, \"password\", $$v)},expression:\"form.password\"}})],1),_c('el-form-item',[_c('el-checkbox',{staticStyle:{\"float\":\"left\"}},[_vm._v(\" Remember Me \")]),_c('a',{staticStyle:{\"float\":\"right\",\"color\":\"#409eff\",\"text-decoration\":\"none\"},attrs:{\"href\":\"https://netid.usf.edu/una/?display=reset\"}},[_vm._v(\" Forgot Password? \")])],1),_c('el-form-item',[_c('el-button',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.login()}}},[_vm._v(\" Sign in to EdVision \")])],1),_c('el-form-item',[_c('form',{ref:\"googleLoginForm\",attrs:{\"method\":\"post\",\"action\":_vm.googleFormAction}},[_c('el-button',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitGoogleLoginForm()}}},[_vm._v(\" Sign in with Google \")])],1)]),_c('el-form-item',[_c('form',{ref:\"facebookLoginForm\",attrs:{\"method\":\"post\",\"action\":_vm.facebookFormAction}},[_c('el-button',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitFacebookLoginForm()}}},[_vm._v(\" Sign in with Facebook \")])],1)]),_c('div',{staticStyle:{\"font-size\":\"14px\",\"text-align\":\"center\",\"padding-bottom\":\"5px\"}},[_vm._v(\" By logging in, I agree to the \"),_c('a',{staticStyle:{\"color\":\"#409eff\",\"text-decoration\":\"none\"},attrs:{\"href\":\"#\"}},[_vm._v(\" terms \")]),_vm._v(\" and \"),_c('a',{staticStyle:{\"color\":\"#409eff\",\"text-decoration\":\"none\"},attrs:{\"href\":\"#\"}},[_vm._v(\" policies \")])]),_c('hr'),_c('el-form-item',{staticStyle:{\"margin-bottom\":\"5px\"}},[_c('el-button',{staticStyle:{\"width\":\"100%\"},attrs:{\"type\":\"primary\",\"plain\":\"\"}},[_vm._v(\" Contact Support \")])],1)],1)],1)])]),_c('div',{staticStyle:{\"width\":\"30%\",\"margin\":\"auto\",\"margin-top\":\"20px\"}},[_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":function($event){return _vm.apiCall()}}},[_vm._v(\" Api Call \")]),_c('el-button',{attrs:{\"type\":\"primary\",\"plain\":\"\"},on:{\"click\":function($event){return _vm.logout()}}},[_vm._v(\" Logout \")])],1),(_vm.weathers && _vm.weathers.length > 0)?_c('el-table',{staticStyle:{\"width\":\"50%\",\"margin\":\"auto\",\"margin-top\":\"20px\"},attrs:{\"data\":_vm.weathers,\"border\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"date\",\"label\":\"Date\",\"width\":\"180\"}}),_c('el-table-column',{attrs:{\"prop\":\"temperatureC\",\"label\":\"Temperature C\",\"width\":\"180\"}}),_c('el-table-column',{attrs:{\"prop\":\"temperatureF\",\"label\":\"Temperature F\"}}),_c('el-table-column',{attrs:{\"prop\":\"summary\",\"label\":\"Summary\"}})],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * URL utilities.\n * @module utils/url-utils\n */\n\n/**\n * Get base URL.\n *\n * @return {String} URL\n */\nexport const getBaseURL = () => {\n  const url = window.location.href\n  const arr = url.split('/')\n  const protocol = arr[0]\n  // const protocol = process.env.NODE_ENV === 'production' ? 'https:' :'http:';\n  const host = process.env.NODE_ENV === 'production' ? window.location.host : 'localhost:6990'\n  return `${protocol}//${host}`\n}\n\n/**\n * Get base URL of REST service.\n *\n * @return {String} URL\n */\nexport const getBaseApiURL = () => {\n  const apiEndpoint = process.env.VUE_APP_API_ENDPOINT\n  return `${getBaseURL()}/${apiEndpoint}`\n}\n","/**\n * HTTP client.\n *\n * @see {@link https://github.com/axios/axios}\n * @module utils/axios\n */\n// import _ from 'lodash';\nimport axios from 'axios'\nimport * as urlUtils from '@/utils/url'\n// // import store from '../store';\n// import NProgress from 'nprogress';\n\n// import { Notification } from 'element-ui';\n\nconst config = {\n  baseURL: urlUtils.getBaseApiURL(),\n  timeout: 100000\n}\n\nconst instance = axios.create(config)\n\n// // Add a request interceptor\n// instance.interceptors.request.use(\n// \tfunction(config) {\n// \t\tstore.dispatch('loading/startLoading');\n// \t\tlet accessToken = store.state.auth.token.accessToken;\n// \t\tif (!_.isEmpty(accessToken)) {\n// \t\t\tconfig.headers.Authorization = `Bearer ${accessToken}`;\n// \t\t}\n// \t\treturn config;\n// \t},\n// \tfunction(error) {\n// \t\tstore.dispatch('loading/startLoading');\n// \t\treturn Promise.reject(error);\n// \t}\n// );\n\n// instance.interceptors.response.use(\n// \tresponse => {\n// \t\tstore.dispatch('loading/doneLoading');\n// \t\treturn response;\n// \t},\n// \terror => {\n// \t\tstore.dispatch('loading/doneLoading');\n\n// \t\t// Check for errorHandle config\n// \t\tif (error.config.hasOwnProperty('errorHandle') && error.config.errorHandle === false) {\n// \t\t\treturn Promise.reject(error);\n// \t\t}\n\n// \t\t// Handling error\n// \t\tif (error.response) {\n// \t\t\tlet message = '';\n// \t\t\tif (error.response.data.Message)\n// \t\t\t\tmessage += error.response.data.Message + ' ';\n// \t\t\tif (error.response.data.ModelState)\n// \t\t\t\tmessage += error.response.data.ModelState.invalid_grant + ' ';\n// \t\t\tif (error.response.data.InnerException)\n// \t\t\t\tmessage += error.response.data.InnerException.ExceptionMessage;\n\n// \t\t\tNotification.error({\n// \t\t\t\ttitle: 'Error',\n// \t\t\t\tmessage: message\n// \t\t\t});\n// \t\t}\n\n// \t}\n// );\n\n// axios methods\nconst methods = {\n  /**\n\t * request.\n\t * @param {Object} config Config\n\t * @return {Promise} Promise\n\t * @see {@link https://github.com/mzabriskie/axios#instance-methods}\n\t */\n  request(config) {\n    throw new Error('Not Implemented')\n  },\n\n  /**\n\t * get.\n\t * @param {String} url Url\n\t * @param {Object} config Config\n\t * @return {Promise} Promise\n\t * @see {@link https://github.com/mzabriskie/axios#instance-methods}\n\t */\n  get(url, config) {\n    return instance.get(url, config)\n  },\n\n  /**\n\t * delete.\n\t * @param {String} url Url\n\t * @param {Object} config Config\n\t * @return {Promise} Promise\n\t * @see {@link https://github.com/mzabriskie/axios#instance-methods}\n\t */\n  delete(url, config) {\n    return instance.delete(url, config)\n  },\n\n  /**\n\t * head.\n\t * @param {String} url Url\n\t * @param {Object} config Config\n\t * @return {Promise} Promise\n\t * @see {@link https://github.com/mzabriskie/axios#instance-methods}\n\t */\n  head(url, config) {\n    throw new Error('Not Implemented')\n  },\n\n  /**\n\t * options.\n\t * @param {String} url Url\n\t * @param {Object} config Config\n\t * @return {Promise} Promise\n\t * @see {@link https://github.com/mzabriskie/axios#instance-methods}\n\t */\n  options(url, config) {\n    throw new Error('Not Implemented')\n  },\n\n  /**\n\t * post.\n\t * @param {String} url Url\n\t * @param {Object} data Data\n\t * @param {Object} config Config\n\t * @return {Promise} Promise\n\t * @see {@link https://github.com/mzabriskie/axios#instance-methods}\n\t */\n  post(url, data, config) {\n    return instance.post(url, data, config)\n  },\n\n  /**\n\t * put.\n\t * @param {String} url Url\n\t * @param {Object} data Data\n\t * @param {Object} config Config\n\t * @return {Promise} Promise\n\t * @see {@link https://github.com/mzabriskie/axios#instance-methods}\n\t */\n  put(url, data, config) {\n    return instance.put(url, data, config)\n  },\n\n  /**\n\t * patch.\n\t * @param {String} url Url\n\t * @param {Object} data Data\n\t * @param {Object} config Config\n\t * @return {Promise} Promise\n\t * @see {@link https://github.com/mzabriskie/axios#instance-methods}\n\t */\n  patch(url, data, config) {\n    throw new Error('Not Implemented')\n  }\n}\n\nexport default methods\n\n/**\n * Set access token.\n *\n * @param {String} token access token\n */\n// export const setAccessToken = token => {\n//   accessToken = token\n// }\n\n/**\n * Set error handler for axios instance.\n *\n * @param {Function} handler handler fucntion\n */\n// export const setErrorHander = handler => {\n//   errorHandler = handler\n// }\n","<template>\n  <div class=\"test\">\n    <!-- <div>\n\t\t\t<p>Hello {{ username }}</p>\n\t\t</div>\n\t\t<el-alert\n\t\t\ttitle=\"warning alert\"\n\t\t\ttype=\"warning\"\n\t\t/> -->\n    <div>\n      <div\n        style=\"width: 420px;\n\t\t\t\t\tmargin: auto;\n\t\t\t\t\tpadding: 30px;\n\t\t\t\t\tborder: #d4d3d3 solid 1px;\n\t\t\t\t\tborder-radius: 8px;\n\t\t\t\t\tbackground-color: white;\"\n      >\n        <div>\n          <el-form :model=\"form\">\n            <div>\n              <el-button plain>\n                Edvision Logo\n              </el-button>\n              <p class=\"welcome\">\n                Welcome back, please login to your account.\n              </p>\n            </div>\n            <el-form-item style=\"text-align: left;\">\n              <span style=\"font-size: 15px; font-weight: bold; color: #409eff;\">\n                Institution Email\n              </span>\n              <el-input id=\"email\" v-model=\"form.username\" type=\"text\" />\n              <br>\n            </el-form-item>\n            <el-form-item style=\"text-align: left;\">\n              <span style=\"font-size: 15px; font-weight: bold; color: #409eff;\">\n                Password\n              </span>\n              <el-input id=\"password\" v-model=\"form.password\" type=\"password\" autocomplete=\"off\" />\n            </el-form-item>\n            <el-form-item>\n              <el-checkbox style=\"float: left;\">\n                Remember Me\n              </el-checkbox>\n              <a href=\"https://netid.usf.edu/una/?display=reset\" style=\"float: right; color: #409eff; text-decoration: none;\">\n                Forgot Password?\n              </a>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" style=\"width: 100%;\" @click=\"login()\">\n                Sign in to EdVision\n              </el-button>\n            </el-form-item>\n\n            <el-form-item>\n              <form ref=\"googleLoginForm\" method=\"post\" :action=\"googleFormAction\">\n                <el-button type=\"primary\" style=\"width: 100%;\" @click=\"submitGoogleLoginForm()\">\n                  Sign in with Google\n                </el-button>\n              </form>\n            </el-form-item>\n\n            <el-form-item>\n              <form ref=\"facebookLoginForm\" method=\"post\" :action=\"facebookFormAction\">\n                <el-button type=\"primary\" style=\"width: 100%;\" @click=\"submitFacebookLoginForm()\">\n                  Sign in with Facebook\n                </el-button>\n              </form>\n            </el-form-item>\n\n            <div style=\"font-size: 14px; text-align: center; padding-bottom: 5px;\">\n              By logging in, I agree to the\n              <a href=\"#\" style=\"color: #409eff; text-decoration: none;\">\n                terms\n              </a> and\n              <a href=\"#\" style=\"color: #409eff; text-decoration: none;\">\n                policies\n              </a>\n            </div>\n            <hr>\n            <el-form-item style=\"margin-bottom: 5px;\">\n              <el-button type=\"primary\" style=\"width: 100%;\" plain>\n                Contact Support\n              </el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </div>\n    </div>\n\n    <div style=\"width: 30%; margin: auto; margin-top: 20px;\">\n      <el-button type=\"primary\" plain @click=\"apiCall()\">\n        Api Call\n      </el-button>\n      <el-button type=\"primary\" plain @click=\"logout()\">\n        Logout\n      </el-button>\n    </div>\n\n    <el-table\n      v-if=\"weathers && weathers.length > 0\"\n      :data=\"weathers\"\n      border\n      style=\"width: 50%; margin: auto; margin-top: 20px;\"\n    >\n      <el-table-column\n        prop=\"date\"\n        label=\"Date\"\n        width=\"180\"\n      />\n      <el-table-column\n        prop=\"temperatureC\"\n        label=\"Temperature C\"\n        width=\"180\"\n      />\n      <el-table-column\n        prop=\"temperatureF\"\n        label=\"Temperature F\"\n      />\n      <el-table-column\n        prop=\"summary\"\n        label=\"Summary\"\n      />\n    </el-table>\n  </div>\n</template>\n<script>\n// @ is an alias to /src\nimport http from '@/utils/axios'\nexport default {\n  name: 'Test',\n  data() {\n    return {\n      weathers: [],\n      user: null,\n      mgr: null,\n      username: 'guest',\n      form: {\n        username: '',\n        password: ''\n      },\n      access_token: null,\n      fbSignInParams: {\n        scope: 'email',\n        return_scopes: true\n      },\n      googleExternalLogin: null,\n      returnUrl: '/about',\n      googleFormAction: null,\n      facebookFormAction: null\n    }\n  },\n  async created() {\n    this.googleFormAction = 'api/auth/external/google/' + encodeURIComponent(this.returnUrl)\n    this.facebookFormAction = 'api/auth/external/facebook/' + encodeURIComponent(this.returnUrl)\n    // this.oauthSignIn()\n  },\n  methods: {\n    oauthSignIn() {\n      // Google's OAuth 2.0 endpoint for requesting an access token\n      var oauth2Endpoint = 'https://accounts.google.com/o/oauth2/v2/auth'\n\n      // Create <form> element to submit parameters to OAuth 2.0 endpoint.\n      var form = document.createElement('form')\n      form.setAttribute('method', 'GET') // Send as a GET request.\n      form.setAttribute('action', oauth2Endpoint)\n\n      // Parameters to pass to OAuth 2.0 endpoint.\n      var params = { 'client_id': '296436268455-jec5622h7o285l5thb6es3cs2dkv4m45.apps.googleusercontent.com',\n        'redirect_uri': 'http://localhost:3011/about',\n        'response_type': 'token',\n        'scope': 'https://www.googleapis.com/auth/drive.metadata.readonly',\n        'include_granted_scopes': 'true',\n        'state': 'pass-through value' }\n\n      // Add form parameters as hidden input values.\n      for (var p in params) {\n        var input = document.createElement('input')\n        input.setAttribute('type', 'hidden')\n        input.setAttribute('name', p)\n        input.setAttribute('value', params[p])\n        form.appendChild(input)\n      }\n\n      // Add form to page and submit it to open the OAuth 2.0 endpoint.\n      document.body.appendChild(form)\n      form.submit()\n    },\n    submitGoogleLoginForm() {\n      this.$refs.googleLoginForm.submit()\n    },\n    submitFacebookLoginForm() {\n      this.$refs.facebookLoginForm.submit()\n    },\n    login() {\n      const that = this\n      console.log(this.form)\n      http.post('https://localhost:6990/api/auth/login', {\n        Email: this.form.username,\n        Password: this.form.password\n      })\n        .then(function(response) {\n          console.log(response)\n          that.username = response.data.email\n          that.access_token = response.data.message\n        })\n        .catch(function(error) {\n          console.log(error)\n        })\n    },\n    apiCall() {\n      const config = {\n        headers: { Authorization: `Bearer ${this.access_token}` }\n      }\n      const url = 'https://localhost:6990/api/weatherforecast'\n      // let url = 'https://edvision.ai/api/weatherforecast';\n      http.get(\n        url,\n        config\n      ).then(response => {\n        if (response && response.data.length > 0) {\n          this.weathers = response.data\n        }\n      }).catch(error => {\n        this.$notify.error({\n          title: 'Error',\n          message: error\n        })\n      })\n    }\n  }\n}\n</script>\n\n<style>\nhr\n{\n\tmargin-bottom: 20px;\n\tborder-bottom: 1px;\n\tborder-top: 1px solid rgba(0, 0, 0, 0.1);\n}\n\n.el-form-item__content{\n\tline-height: 20px !important;\n}\n</style>\n\n<style scoped>\n.g-signin-button {\n  /* This is where you control how the button looks. Be creative! */\n  display: inline-block;\n  padding: 4px 8px;\n  border-radius: 3px;\n  background-color: #3c82f7;\n  color: #fff;\n  box-shadow: 0 3px 0 #0f69ff;\n}\n.fb-signin-button {\n  /* This is where you control how the button looks. Be creative! */\n  display: inline-block;\n  padding: 4px 8px;\n  border-radius: 3px;\n  background-color: #4267b2;\n  color: #fff;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Test.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Test.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Test.vue?vue&type=template&id=08242377&scoped=true&\"\nimport script from \"./Test.vue?vue&type=script&lang=js&\"\nexport * from \"./Test.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Test.vue?vue&type=style&index=0&lang=css&\"\nimport style1 from \"./Test.vue?vue&type=style&index=1&id=08242377&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"08242377\",\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport Router from 'vue-router'\nimport Home from '../views/Home.vue'\nimport Document from '../views/Document.vue'\nimport Test from '../views/Test.vue'\nimport store from '@/store'\nimport { Message } from 'element-ui'\nimport NProgress from 'nprogress' // progress bar\nVue.use(Router)\n\n// import Layout from '../layout/Index.vue';\n/**\n * constantRoutes\n * a base page that does not have permission requirements\n * all roles can be accessed\n */\nexport const constantRoutes = [\n  {\n    path: '/',\n    name: 'Home',\n    component: Home,\n    meta: {\n      plainLayout: false\n    }\n  },\n  {\n    path: '/about',\n    name: 'About',\n    // route level code-splitting\n    // this generates a separate chunk (about.[hash].js) for this route\n    // which is lazy-loaded when the route is visited.\n    component: () => import(/* webpackChunkName: \"about\" */ '../views/About.vue')\n  },\n  {\n    path: '/document',\n    name: 'Document',\n    component: Document\n    // meta: {\n    // \tplainLayout: true\n    // }\n  },\n  {\n    path: '/test',\n    name: 'Test',\n    component: Test,\n    meta: {\n      plainLayout: true\n    }\n  }\n]\n\nexport const asyncRoutes = [\n  { path: '*', redirect: '/404', hidden: true }\n]\n\n// export default router;\n\nconst createRouter = () => new Router({\n  mode: 'history', // require service support\n  // scrollBehavior: () => ({ y: 0 }),\n  routes: constantRoutes\n})\n\nconst router = createRouter()\n\n// Detail see: https://github.com/vuejs/vue-router/issues/1234#issuecomment-357941465\n// export function resetRouter() {\n// \tconst newRouter = createRouter();\n// \trouter.matcher = newRouter.matcher; // reset router\n// }\n\nexport default router\n\nNProgress.configure({ showSpinner: false }) // NProgress Configuration\n\nconst whiteList = ['/login', '/auth-redirect'] // no redirect whitelist\n\nrouter.beforeEach(async(to, from, next) => {\n  // start progress bar\n  NProgress.start()\n\n  // set page title\n  // npndocument.title = getPageTitle(to.meta.title);\n\n  // determine whether the user has logged in\n  const hasToken = true// getToken();\n  if (hasToken) {\n    if (to.path === '/login') {\n      // if is logged in, redirect to the home page\n      next({ path: '/' })\n      // NProgress.done(); // hack: https://github.com/PanJiaChen/vue-element-admin/pull/2939\n    } else {\n      // determine whether the user has obtained his permission roles through getInfo\n      const hasRoles = false// store.getters.roles && store.getters.roles.length > 0;\n      if (hasRoles) {\n        next()\n      } else {\n        // // generate accessible routes map based on roles\n        // const accessRoutes = await store.dispatch('permission/generateRoutes');\n\n        // // dynamically add accessible routes\n        // router.addRoutes(accessRoutes);\n\n        // // hack method to ensure that addRoutes is complete\n        // // set the replace: true, so the navigation will not leave a history record\n        // //next({ ...to, replace: true });\n        // next();\n\n        try {\n          // get user info\n          // note: roles must be a object array! such as: ['admin'] or ,['developer','editor']\n          // const { roles } = await store.dispatch('user/getInfo');\n\n          // generate accessible routes map based on roles\n          const accessRoutes = await store.dispatch('permission/generateRoutes')\n\n          // dynamically add accessible routes\n          router.addRoutes(accessRoutes)\n\n          // hack method to ensure that addRoutes is complete\n          // set the replace: true, so the navigation will not leave a history record\n          // next({ ...to, replace: true });\n          next()\n        } catch (error) {\n          // remove token and go to login page to re-login\n          // await store.dispatch('user/resetToken');\n          Message.error(error || 'Has Error')\n          next(`/login?redirect=${to.path}`)\n          NProgress.done()\n        }\n      }\n    }\n  } else {\n    /* has no token*/\n\n    if (whiteList.indexOf(to.path) !== -1) {\n      // in the free login whitelist, go directly\n      next()\n    } else {\n      // other pages that do not have permission to access are redirected to the login page.\n      next(`/login?redirect=${to.path}`)\n      // NProgress.done();\n    }\n  }\n})\n\nrouter.afterEach(() => {\n  // finish progress bar\n  NProgress.done()\n})\n\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Test.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Test.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Test.vue?vue&type=style&index=1&id=08242377&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Test.vue?vue&type=style&index=1&id=08242377&scoped=true&lang=css&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navbar.vue?vue&type=style&index=0&id=0396ad19&lang=css&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navbar.vue?vue&type=style&index=0&id=0396ad19&lang=css&scoped=true&\"","var map = {\n\t\"./permission.js\": \"31c2\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"c653\";","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=style&index=0&id=59d714a1&lang=css&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=style&index=0&id=59d714a1&lang=css&scoped=true&\""],"sourceRoot":""}